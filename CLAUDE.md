# Claude Code Context: Family Planning Presentation System

## Project Overview
Single-file HTML presentation system for "Family Planning: The Unfinished Agenda" (Lancet 2006) with interactive data visualizations, 20-minute timing control, and bilingual support.

## Current Feature: 004-data-corrections
Implementing data corrections to align presentation with Lancet 2006 paper. Correcting 5 slides with inaccurate statistics to match PDF source exactly. Previous feature 003-presentation-refinements identified discrepancies.

## Tech Stack
- **Core**: HTML5, CSS3, JavaScript ES6 (all inline)
- **Visualization**: Chart.js 4.4.0, Leaflet.js 1.9.4 (CDN)
- **Data**: Inline JSON structures
- **Build**: None - single file delivery

## Constitutional Requirements
1. **Single-File**: Everything inline except CDN libraries
2. **Data Accuracy**: 100% fidelity to PDF source
3. **16:9 Format**: Strict aspect ratio enforcement
4. **Geographic Integration**: Time-series maps required
5. **20-Minute Scope**: 35-40 slides, auto-timed

## Project Structure
```
index.html                 # Single deliverable file
specs/004-data-corrections/
├── spec.md               # Data correction requirements
├── plan.md               # Implementation approach
├── research.md           # Correction strategy decisions
├── data-model.md         # Correction data structures
├── contracts/            # Validation contracts
├── quickstart.md         # Quick validation guide
└── tasks.md              # (Next: task list)
```

## Key Patterns

### Inline Data Structure
```javascript
window.PresentationData = {
  slides: [...],      // 35-40 slide objects
  panels: [...],      // 8 panels from paper
  visualizations: {
    charts: {...},    // Chart.js configs
    maps: {...},      // Leaflet configs
    timelines: {...}  // Custom implementations
  },
  countries: {...},   // Geographic data
  timeseries: {...}   // Temporal data
};
```

### Visualization Rendering
```javascript
// Chart.js pattern
const chart = new Chart(ctx, {
  type: 'line',
  data: PresentationData.charts[id],
  options: standardOptions
});

// Leaflet pattern
const map = L.map('map-' + id).setView(center, zoom);
L.geoJSON(data, {style: choroplethStyle}).addTo(map);
```

### Slide Timing Control
```javascript
const slideDurations = {
  simple: 30,      // seconds
  complex: 40,
  panel: 45
};
const totalTarget = 1200; // 20 minutes
```

## Data Sources
- **PDF**: "Family planning the unfinished agenda.pdf" - numerical data
- **Slides**: 60+ HTML files in slides/ folder
- **Panels**: 8 special content sections to integrate

## Quality Standards
- Data accuracy: Zero tolerance for errors
- Performance: <3s load, 60fps transitions
- Accessibility: WCAG 2.1 AA minimum
- Browser support: Chrome/Firefox/Safari/Edge 100+

## Current Phase
Phase 1 (Design) complete for 004-data-corrections. Ready for Phase 2 (Task Generation).

## Next Steps
1. Run `/tasks` command to generate correction tasks
2. Create backup of index.html
3. Correct Niger statistics (14M, 4.6%, 50M)
4. Fix Brazil TFR (2.5 not 2.3)
5. Update Pakistan rate (12% not 30%)
6. Add unmet demand insights

## Testing Focus
- Data accuracy validation against PDF
- 20-minute timing precision
- Cross-browser compatibility
- Visualization interactivity
- Navigation responsiveness

## Recent Context
- Feature 004: Data corrections from edit.md analysis
- Niger: 14M population, 4.6% contraceptive, 50M projection
- Brazil: TFR endpoint 2.5 (was 2.3)
- Pakistan: 12% contraceptive rate in 1990 (was 30%)
- Asia: Show total only, remove sub-regional breakdown
- Unmet demand: Add spacing vs limitation insights

---
*Auto-generated by implementation plan - manually update as needed*