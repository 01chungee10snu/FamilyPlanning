<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ì¡±ê³„íš: ë¯¸ì™„ì˜ ê³¼ì œ - í†µí•© ë°œí‘œìë£Œ</title>

    <!-- Seoul Fonts CDN -->
    <link href="https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangang.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulNamsan.css" rel="stylesheet">

    <!-- External Libraries CDN -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1"></script>

    <!-- PDF Export Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        /* ==================== ê¸°ë³¸ ì„¤ì • ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Seoul í°íŠ¸ ì ìš© ë° Weight ì •ì˜ */
        @font-face {
            font-family: 'SeoulHangang';
            font-weight: 200;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangangL.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulHangang';
            font-weight: 300;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangangL.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulHangang';
            font-weight: 500;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangangM.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulHangang';
            font-weight: 700;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangangB.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulHangang';
            font-weight: 800;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangangEB.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulNamsan';
            font-weight: 300;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulNamsanL.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulNamsan';
            font-weight: 500;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulNamsanM.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulNamsan';
            font-weight: 700;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulNamsanB.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulNamsan';
            font-weight: 800;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulNamsanEB.woff') format('woff');
        }

        body {
            font-family: 'SeoulNamsan', 'Malgun Gothic', sans-serif;
            font-weight: 300;
            background: linear-gradient(135deg, #2d3a3a 0%, #576066 100%);
            overflow: hidden;
            width: 100vw;
            height: 100vh;
        }

        /* Crisis theme colors */
        :root {
            --crisis-danger: #dc2626;
            --crisis-warning: #ea580c;
            --crisis-caution: #ca8a04;
            --crisis-dark: #1f2937;
            --crisis-darker: #111827;
            --crisis-text-primary: #ffffff;
            --crisis-text-secondary: #e5e7eb;
            --crisis-text-accent: #fbbf24;
        }

        /* ==================== 16:9 ë¹„ìœ¨ ê°•ì œ ==================== */
        .presentation-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #000;
        }

        .presentation-viewport {
            position: relative;
            width: 100%;
            height: 100%;
            max-width: calc(100vh * 16 / 9);
            max-height: calc(100vw * 9 / 16);
            background: #fff;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            overflow: hidden;
        }

        /* ==================== ìŠ¬ë¼ì´ë“œ ê¸°ë³¸ ìŠ¤íƒ€ì¼ ==================== */
        .slide {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
            padding: 40px 60px;
            background: white;
            overflow: hidden;
        }

        .slide.active {
            display: flex;
            flex-direction: column;
        }

        /* ==================== Typography ==================== */
        h1 {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 800;
            font-size: 46px;
            color: #2d3a3a;
            line-height: 1.2;
            margin-bottom: 20px;
        }

        h2 {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 700;
            font-size: 36px;
            color: #576066;
            margin-bottom: 16px;
        }

        h3 {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 500;
            font-size: 36px;
            color: #3e4948;
            margin-bottom: 14px;
        }

        h4 {
            font-family: 'SeoulNamsan', sans-serif;
            font-weight: 700;
            font-size: 22px;
            color: #576066;
            margin-bottom: 12px;
        }

        p {
            font-family: 'SeoulNamsan', sans-serif;
            font-weight: 300;
            font-size: 18px;
            line-height: 1.7;
            color: #576066;
        }

        strong, b {
            font-family: 'SeoulNamsan', sans-serif;
            font-weight: 700;
        }

        /* ==================== ë ˆì´ì•„ì›ƒ ==================== */
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            height: calc(100% - 60px);
        }

        .three-column {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            height: calc(100% - 60px);
        }

        .main-with-side {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
            height: calc(100% - 60px);
        }

        /* ==================== ì»´í¬ë„ŒíŠ¸ ìŠ¤íƒ€ì¼ ==================== */
        .panel-box {
            background: linear-gradient(135deg, #e5e7e7 0%, #d1d5d5 100%);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #69b7a4;
        }

        .data-card {
            background: white;
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s;
        }

        .data-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .stat-number {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 800;
            font-size: 48px;
            color: #69b7a4;
            margin: 8px 0;
        }

        .chart-container {
            position: relative;
            height: 250px;
            width: 100%;
            margin: 10px 0;
        }

        .small-chart {
            height: 180px;
        }

        .map-container {
            position: relative;
            height: 100%;
            width: 100%;
            border-radius: 8px;
            overflow: hidden;
        }

        /* Crisis Slide Styles */
        .crisis-slide {
            background: #F5F0E8;
        }

        .crisis-slide h1 {
            color: #000000;
            font-size: 48px;
            margin-bottom: 10px;
        }

        .crisis-slide .subtitle {
            color: #000000;
            font-size: 24px;
            margin-bottom: 30px;
        }

        .crisis-panels {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
            height: calc(100% - 180px);
            padding: 0 20px;
        }

        .crisis-panel {
            padding: 25px;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        .panel-funding {
            background: linear-gradient(135deg, #B8D4CE 0%, #9DC3C2 100%);
            border: 3px solid #4A7C7E;
        }

        .panel-africa {
            background: linear-gradient(135deg, #D4B896 0%, #A08C6C 100%);
            border: 3px solid #8B6F47;
        }

        .panel-resource {
            background: linear-gradient(135deg, #9DC3C2 0%, #B8D4CE 100%);
            border: 3px solid #2D5F5D;
        }

        .panel-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .panel-icon {
            font-size: 32px;
            margin-right: 12px;
        }

        .panel-header h3 {
            color: #000000;
            font-size: 26px;
            font-weight: 700;
            margin: 0;
        }

        .key-metric {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }

        .metric-value {
            font-size: 48px;
            font-weight: 800;
            color: #000000;
        }

        .metric-label {
            font-size: 18px;
            color: #000000;
            text-align: center;
            font-weight: 500;
        }

        .crisis-panel canvas {
            width: 100%;
            height: 150px;
            margin: 10px 0;
        }

        #africaCrisisMap {
            width: 100%;
            height: 240px;
            margin: 15px 0;
            border-radius: 8px;
            border: 2px solid #8B6F47;
            box-shadow: 0 2px 8px rgba(139, 111, 71, 0.3);
        }

        .panel-points {
            list-style: none;
            padding: 0;
            margin: 10px 0 0;
        }

        .panel-points li {
            color: #000000;
            font-size: 17px;
            margin: 10px 0;
            padding-left: 24px;
            position: relative;
            font-weight: 500;
            line-height: 1.6;
        }

        .panel-points li:before {
            content: "â–¸";
            position: absolute;
            left: 0;
            color: #2D5F5D;
            font-weight: bold;
            font-size: 18px;
        }

        .citation-footer {
            position: absolute;
            bottom: 20px;
            right: 40px;
            color: #000000;
            font-size: 16px;
            font-style: italic;
            font-weight: 500;
        }

        /* Timeline Slider Styles */
        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(to right, #3b82f6 0%, #93c5fd 100%);
            outline: none;
            opacity: 0.9;
            transition: opacity 0.2s;
        }

        input[type="range"]:hover {
            opacity: 1;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            transition: all 0.2s;
        }

        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            transition: all 0.2s;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            background: #2563eb;
        }

        input[type="range"]::-moz-range-thumb:hover {
            transform: scale(1.2);
            background: #2563eb;
        }

        /* í…Œì´ë¸” */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 18px;
            margin: 10px 0;
        }

        .data-table th {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 700;
            background: #576066;
            color: white;
            padding: 8px;
            text-align: left;
        }

        .data-table td {
            font-family: 'SeoulNamsan', sans-serif;
            font-weight: 300;
            padding: 6px 8px;
            border-bottom: 1px solid #e2e8f0;
        }

        /* ì¸ìš©ë¬¸ */
        .quote-box {
            position: relative;
            padding: 15px 20px;
            background: #f5f6f6;
            border-left: 3px solid #69b7a4;
            margin: 15px 0;
            font-style: italic;
        }

        /* ==================== ì§€ë„ íˆ´íŒ ìŠ¤íƒ€ì¼ ==================== */
        .map-tooltip {
            font-family: 'SeoulNamsan', sans-serif;
            background: rgba(255, 255, 255, 0.98);
            border: 2px solid #69b7a4;
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            min-width: 200px;
        }

        .map-tooltip h4 {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 700;
            font-size: 20px;
            color: #2d3748;
            margin: 0 0 8px 0;
            padding-bottom: 6px;
            border-bottom: 1px solid #e2e8f0;
        }

        .tooltip-stat {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            font-size: 19px;
        }

        .tooltip-label {
            font-weight: 500;
            color: #718096;
        }

        .tooltip-value {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 700;
            color: #69b7a4;
        }

        .tooltip-trend {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #e2e8f0;
            font-size: 18px;
            font-style: italic;
        }

        .trend-positive { color: #69b7a4; }
        .trend-negative { color: #c97064; }
        .trend-neutral { color: #718096; }

        /* ==================== UI ì»¨íŠ¸ë¡¤ ìˆ¨ê¹€ ==================== */
        .nav-controls, .timer-display, .progress-bar, .slide-number {
            display: none !important;
        }

        /* ==================== í˜ì´ì§€ ì¹´ìš´í„° ==================== */
        .page-counter {
            position: fixed;
            bottom: 20px;
            right: 20px;
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 700;
            font-size: 24px;
            color: #2d3a3a;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 16px;
            border-radius: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 1000;
        }

        /* ==================== PDF ë‚´ë³´ë‚´ê¸° ==================== */
        .pdf-export-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(59, 130, 246, 0.3);
            z-index: 1000;
            transition: all 0.3s;
            font-family: 'SeoulNamsan', sans-serif;
            display: none; /* ë²„íŠ¼ ìˆ¨ê¸°ê¸° */
        }

        .pdf-export-btn:hover {
            background: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }

        .pdf-export-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }

        .pdf-progress {
            position: fixed;
            top: 70px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            display: none;
            z-index: 1001;
            min-width: 250px;
            font-family: 'SeoulNamsan', sans-serif;
        }

        .pdf-progress.active {
            display: block;
        }

        .pdf-progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .pdf-progress-fill {
            height: 100%;
            background: #3b82f6;
            border-radius: 4px;
            transition: width 0.3s;
            width: 0%;
        }

        /* ==================== íƒ€ì´í‹€ ìŠ¬ë¼ì´ë“œ ==================== */
        .title-slide {
            background: linear-gradient(135deg, #576066 0%, #3e4948 100%);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .title-slide h1 {
            font-size: 64px;
            color: #FFFFFF !important;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .title-slide p {
            color: #FFFFFF !important;
        }

        .title-slide h4 {
            color: #FFFFFF !important;
        }

        .key-messages {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 30px;
            width: 80%;
        }

        .key-message {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .key-message h4, .key-message p {
            color: #FFFFFF !important;
        }

        .key-message h4 {
            color: white;
            margin-bottom: 5px;
        }

        .key-message p {
            color: rgba(255,255,255,0.9);
            font-size: 18px;
        }

        /* ==================== ë°˜ì‘í˜• ì¡°ì • ==================== */
        @media (max-width: 1200px) {
            h1 { font-size: 42px; }
            h2 { font-size: 42px; }
            h3 { font-size: 18px; }
            p { font-size: 19px; }
            .slide { padding: 30px 40px; }
        }
    </style>
</head>
<body>
    <!-- PDF ë‚´ë³´ë‚´ê¸° ë²„íŠ¼ -->
    <button class="pdf-export-btn" onclick="exportToPDF()">PDFë¡œ ì €ì¥</button>

    <!-- PDF ì§„í–‰ ìƒíƒœ -->
    <div class="pdf-progress" id="pdfProgress">
        <div>PDF ìƒì„± ì¤‘...</div>
        <div id="pdfProgressText">ì¤€ë¹„ ì¤‘...</div>
        <div class="pdf-progress-bar">
            <div class="pdf-progress-fill" id="pdfProgressFill"></div>
        </div>
    </div>

    <div class="presentation-container">
        <div class="presentation-viewport">

            <!-- Slide 1: íƒ€ì´í‹€ + í•µì‹¬ ë©”ì‹œì§€ -->
            <div class="slide title-slide active">
                <h1>ê°€ì¡±ê³„íš: ë¯¸ì™„ì˜ ê³¼ì œ</h1>
                <p style="font-size: 42px; margin-bottom: 30px;">
                    Family planning: The unfinished agenda
                </p>
                <div class="key-messages">
                    <div class="key-message">
                        <h4>ë³´ê±´ í–¥ìƒ</h4>
                        <p>ëª¨ì„±Â·ì˜ì•„ ì‚¬ë§ë¥  ê°ì†Œ</p>
                    </div>
                    <div class="key-message">
                        <h4>ê²½ì œ ë°œì „</h4>
                        <p>ë¹ˆê³¤ ê°ì†Œì™€ ì„±ì¥ ì´‰ì§„</p>
                    </div>
                    <div class="key-message">
                        <h4>ì—¬ì„± ê¶Œí•œ</h4>
                        <p>êµìœ¡Â·ê²½ì œ ì°¸ì—¬ í™•ëŒ€</p>
                    </div>
                    <div class="key-message">
                        <h4>ì§€ì†ê°€ëŠ¥ì„±</h4>
                        <p>ì¸êµ¬Â·í™˜ê²½ ê· í˜•</p>
                    </div>
                </div>
                <p style="margin-top: 40px; font-size: 20px; color: #FFFFFF;">
                    Cleland, J., Bernstein, S., Ezeh, A., Faundes, A., Glasier, A., & Innis, J. (2006). Family planning: the unfinished agenda. The Lancet, 368(9549), 1810-1827.
                </p>
            </div>

            <!-- Slide 2: ì—­ì‚¬ì  ë§¥ë½ -->
            <div class="slide">
                <h1>ê°€ì¡±ê³„íšì˜ ì—­ì‚¬ì  ì „í™˜ì </h1>
                <div class="two-column">
                    <div>
                        <div class="panel-box">
                            <h3>1960ë…„ëŒ€: ì‹œì‘</h3>
                            <p><strong>ì¸êµ¬ í­ë°œ ìš°ë ¤</strong></p>
                            <ul style="font-size: 19px; margin: 10px 0; padding-left: 20px; list-style: none;">
                                <li style="margin: 5px 0;">â€¢ ê°œë°œë„ìƒêµ­ ê¸‰ì† ì¸êµ¬ ì¦ê°€</li>
                                <li style="margin: 5px 0;">â€¢ ê²½ì œë°œì „ ì €í•´ ìš°ë ¤</li>
                                <li style="margin: 5px 0;">â€¢ ì •ë¶€ ì£¼ë„ í”„ë¡œê·¸ë¨ ì‹œì‘</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: linear-gradient(135deg, #fef5e7 0%, #fdebd0 100%);">
                            <h3>1994ë…„: ì¹´ì´ë¡œ íšŒì˜</h3>
                            <p><strong>íŒ¨ëŸ¬ë‹¤ì„ ì „í™˜</strong></p>
                            <ul style="font-size: 19px; margin: 10px 0; padding-left: 20px; list-style: none;">
                                <li style="margin: 5px 0;">â€¢ ì¸êµ¬ ëª©í‘œ â†’ ê°œì¸ ê¶Œë¦¬</li>
                                <li style="margin: 5px 0;">â€¢ ìˆ«ì ì¤‘ì‹¬ â†’ ì¸ê¶Œ ì¤‘ì‹¬</li>
                                <li style="margin: 5px 0;">â€¢ ì—¬ì„± ìƒì‹ê±´ê°•ê¶Œ ê°•ì¡°</li>
                            </ul>
                        </div>
                    </div>
                    <div>
                        <h3>ì£¼ìš” ì„±ê³¼ì™€ ë„ì „</h3>
                        <div class="chart-container">
                            <canvas id="historicalTrend"></canvas>
                        </div>
                        <div class="data-card" style="margin-top: 15px;">
                            <p style="font-size: 19px;">ì „ ì„¸ê³„ í”¼ì„ ì‚¬ìš©ë¥  (Cleland et al., 2006)</p>
                            <div class="stat-number">10% â†’ 60%</div>
                            <p style="font-size: 18px; color: #718096;">1960 â†’ 2005</p>
                            <p style="font-size: 16px; color: #c97064; margin-top: 10px; font-style: italic;">
                                â€» 2025ë…„ í˜„í™©: 65% (í˜„ëŒ€ì  ë°©ë²• 59%) (UN, 2024)
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 3: ê¸€ë¡œë²Œ ì¸êµ¬ í˜„í™© (ì§€ë„ í¬í•¨) -->
            <div class="slide">
                <h1>ê¸€ë¡œë²Œ ì¸êµ¬ ë™í–¥ê³¼ ì§€ì—­ë³„ í˜„í™©</h1>
                <div class="main-with-side">
                    <div>
                        <div class="map-container" id="worldMap" style="height: 350px;"></div>
                        <div style="display: flex; gap: 15px; margin-top: 15px;">
                            <div class="data-card" style="flex: 1;">
                                <p>1960ë…„</p>
                                <div class="stat-number" style="font-size: 36px;">30.2ì–µ</div>
                            </div>
                            <div class="data-card" style="flex: 1;">
                                <p>2005ë…„</p>
                                <div class="stat-number" style="font-size: 36px;">64.6ì–µ</div>
                            </div>
                            <div class="data-card" style="flex: 1;">
                                <p>2050ë…„ ì˜ˆì¸¡</p>
                                <div class="stat-number" style="font-size: 36px;">90.8ì–µ</div>
                            </div>
                        </div>
                        <p style="font-size: 16px; color: #c97064; margin-top: 10px; font-style: italic; text-align: center;">
                            â€» 2025ë…„ í˜„í™©: ì„¸ê³„ TFR 2.3 (UN, 2024)
                        </p>
                    </div>
                    <div>
                        <h3>ì§€ì—­ë³„ ì¸êµ¬ (Table 1, Lancet 2006)</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ì§€ì—­</th>
                                    <th>1960</th>
                                    <th>2005</th>
                                    <th>2050</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background: #f0f9ff;">
                                    <td><strong>ì„¸ê³„ ì „ì²´</strong></td>
                                    <td>3,019M</td>
                                    <td>6,464M</td>
                                    <td>9,075M</td>
                                </tr>
                                <tr>
                                    <td>ì„ ì§„êµ­</td>
                                    <td>916M</td>
                                    <td>1,211M</td>
                                    <td>1,236M</td>
                                </tr>
                                <tr>
                                    <td>ê°œë°œë„ìƒêµ­</td>
                                    <td>2,104M</td>
                                    <td>5,253M</td>
                                    <td>7,839M</td>
                                </tr>
                                <tr style="background: #fafafa;">
                                    <td colspan="4" style="font-weight: 600; padding: 8px;">ëŒ€ë¥™ë³„</td>
                                </tr>
                                <tr>
                                    <td>ì•„í”„ë¦¬ì¹´</td>
                                    <td>283M</td>
                                    <td>906M</td>
                                    <td>1,937M</td>
                                </tr>
                                <tr>
                                    <td>ì•„ì‹œì•„</td>
                                    <td>1,699M</td>
                                    <td>3,905M</td>
                                    <td>5,217M</td>
                                </tr>
                                <tr>
                                    <td>ìœ ëŸ½</td>
                                    <td>604M</td>
                                    <td>728M</td>
                                    <td>653M</td>
                                </tr>
                                <tr>
                                    <td>ë¼í‹´ì•„ë©”ë¦¬ì¹´/ì¹´ë¦¬ë¸Œ</td>
                                    <td>221M</td>
                                    <td>561M</td>
                                    <td>783M</td>
                                </tr>
                                <tr>
                                    <td>ë¶ì•„ë©”ë¦¬ì¹´</td>
                                    <td>204M</td>
                                    <td>329M</td>
                                    <td>438M</td>
                                </tr>
                                <tr>
                                    <td>ì˜¤ì„¸ì•„ë‹ˆì•„</td>
                                    <td>16M</td>
                                    <td>33M</td>
                                    <td>48M</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="panel-box" style="margin-top: 15px;">
                            <h4>í•µì‹¬ ì¸ì‚¬ì´íŠ¸</h4>
                            <p style="font-size: 18px;">
                                <span style="margin-left: 20px;">â€¢ ì „ì²´ ì¦ê°€ë¶„ì˜ <strong>95%</strong>ê°€ ê°œë°œë„ìƒêµ­ì—ì„œ ë°œìƒ</span><br>
                                <span style="margin-left: 20px;">â€¢ ì•„í”„ë¦¬ì¹´ ì¸êµ¬ <strong>2.1ë°°</strong> ì¦ê°€ ì˜ˆìƒ (906Mâ†’1,937M)</span><br>
                                <span style="margin-left: 20px;">â€¢ ìœ ëŸ½ì€ ìœ ì¼í•˜ê²Œ <strong>ì¸êµ¬ ê°ì†Œ</strong> ì˜ˆìƒ (728Mâ†’653M)</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 4: ë‹ˆì œë¥´ ì‚¬ë¡€ -->
            <div class="slide">
                <h1>ì‚¬í•˜ë¼ì´ë‚¨ ì•„í”„ë¦¬ì¹´: ë‹ˆì œë¥´ ìœ„ê¸°</h1>
                <div class="two-column">
                    <div>
                        <div id="nigerMap" class="map-container" style="height: 280px;"></div>
                        <div class="panel-box" style="margin-top: 15px; background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);">
                            <h3>ë‹ˆì œë¥´ í˜„í™©</h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div>
                                    <p style="font-size: 16px; color: #718096;">í•©ê³„ì¶œì‚°ìœ¨ (1998)</p>
                                    <p style="font-size: 42px; font-weight: 800; color: #dc2626;">7.5ëª…</p>
                                </div>
                                <div>
                                    <p style="font-size: 16px; color: #718096;">í”¼ì„ ì‚¬ìš©ë¥ </p>
                                    <p style="font-size: 42px; font-weight: 800; color: #dc2626;">4.6%</p>
                                </div>
                                <div>
                                    <p style="font-size: 16px; color: #718096;">ì¸êµ¬ ì¦ê°€ìœ¨</p>
                                    <p style="font-size: 42px; font-weight: 800; color: #dc2626;">3.3%/ë…„</p>
                                </div>
                                <div>
                                    <p style="font-size: 16px; color: #718096;">2050ë…„ ì˜ˆì¸¡</p>
                                    <p style="font-size: 42px; font-weight: 800; color: #dc2626;">5,000ë§Œëª…</p><!-- Corrected from <5ì²œë§Œ to 5,000ë§Œ per Table 2 -->
                                </div>
                                <div>
                                    <p style="font-size: 16px; color: #718096;">í˜„ì¬ ì¸êµ¬ (2005)</p>
                                    <p style="font-size: 42px; font-weight: 800; color: #dc2626;">1,400ë§Œëª…</p><!-- Corrected from 1,250ë§Œ to 1,400ë§Œ per Table 2 -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3>ë„ì „ê³¼ ê²°ê³¼</h3>
                        <div class="quote-box">
                            <p>"í˜„ì¬ ì¶”ì„¸ ì§€ì† ì‹œ 2050ë…„ê¹Œì§€ ì¸êµ¬ 4ë°° ì¦ê°€, ì‹ëŸ‰ ì•ˆë³´ì™€ í™˜ê²½ ì§€ì†ê°€ëŠ¥ì„± ìœ„í˜‘"</p>
                        </div>
                        <h4>ì£¼ìš” ì¥ì• ìš”ì¸</h4>
                        <ul style="font-size: 19px; line-height: 1.8;">
                            <li>ğŸ‘¥ <strong>ë¬¸í™”ì  ìš”ì¸</strong>: ëŒ€ê°€ì¡± ì„ í˜¸, ì¡°í˜¼ ê´€ìŠµ</li>
                            <li>ğŸ¥ <strong>ì„œë¹„ìŠ¤ ì ‘ê·¼ì„±</strong>: ë†ì´Œ ì§€ì—­ ì˜ë£Œ ì‹œì„¤ ë¶€ì¡±</li>
                            <li>ğŸ“š <strong>êµìœ¡ ë¶€ì¡±</strong>: ì—¬ì„± ë¬¸í•´ìœ¨ 15% ë¯¸ë§Œ</li>
                            <li>ğŸ’° <strong>ê²½ì œì  ì œì•½</strong>: í”¼ì„ ë¹„ìš© ë¶€ë‹´</li>
                            <li>âš–ï¸ <strong>ì„± ë¶ˆí‰ë“±</strong>: ì—¬ì„± ì˜ì‚¬ê²°ì •ê¶Œ ì œí•œ</li>
                        </ul>
                        <div class="data-card" style="background: #fef3c7; margin-top: 15px;">
                            <h4 style="color: #92400e;">ê¸´ê¸‰ ëŒ€ì‘ í•„ìš”</h4>
                            <p style="font-size: 18px;">
                                í†µí•©ì  ì ‘ê·¼: êµìœ¡ + ë³´ê±´ + ì—¬ì„±ê¶Œí•œ + ê²½ì œê°œë°œ
                            </p>
                            <p style="font-size: 16px; color: #c97064; margin-top: 10px; font-style: italic;">
                                â€» 2025ë…„ í˜„í™©: Niger TFR 6.7ëª… (ì„¸ê³„ ìµœê³ ), í”¼ì„ë¥  17% (UN, 2024)
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 5: í†µí•©ëœ ì„±ê³µ/ì‹¤íŒ¨ ì‚¬ë¡€ -->
            <div class="slide">
                <h1>ê°€ì¡±ê³„íš ì„±ê³µê³¼ ì‹¤íŒ¨: êµ­ê°€ë³„ ë¹„êµ</h1>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; height: 85%;">
                    <!-- ì™¼ìª½: ì„±ê³µ ì‚¬ë¡€ë“¤ -->
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <h3 style="text-align: center; margin: 5px 0;">âœ… ì„±ê³µ ì‚¬ë¡€</h3>

                        <!-- ì¼€ëƒ -->
                        <div class="panel-box" style="background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); flex: 1;">
                            <h4 style="margin: 5px 0;">ğŸ‡°ğŸ‡ª ì¼€ëƒ: ì •ë¶€ ì£¼ë„</h4>
                            <div style="display: flex; gap: 10px; margin: 5px 0;">
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">TFR</span><br>
                                    <strong style="color: #059669;">8.0â†’4.8</strong>
                                </div>
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">í”¼ì„ë¥ </span><br>
                                    <strong style="color: #059669;">7â†’27%</strong>
                                </div>
                            </div>
                            <p style="font-size: 14px; margin: 5px 0;">
                                â€¢ ê°•ë ¥í•œ ì •ì¹˜ì  ì˜ì§€<br>
                                â€¢ ì§€ì—­ì‚¬íšŒ ê¸°ë°˜ í”„ë¡œê·¸ë¨
                            </p>
                        </div>

                        <!-- ë¸Œë¼ì§ˆ -->
                        <div class="panel-box" style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); flex: 1;">
                            <h4 style="margin: 5px 0;">ğŸ‡§ğŸ‡· ë¸Œë¼ì§ˆ: ì‚¬íšŒ ì£¼ë„</h4>
                            <div style="display: flex; gap: 10px; margin: 5px 0;">
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">TFR</span><br>
                                    <strong style="color: #2563eb;">6.2â†’2.5</strong>
                                </div>
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">í”¼ì„ë¥ </span><br>
                                    <strong style="color: #2563eb;">77%</strong>
                                </div>
                            </div>
                            <p style="font-size: 14px; margin: 5px 0;">
                                â€¢ ë¯¸ë””ì–´ ì˜í–¥ (TV ë…¸ë²¨ë¼)<br>
                                â€¢ ì—¬ì„± êµìœ¡ í™•ëŒ€
                            </p>
                        </div>

                        <!-- ë°©ê¸€ë¼ë°ì‹œ -->
                        <div class="panel-box" style="background: linear-gradient(135deg, #e5f5e0 0%, #c8e6c9 100%); flex: 1;">
                            <h4 style="margin: 5px 0;">ğŸ‡§ğŸ‡© ë°©ê¸€ë¼ë°ì‹œ: í˜ì‹ ì  ì ‘ê·¼</h4>
                            <div style="display: flex; gap: 10px; margin: 5px 0;">
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">TFR</span><br>
                                    <strong style="color: #16a34a;">6.3â†’3.0</strong>
                                </div>
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">í”¼ì„ë¥ </span><br>
                                    <strong style="color: #16a34a;">58%</strong>
                                </div>
                            </div>
                            <p style="font-size: 14px; margin: 5px 0;">
                                â€¢ ì—¬ì„± ì§€ì—­ë³´ê±´ìš”ì›<br>
                                â€¢ ë¬¸ë§¹ ì—¬ì„± í”„ë¡œê·¸ë¨<br>
                                â€¢ ì†Œì•¡ê¸ˆìœµ ì—°ê³„
                            </p>
                        </div>
                    </div>

                    <!-- ì˜¤ë¥¸ìª½: ì‹¤íŒ¨/ì •ì²´ ì‚¬ë¡€ ë° ì°¨íŠ¸ -->
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <h3 style="text-align: center; margin: 5px 0;">âŒ ì •ì²´/ì‹¤íŒ¨ ì‚¬ë¡€</h3>

                        <!-- íŒŒí‚¤ìŠ¤íƒ„ -->
                        <div class="panel-box" style="background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);">
                            <h4 style="margin: 5px 0;">ğŸ‡µğŸ‡° íŒŒí‚¤ìŠ¤íƒ„: ì •ì²´ ìƒíƒœ</h4>
                            <div style="display: flex; gap: 10px; margin: 5px 0;">
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">TFR</span><br>
                                    <strong style="color: #ea580c;">6.0â†’4.3</strong>
                                </div>
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">í”¼ì„ë¥ </span><br>
                                    <strong style="color: #ea580c;">12%</strong>
                                </div>
                            </div>
                            <p style="font-size: 14px; margin: 5px 0;">
                                â€¢ ì •ì¹˜ì  ë¶ˆì•ˆì •<br>
                                â€¢ ì¢…êµì  ë°˜ëŒ€<br>
                                â€¢ ì—¬ì„± ì´ë™ ì œí•œ
                            </p>
                        </div>

                        <!-- ë¹„êµ ì°¨íŠ¸ -->
                        <div style="flex: 1; background: white; border-radius: 8px; padding: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <h4 style="margin: 5px 0; text-align: center;">ë‚¨ì•„ì‹œì•„ TFR ë¹„êµ</h4>
                            <div class="chart-container" style="height: 200px;">
                                <canvas id="southAsiaComparison"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <p style="text-align: center; font-size: 14px; margin-top: 10px; font-style: italic;">
                    ì¶œì²˜: Cleland et al. (2006)<br>
                    <span style="color: #c97064;">â€» 2025ë…„ í˜„í™©: ë°©ê¸€ë¼ë°ì‹œ TFR 1.9, íŒŒí‚¤ìŠ¤íƒ„ TFR 3.2 (UNFPA, 2024)</span>
                </p>
            </div>

            <!-- Slide 6: ìœ„ê¸°ì˜ ê°€ì¡±ê³„íš -->
            <div class="slide crisis-slide">
                <h1>ìœ„ê¸°ì˜ ê°€ì¡±ê³„íš: êµ­ì œì  ì™¸ë©´ê³¼ ìì› ë¶€ì¡±</h1>
                <p class="subtitle">ê°€ì¡±ê³„íšì´ ì§ë©´í•œ 3ëŒ€ ìœ„ê¸°ì™€ ê¸´ê¸‰í•œ í–‰ë™ì˜ í•„ìš”ì„±</p>

                <div class="crisis-panels">
                    <!-- Panel 1: Funding Decline -->
                    <div class="crisis-panel panel-funding">
                        <div class="panel-header">
                            <span class="panel-icon">ğŸ“‰</span>
                            <h3>êµ­ì œ ìš°ì„ ìˆœìœ„ í•˜ë½</h3>
                        </div>
                        <div class="key-metric">
                            <span class="metric-value">$100M</span>
                            <span class="metric-label">ìê¸ˆ ê°ì†Œ (1995-2003)</span>
                        </div>
                        <canvas id="fundingDeclineChart"></canvas>
                        <ul class="panel-points">
                            <li>MDGì—ì„œ ê°€ì¡±ê³„íš ì œì™¸</li>
                            <li>êµ­ì œì‚¬íšŒì˜ ê´€ì‹¬ ê¸‰ê°</li>
                            <li>ë¦¬ë”ì‹­ ë¶€ì¬ ì‹¬í™”</li>
                        </ul>
                    </div>

                    <!-- Panel 2: Africa Crisis -->
                    <div class="crisis-panel panel-africa">
                        <div class="panel-header">
                            <span class="panel-icon">ğŸŒ</span>
                            <h3>ì•„í”„ë¦¬ì¹´ ìœ„ê¸°</h3>
                        </div>
                        <div class="key-metric">
                            <span class="metric-value">3ë°°</span>
                            <span class="metric-label">Niger ì¸êµ¬ ì¦ê°€ ì˜ˆìƒ</span>
                        </div>
                        <div id="africaCrisisMap"></div>
                        <ul class="panel-points">
                            <li>HIV/AIDSë³´ë‹¤ í° ìœ„í˜‘</li>
                            <li>9ê°œêµ­ ë¯¸ì¶©ì¡± ìˆ˜ìš” ì¦ê°€</li>
                            <li>ë¹ˆê³¤ ì•…ìˆœí™˜ ì§€ì†</li>
                        </ul>
                    </div>

                    <!-- Panel 3: Resource Gap -->
                    <div class="crisis-panel panel-resource">
                        <div class="panel-header">
                            <span class="panel-icon">ğŸ’°</span>
                            <h3>ìì› ê²©ì°¨</h3>
                        </div>
                        <div class="key-metric">
                            <span class="metric-value">$3.8B</span>
                            <span class="metric-label">10ë…„ í•„ìš” ìê¸ˆ</span>
                        </div>
                        <canvas id="resourceGapChart"></canvas>
                        <ul class="panel-points">
                            <li>ì•„í”„ë¦¬ì¹´: $270M í•„ìš” vs $200M ê°€ìš©</li>
                            <li>2006-2015ë…„ ì´ $3.8B í•„ìš”</li>
                            <li>ê¸´ê¸‰ ìê¸ˆ í™•ë³´ í•„ìš”</li>
                        </ul>
                    </div>
                </div>

                <p class="citation-footer">ì¶œì²˜: Cleland et al. (2006)<br>
                    <span style="color: #000000; font-size: 16px; font-weight: 500;">â€» 2025ë…„: US ê°€ì¡±ê³„íš ì›ì¡° $1.74B ìš”ì²­, ì•„í”„ë¦¬ì¹´ ë¯¸ì¶©ì¡± ìˆ˜ìš” 24% (UNFPA, 2024)</span>
                </p>
            </div>

            <!-- Slide 7: MDGì™€ ê°€ì¡±ê³„íš (ì›ë˜ Slide 6) -->
            <div class="slide">
                <h1>ë°€ë ˆë‹ˆì—„ ê°œë°œëª©í‘œ(MDG)ì™€ ê°€ì¡±ê³„íš</h1>
                <div class="two-column">
                    <div>
                        <h3>MDGì™€ ê°€ì¡±ê³„íš ì—°ê³„</h3>
                        <div class="panel-box">
                            <h4>MDG 5: ëª¨ì„± ê±´ê°• ê°œì„ </h4>
                            <p style="font-size: 19px;">
                                <strong>ëª©í‘œ 5A:</strong> ëª¨ì„± ì‚¬ë§ë¥  75% ê°ì†Œ<br>
                                <strong>ëª©í‘œ 5B:</strong> ìƒì‹ê±´ê°• ë³´í¸ì  ì ‘ê·¼<br>
                                <span style="margin-left: 20px;">â€¢ 2007ë…„ ì¶”ê°€ (ì´ˆê¸° MDGì—ì„œ ì œì™¸)</span><br>
                                <span style="margin-left: 20px;">â€¢ ëª¨ì„± ì‚¬ë§ 32% ì˜ˆë°© ê°€ëŠ¥ (Cleland et al., 2006)</span>
                            </p>
                        </div>
                        <div class="panel-box">
                            <h4>MDG 4: ì•„ë™ ì‚¬ë§ë¥  ê°ì†Œ</h4>
                            <p style="font-size: 19px;">
                                <span style="margin-left: 20px;">â€¢ ì¶œì‚° ê°„ê²© ì¡°ì ˆë¡œ ì˜ì•„ ì‚¬ë§ ê°ì†Œ</span><br>
                                <span style="margin-left: 20px;">â€¢ ì•„ë™ ì‚¬ë§ 10% ê°ì†Œ ê°€ëŠ¥</span><br>
                                <span style="margin-left: 20px;">â€¢ ì‚°ì „ ê´€ë¦¬ ì ‘ê·¼ì„± ê°œì„ </span>
                            </p>
                        </div>
                        <div class="panel-box">
                            <h4>MDG 1 & 3: ë¹ˆê³¤ í‡´ì¹˜ì™€ ì„±í‰ë“±</h4>
                            <p style="font-size: 19px;">
                                <span style="margin-left: 20px;">â€¢ ê°€êµ¬ ê·œëª¨ ê°ì†Œë¡œ ìì› ì§‘ì¤‘</span><br>
                                <span style="margin-left: 20px;">â€¢ ì—¬ì„± ë…¸ë™ ì°¸ì—¬ ì¦ê°€</span><br>
                                <span style="margin-left: 20px;">â€¢ êµìœ¡ ê¸°íšŒ í™•ëŒ€</span>
                            </p>
                        </div>
                    </div>
                    <div>
                        <h3>ìƒì‹ê±´ê°• ëª©í‘œì˜ ì—­ì‚¬</h3>
                        <div class="quote-box" style="background: linear-gradient(135deg, #fef5e7 0%, #fdebd0 100%);">
                            <p style="font-size: 20px;">
                                <strong>1994ë…„:</strong> ì¹´ì´ë¡œ íšŒì˜ - ìƒì‹ê±´ê°•ê¶Œ í•©ì˜<br>
                                <strong>2000ë…„:</strong> MDG ì œì • - ìƒì‹ê±´ê°• ì œì™¸<br>
                                <strong>2007ë…„:</strong> MDG 5B ì¶”ê°€ (13ë…„ ì§€ì—°)
                            </p>
                        </div>
                        <div class="panel-box" style="margin-top: 15px;">
                            <h4>ë‹¬ì„± í˜„í™© (2015ë…„)</h4>
                            <ul style="font-size: 18px; padding-left: 20px; list-style: none;">
                                <li style="margin: 5px 0;">â€¢ <strong>ëª¨ì„± ì‚¬ë§ë¥ :</strong> 45% ê°ì†Œ (ëª©í‘œ 75% ë¯¸ë‹¬)</li>
                                <li style="margin: 5px 0;">â€¢ <strong>í”¼ì„ë¥ :</strong> 64% (55%ì—ì„œ ì¦ê°€)</li>
                                <li style="margin: 5px 0;">â€¢ <strong>ë¯¸ì¶©ì¡± ìˆ˜ìš”:</strong> 12% ì—¬ì„±</li>
                                <li style="margin: 5px 0;">â€¢ <strong>ì‚°ì „ ê´€ë¦¬(4íšŒ+):</strong> 64%</li>
                            </ul>
                        </div>
                        <div class="quote-box" style="margin-top: 15px;">
                            <p>"ê°€ì¡±ê³„íšì€ ëª¨ë“  MDG ë‹¬ì„±ì˜ í•µì‹¬ ê°œì…"</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 7: ê±´ê°• í˜œíƒ ì¢…í•© -->
            <div class="slide">
                <h1>ê°€ì¡±ê³„íšì˜ ê±´ê°• ì˜í–¥</h1>
                <div class="two-column">
                    <div>
                        <h3>ëª¨ì„± ë° ì˜ì•„ ê±´ê°• ê°œì„ </h3>
                        <div class="panel-box" style="background: linear-gradient(135deg, #e5f5e0 0%, #c8e6c9 100%);">
                            <h4>ì˜ˆë°© ê°€ëŠ¥í•œ ì‚¬ë§</h4>
                            <p style="font-size: 19px;">
                                <strong>ëª¨ì„± ì‚¬ë§:</strong> 32% ì˜ˆë°© ê°€ëŠ¥<br>
                                <strong>ì˜ì•„ ì‚¬ë§:</strong> ê±°ì˜ 10% ê°ì†Œ<br>
                                <span style="font-size: 16px; font-style: italic;">(Cleland et al., 2006)</span>
                            </p>
                        </div>
                        <div class="panel-box" style="margin-top: 15px;">
                            <h4>ê±´ê°• ê°œì„  íš¨ê³¼</h4>
                            <ul style="font-size: 18px; padding-left: 20px; list-style: none;">
                                <li style="margin: 5px 0;">â€¢ ëª¨ì„± ë¹ˆí˜ˆ ê°ì†Œ</li>
                                <li style="margin: 5px 0;">â€¢ ì˜ì•„ ì €ì²´ì¤‘ ì˜ˆë°©</li>
                                <li style="margin: 5px 0;">â€¢ ëª¨ìœ ìˆ˜ìœ  ê¸°ê°„ ì—°ì¥</li>
                                <li style="margin: 5px 0;">â€¢ ì‚°í›„ íšŒë³µ ê°œì„ </li>
                            </ul>
                        </div>
                    </div>
                    <div>
                        <h3>ì¶œì‚° ê°„ê²©ì˜ ì¤‘ìš”ì„±</h3>
                        <div class="panel-box">
                            <h4>ê¶Œì¥ ì¶œì‚° ê°„ê²©</h4>
                            <p style="font-size: 19px;">
                                <span style="margin-left: 20px;">â€¢ ìµœì†Œ 2ë…„ ì´ìƒ ê¶Œì¥</span><br>
                                <span style="margin-left: 20px;">â€¢ ëª¨ì„± ë° ì˜ì•„ ê±´ê°• ê°œì„ </span><br>
                                <span style="margin-left: 20px;">â€¢ ì˜ì–‘ ìƒíƒœ íšŒë³µ ê¸°ê°„ í™•ë³´</span>
                            </p>
                        </div>
                        <div class="panel-box" style="background: #fef3c7;">
                            <h4>ìœ„í—˜ ì„ì‹  ì˜ˆë°©</h4>
                            <p style="font-size: 19px;">
                                <span style="margin-left: 20px;">â€¢ ë„ˆë¬´ ì´ë¥¸ ì„ì‹  (18ì„¸ ì´í•˜)</span><br>
                                <span style="margin-left: 20px;">â€¢ ë„ˆë¬´ ëŠ¦ì€ ì„ì‹  (35ì„¸ ì´ìƒ)</span><br>
                                <span style="margin-left: 20px;">â€¢ ë„ˆë¬´ ì¦ì€ ì„ì‹  (ê°„ê²© 2ë…„ ë¯¸ë§Œ)</span><br>
                                <span style="margin-left: 20px;">â€¢ ë„ˆë¬´ ë§ì€ ì„ì‹  (4íšŒ ì´ìƒ)</span>
                            </p>
                        </div>
                        <div class="quote-box" style="margin-top: 15px;">
                            <p>"ê°€ì¡±ê³„íšì€ ê°€ì¥ ë¹„ìš©íš¨ê³¼ì ì¸ ë³´ê±´ ê°œì…"<br>
                            <span style="font-size: 20px;">(Cleland et al., 2006)</span></p>
                            <p style="font-size: 16px; color: #c97064; margin-top: 10px; font-style: italic;">
                                â€» 2025ë…„: ê°€ì¡±ê³„íšìœ¼ë¡œ ì—°ê°„ 39,000ëª… ëª¨ì„±ì‚¬ë§ ì˜ˆë°© (UNFPA, 2024)
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 8: ê²½ì œì  ì˜í–¥ê³¼ ë‚¨í•œ ì‚¬ë¡€ -->
            <div class="slide">
                <h1>ì¸êµ¬ ë°°ë‹¹ê³¼ ê²½ì œ ì„±ì¥: ë‚¨í•œ ì‚¬ë¡€</h1>
                <div class="two-column">
                    <div>
                        <h3>ëŒ€í•œë¯¼êµ­ì˜ ì¸êµ¬ êµ¬ì¡° ë³€í™” (1960-2020)</h3>
                        <!-- íƒ€ì„ë¼ì¸ ìŠ¬ë¼ì´ë” -->
                        <div style="margin-bottom: 20px;">
                            <label style="font-size: 16px; font-weight: 600;">ì—°ë„ ì„ íƒ: <span id="yearDisplay" style="color: #3b82f6;">1960</span></label>
                            <input type="range" id="yearSlider" min="1960" max="2020" step="10" value="1960"
                                   style="width: 100%; margin-top: 10px; cursor: pointer;"
                                   oninput="updatePyramidBySlider(this.value)">
                            <div style="display: flex; justify-content: space-between; font-size: 12px; color: #666; margin-top: 5px;">
                                <span>1960</span>
                                <span>1970</span>
                                <span>1980</span>
                                <span>1990</span>
                                <span>2000</span>
                                <span>2010</span>
                                <span>2020</span>
                            </div>
                        </div>
                        <div class="chart-container" style="position: relative; height: 300px;">
                            <canvas id="koreaPyramidChart"></canvas>
                            <div id="pyramidDescription" style="position: absolute; bottom: 10px; left: 10px; right: 10px; background: rgba(255,255,255,0.95); padding: 12px; border-radius: 8px; font-size: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <strong>1960ë…„:</strong> ì „í˜•ì ì¸ í”¼ë¼ë¯¸ë“œí˜• - ë†’ì€ ì¶œìƒë¥ ê³¼ ì Šì€ ì¸êµ¬ êµ¬ì¡°
                            </div>
                        </div>
                        <p style="font-size: 14px; font-style: italic; margin-top: 5px;">
                            ì¶œì²˜: Lancet 2006; KOSIS 2024; UN Population Division 2023
                        </p>
                        <div class="panel-box" style="margin-top: 15px;">
                            <h4>ì£¼ìš” ì •ì±… ë° ì¸êµ¬ ë³€í™”</h4>
                            <ul style="font-size: 16px; line-height: 1.8;">
                                <li><strong>1961:</strong> ê°€ì¡±ê³„íš í”„ë¡œê·¸ë¨ ì‹œì‘</li>
                                <li><strong>1973:</strong> ëª¨ìë³´ê±´ë²• ì œì •</li>
                                <li><strong>1983:</strong> ë‘ ìë…€ ì •ì±… (TFR 2.0 ë‹¬ì„±)</li>
                                <li><strong>2006:</strong> ì´ˆì €ì¶œì‚° (TFR 1.13)</li>
                                <li><strong>2023:</strong> TFR 0.72 ì„¸ê³„ ìµœì €</li>
                            </ul>
                        </div>
                    </div>
                    <div>
                        <h3>ê²½ì œì  ì˜í–¥</h3>
                        <div class="panel-box" style="background: linear-gradient(135deg, #e5f5e0 0%, #c8e6c9 100%);">
                            <h4>ì¸êµ¬ ë°°ë‹¹ íš¨ê³¼</h4>
                            <p style="font-size: 19px;">
                                <strong>ë™ì•„ì‹œì•„ ê²½ì œ ê¸°ì :</strong><br>
                                1965-1990ë…„ ê²½ì œì„±ì¥ì˜ <strong>ì•½ 1/3</strong>ì´ ì¸êµ¬êµ¬ì¡° ë³€í™”ì— ê¸°ì¸
                            </p>
                            <p style="font-size: 16px; margin-top: 10px;">
                                (Cleland et al., 2006)
                            </p>
                        </div>
                        <div class="data-card" style="margin-top: 15px;">
                            <h4>TFR ê°ì†Œ</h4>
                            <div style="display: flex; align-items: center; justify-content: center;">
                                <span style="font-size: 42px; font-weight: bold;">6.0</span>
                                <span style="font-size: 18px; margin: 0 10px;">â†’</span>
                                <span style="font-size: 42px; font-weight: bold;">1.6</span>
                            </div>
                            <p style="font-size: 16px;">1960-1990ë…„</p>
                        </div>
                        <div class="data-card" style="margin-top: 10px;">
                            <h4>ê²½ì œ ì„±ì¥</h4>
                            <p style="font-size: 19px;">
                                <span style="margin-left: 20px;">â€¢ GDP ì—°í‰ê·  8% ì„±ì¥</span><br>
                                <span style="margin-left: 20px;">â€¢ 1ì¸ë‹¹ ì†Œë“ 20ë°° ì¦ê°€</span><br>
                                <span style="margin-left: 20px;">â€¢ ì €ì¶•ë¥  35% ë‹¬ì„±</span>
                            </p>
                            <p style="font-size: 16px; color: #c97064; margin-top: 10px; font-style: italic;">
                                â€» 2025ë…„ í˜„í™©: í•œêµ­ TFR 0.75 (ì„¸ê³„ ìµœì €), 9ë…„ë§Œì— ì²« ìƒìŠ¹ (KOSIS, 2024)
                            </p>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Slide 9: ë¯¸ì¶©ì¡± ìˆ˜ìš” -->
            <div class="slide">
                <h1>ë¯¸ì¶©ì¡± ìˆ˜ìš”: ì •ì˜ì™€ ì§€ì—­ë³„ ë¶„í¬</h1>
                <div class="main-with-side">
                    <div>
                        <h3>ë¯¸ì¶©ì¡± ìˆ˜ìš” ì§€ì—­ë³„ ë¶„í¬</h3>
                        <div class="chart-container" style="height: 280px;">
                            <canvas id="unmetNeedByRegion"></canvas>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px;">
                            <div class="panel-box">
                                <h4>ì›ì¸ë³„ ë¶„í¬</h4>
                                <canvas id="unmetNeedReasons" style="height: 140px;"></canvas>
                            </div>
                            <div class="panel-box">
                                <h4>ê²½ì œìˆ˜ì¤€ë³„ ì°¨ì´</h4>
                                <canvas id="unmetNeedByWealth" style="height: 140px;"></canvas>
                            </div>
                        </div>
                        <p style="font-size: 16px; margin-top: 10px; font-style: italic;">
                            ë°ì´í„°: Guttmacher Institute (2023), UN Population Division (2022)
                        </p>
                    </div>
                    <div>
                        <h3>ë¯¸ì¶©ì¡± ìˆ˜ìš”ë€?</h3>
                        <div class="panel-box" style="background: linear-gradient(135deg, #fef5e7 0%, #fdebd0 100%);">
                            <h4>ì •ì˜</h4>
                            <p style="font-size: 18px;">
                                ì„ì‹ ì„ ì›í•˜ì§€ ì•Šê±°ë‚˜ ì—°ê¸°í•˜ê³  ì‹¶ì§€ë§Œ í”¼ì„ë²•ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê°€ì„ê¸° ì—¬ì„±
                            </p>
                        </div>
                        <div class="panel-box">
                            <h4>ì§€ì—­ë³„ ë¯¸ì¶©ì¡± ìˆ˜ìš”ìœ¨</h4>
                            <ul style="font-size: 17px; padding-left: 20px; list-style: none;">
                                <li style="margin: 5px 0;">â€¢ <strong style="color: #8b0000;">ì‚¬í•˜ë¼ì´ë‚¨:</strong> 24%</li>
                                <li style="margin: 5px 0;">â€¢ <strong style="color: #cc4125;">ì„œì•„ì‹œì•„/ë¶ì•„í”„ë¦¬ì¹´:</strong> 17%</li>
                                <li style="margin: 5px 0;">â€¢ <strong style="color: #e06666;">ë‚¨ì•„ì‹œì•„:</strong> 13%</li>
                                <li style="margin: 5px 0;">â€¢ <strong style="color: #f4cccc;">ë¼í‹´ì•„ë©”ë¦¬ì¹´:</strong> 10%</li>
                                <li style="margin: 5px 0;">â€¢ <strong style="color: #d9ead3;">ë™ì•„ì‹œì•„:</strong> 6%</li>
                            </ul>
                        </div>
                        <!-- Added qualitative insights per main.pdf text analysis -->
                        <div class="panel-box" style="background: linear-gradient(135deg, #e8f4fd 0%, #d1e7f5 100%);">
                            <h4>ì£¼ìš” ì¸ì‚¬ì´íŠ¸</h4>
                            <ul style="font-size: 17px; padding-left: 20px; list-style: none;">
                                <li style="margin: 5px 0;">â€¢ <strong>ì‚¬í•˜ë¼ ì´ë‚¨:</strong> ì¶œì‚° ê°„ê²© ì¡°ì • ìˆ˜ìš” > ê°€ì¡± ìˆ˜ ì œí•œ ìˆ˜ìš”</li>
                                <li style="margin: 5px 0;">â€¢ <strong>ì•„ì‹œì•„/ë¼í‹´:</strong> ìµœë¹ˆê³¤ì¸µ ë¯¸ì¶©ì¡± ìˆ˜ìš”ê°€ ìµœë¶€ìœ ì¸µë³´ë‹¤ 2ë°° ë†’ìŒ</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);">
                            <h4>í•´ê²°ì˜ ì¤‘ìš”ì„±</h4>
                            <p style="font-size: 17px;">
                                <span style="margin-left: 20px;">â€¢ ëª¨ì„± ì‚¬ë§ ì˜ˆë°©</span><br>
                                <span style="margin-left: 20px;">â€¢ ì•ˆì „í•˜ì§€ ì•Šì€ ë‚™íƒœ ê°ì†Œ</span><br>
                                <span style="margin-left: 20px;">â€¢ ì—¬ì„± ìê¸°ê²°ì •ê¶Œ ë³´ì¥</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 10: Service Delivery, Finance and Strategies -->
            <div class="slide">
                <h1>ì„œë¹„ìŠ¤ ì „ë‹¬, ì¬ì› ì¡°ë‹¬ ë° ì‹¤í–‰ ì „ëµ</h1>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; padding: 20px;">
                    <!-- Service Delivery Column -->
                    <div>
                        <h3 style="color: #000; font-size: 22px; margin-bottom: 15px;">íš¨ê³¼ì ì¸ ì„œë¹„ìŠ¤ ì „ë‹¬</h3>
                        <div class="panel-box" style="background: #F5F0E8; border: 2px solid #B8D4CE; padding: 15px; margin-bottom: 15px;">
                            <h4 style="color: #000; font-size: 18px; margin-bottom: 10px;">ì§€ì—­ì‚¬íšŒ ê¸°ë°˜</h4>
                            <ul style="font-size: 16px; color: #000; padding-left: 20px;">
                                <li>Community Health Workers</li>
                                <li>Mobile clinics</li>
                                <li>Outreach programs</li>
                                <li>Traditional birth attendants training</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: #F5F0E8; border: 2px solid #9DC3C2; padding: 15px; margin-bottom: 15px;">
                            <h4 style="color: #000; font-size: 18px; margin-bottom: 10px;">ì‹œì„¤ ê¸°ë°˜</h4>
                            <ul style="font-size: 16px; color: #000; padding-left: 20px;">
                                <li>Postpartum/postabortion FP</li>
                                <li>Integration with MCH services</li>
                                <li>Youth-friendly services</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: #F5F0E8; border: 2px solid #A08C6C; padding: 15px;">
                            <h4 style="color: #000; font-size: 18px; margin-bottom: 10px;">í˜ì‹  ëª¨ë¸</h4>
                            <ul style="font-size: 16px; color: #000; padding-left: 20px;">
                                <li>Social franchising</li>
                                <li>Voucher schemes</li>
                                <li>mHealth applications</li>
                                <li>Public-private partnerships</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Financing Column -->
                    <div>
                        <h3 style="color: #000; font-size: 22px; margin-bottom: 15px;">ì¬ì› ì¡°ë‹¬ ë©”ì»¤ë‹ˆì¦˜</h3>
                        <div class="chart-container" style="height: 200px; margin-bottom: 15px;">
                            <canvas id="fundingSourcesPie"></canvas>
                        </div>
                        <div class="panel-box" style="background: #F5F0E8; border: 2px solid #8B6F47; padding: 15px; margin-bottom: 15px;">
                            <h4 style="color: #000; font-size: 18px; margin-bottom: 10px;">Current Gaps (2024)</h4>
                            <div style="font-size: 24px; font-weight: bold; color: #8B6F47; text-align: center; margin: 10px 0;">$3.9B shortfall</div>
                            <p style="font-size: 16px; color: #000; text-align: center;">Need $12B annually<br>Currently only $8.1B</p>
                        </div>
                        <div class="panel-box" style="background: #F5F0E8; border: 2px solid #6B5D54; padding: 15px;">
                            <h4 style="color: #000; font-size: 18px; margin-bottom: 10px;">Investment Returns</h4>
                            <ul style="font-size: 16px; color: #000; padding-left: 20px;">
                                <li><strong>1:4</strong> - Economic return ratio</li>
                                <li><strong>32M</strong> - Unintended pregnancies prevented</li>
                                <li><strong>120K</strong> - Maternal deaths averted</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Strategies Column -->
                    <div>
                        <h3 style="color: #000; font-size: 22px; margin-bottom: 15px;">í•µì‹¬ ì‹¤í–‰ ì „ëµ</h3>
                        <div class="panel-box" style="background: linear-gradient(135deg, #D4B896 0%, #A08C6C 100%); padding: 15px; margin-bottom: 15px;">
                            <h4 style="color: #FFF; font-size: 18px; margin-bottom: 10px;">Quality Improvement</h4>
                            <ul style="font-size: 16px; color: #FFF; padding-left: 20px;">
                                <li>Method mix expansion</li>
                                <li>Provider training</li>
                                <li>Supply chain strengthening</li>
                                <li>Client counseling</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: linear-gradient(135deg, #B8D4CE 0%, #9DC3C2 100%); padding: 15px; margin-bottom: 15px;">
                            <h4 style="color: #FFF; font-size: 18px; margin-bottom: 10px;">Demand Creation</h4>
                            <ul style="font-size: 16px; color: #FFF; padding-left: 20px;">
                                <li>Community mobilization</li>
                                <li>Male engagement</li>
                                <li>Mass media campaigns</li>
                                <li>Peer education</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: linear-gradient(135deg, #8B6F47 0%, #6B5D54 100%); padding: 15px;">
                            <h4 style="color: #FFF; font-size: 18px; margin-bottom: 10px;">Policy Environment</h4>
                            <ul style="font-size: 16px; color: #FFF; padding-left: 20px;">
                                <li>Remove legal barriers</li>
                                <li>Task shifting policies</li>
                                <li>Commodity security</li>
                                <li>Integration policies</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <p style="font-size: 18px; color: #000; font-style: italic;">"Effective family planning requires coordinated action across service delivery, financing, and policy" - Lancet 2006</p>
                </div>
            </div>

            <!-- Slide 11: Priority Actions and Implementation Framework -->
            <div class="slide">
                <h1>ìš°ì„  ê³¼ì œ ë° ì‹¤í–‰ í”„ë ˆì„ì›Œí¬</h1>
                <div style="display: grid; grid-template-columns: 2fr 3fr; gap: 30px; padding: 20px;">
                    <!-- Priority Countries Visual -->
                    <div>
                        <h3 style="color: #000; font-size: 22px; margin-bottom: 15px;">ìš°ì„ ìˆœìœ„ êµ­ê°€ ë¶„ë¥˜</h3>
                        <div style="position: relative; height: 400px;">
                            <!-- High Priority Circle -->
                            <div style="position: absolute; top: 20px; left: 50%; transform: translateX(-50%); text-align: center;">
                                <div style="width: 140px; height: 140px; background: linear-gradient(135deg, #8B6F47 0%, #6B5D54 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 20px rgba(139, 111, 71, 0.3);">
                                    <div style="color: white; text-align: center;">
                                        <h2 style="font-size: 36px; margin: 0; color: white;">26</h2>
                                        <p style="font-size: 14px; margin: 2px 0; color: white;">High Priority</p>
                                    </div>
                                </div>
                                <div style="background: #F5F0E8; border: 2px solid #8B6F47; padding: 10px; border-radius: 8px; margin-top: 10px; width: 200px; transform: translateX(-30px);">
                                    <p style="font-size: 14px; color: #000; margin: 2px 0;">â€¢ TFR >5</p>
                                    <p style="font-size: 14px; color: #000; margin: 2px 0;">â€¢ CPR <20%</p>
                                    <p style="font-size: 14px; color: #000; margin: 2px 0;">â€¢ Unmet need >20%</p>
                                </div>
                            </div>
                            <!-- Medium Priority Circle -->
                            <div style="position: absolute; top: 200px; left: 20%; text-align: center;">
                                <div style="width: 120px; height: 120px; background: linear-gradient(135deg, #D4B896 0%, #A08C6C 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 6px 15px rgba(212, 184, 150, 0.3);">
                                    <div style="color: white; text-align: center;">
                                        <h2 style="font-size: 30px; margin: 0; color: white;">31</h2>
                                        <p style="font-size: 12px; margin: 2px 0; color: white;">Medium</p>
                                    </div>
                                </div>
                            </div>
                            <!-- Low Priority Circle -->
                            <div style="position: absolute; top: 200px; right: 20%; text-align: center;">
                                <div style="width: 100px; height: 100px; background: linear-gradient(135deg, #B8D4CE 0%, #9DC3C2 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(184, 212, 206, 0.3);">
                                    <div style="color: white; text-align: center;">
                                        <h2 style="font-size: 26px; margin: 0; color: white;">18</h2>
                                        <p style="font-size: 11px; margin: 2px 0; color: white;">Low</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-box" style="background: #F5F0E8; border: 2px solid #8B6F47; padding: 15px; margin-top: 20px;">
                            <h4 style="color: #000; font-size: 18px;">Geographic Focus</h4>
                            <p style="font-size: 16px; color: #000;"><strong>85%</strong> of high-priority countries are in Sub-Saharan Africa</p>
                            <p style="font-size: 14px; color: #666; margin-top: 5px;">Based on 75 low- and lower-middle income countries</p>
                        </div>
                    </div>

                    <!-- Action Framework -->
                    <div>
                        <h3 style="color: #000; font-size: 22px; margin-bottom: 15px;">ì‹¤í–‰ì„ ìœ„í•œ í•µì‹¬ í–‰ë™</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <!-- Political Commitment -->
                            <div class="panel-box" style="background: linear-gradient(135deg, #8B6F47 0%, #6B5D54 100%); padding: 15px;">
                                <h4 style="color: #FFF; font-size: 18px; margin-bottom: 10px;">ì •ì¹˜ì  ì•½ì†</h4>
                                <ul style="font-size: 15px; color: #FFF; padding-left: 20px;">
                                    <li>National FP strategies</li>
                                    <li>Budget allocation</li>
                                    <li>Legal framework reform</li>
                                    <li>Multi-sectoral coordination</li>
                                </ul>
                            </div>

                            <!-- Health System -->
                            <div class="panel-box" style="background: linear-gradient(135deg, #D4B896 0%, #A08C6C 100%); padding: 15px;">
                                <h4 style="color: #FFF; font-size: 18px; margin-bottom: 10px;">ë³´ê±´ ì‹œìŠ¤í…œ ê°•í™”</h4>
                                <ul style="font-size: 15px; color: #FFF; padding-left: 20px;">
                                    <li>Infrastructure development</li>
                                    <li>Human resource capacity</li>
                                    <li>Supply chain management</li>
                                    <li>Information systems</li>
                                </ul>
                            </div>

                            <!-- Community Engagement -->
                            <div class="panel-box" style="background: linear-gradient(135deg, #B8D4CE 0%, #9DC3C2 100%); padding: 15px;">
                                <h4 style="color: #FFF; font-size: 18px; margin-bottom: 10px;">ì§€ì—­ì‚¬íšŒ ì°¸ì—¬</h4>
                                <ul style="font-size: 15px; color: #FFF; padding-left: 20px;">
                                    <li>Religious leader engagement</li>
                                    <li>Male involvement</li>
                                    <li>Youth participation</li>
                                    <li>Women empowerment</li>
                                </ul>
                            </div>

                            <!-- Innovation -->
                            <div class="panel-box" style="background: linear-gradient(135deg, #9DC3C2 0%, #7DB8B5 100%); padding: 15px;">
                                <h4 style="color: #FFF; font-size: 18px; margin-bottom: 10px;">í˜ì‹ ê³¼ ê¸°ìˆ </h4>
                                <ul style="font-size: 15px; color: #FFF; padding-left: 20px;">
                                    <li>Digital health solutions</li>
                                    <li>New contraceptive methods</li>
                                    <li>Self-care approaches</li>
                                    <li>Data-driven decisions</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Key Messages -->
                        <div class="panel-box" style="background: #F5F0E8; border: 3px solid #8B6F47; padding: 20px; margin-top: 20px;">
                            <h4 style="color: #000; font-size: 20px; margin-bottom: 15px; text-align: center;">í•µì‹¬ ë©”ì‹œì§€</h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; text-align: center;">
                                <div>
                                    <div style="font-size: 32px; font-weight: bold; color: #8B6F47;">201M</div>
                                    <p style="font-size: 14px; color: #000; margin-top: 5px;">Women with unmet need</p>
                                </div>
                                <div>
                                    <div style="font-size: 32px; font-weight: bold; color: #D4B896;">$1â†’$4</div>
                                    <p style="font-size: 14px; color: #000; margin-top: 5px;">Return on investment</p>
                                </div>
                                <div>
                                    <div style="font-size: 32px; font-weight: bold; color: #9DC3C2;">2030</div>
                                    <p style="font-size: 14px; color: #000; margin-top: 5px;">Universal access goal</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>



            <!-- Slide 20: ì°¸ê³ ë¬¸í—Œ (APA 7th Edition) -->
            <div class="slide">
                <h1>ì°¸ê³ ë¬¸í—Œ (References)</h1>
                <div style="overflow-y: auto; height: calc(100% - 100px); padding-right: 20px;">
                    <div class="panel-box" style="background: #f9fafb; padding: 15px;">
                        <p style="font-size: 14px; line-height: 1.5; text-align: left; color: #2d3a3a;">

                            Bloom, D. E., Canning, D., & Sevilla, J. (2003). <em>The demographic dividend: A new perspective on the economic consequences of population change</em>. RAND Corporation.<br>

                            Bongaarts, J., & Bruce, J. (1995). The causes of unmet need for contraception and the social content of services. <em>Studies in Family Planning, 26</em>(2), 57-75.<br>

                            Cleland, J., Bernstein, S., Ezeh, A., Faundes, A., Glasier, A., & Innis, J. (2006). Family planning: The unfinished agenda. <em>The Lancet, 368</em>(9549), 1810-1827. https://doi.org/10.1016/S0140-6736(06)69480-4<br>

                            Korean Statistical Information Service (KOSIS). (2024). <em>Total fertility rate statistics</em>. https://kosis.kr<br>

                            Population Connection Action. (2024). <em>FY2025 funding request for family planning</em>. https://www.populationconnectionaction.org<br>

                            Family Planning 2030. (2023). <em>FP2030 progress report 2023: The arc of progress</em>. https://fp2030.org<br>

                            Guttmacher Institute. (2023). <em>Adding it up: Investing in sexual and reproductive health</em>. https://www.guttmacher.org<br>

                            Population Council. (2023). <em>Evidence for action: Research to improve family planning programs</em>. https://www.popcouncil.org<br>

                            Seltzer, J. R. (2002). <em>The origins and evolution of family planning programs in developing countries</em>. RAND Corporation.<br>

                            Singh, S., Darroch, J. E., & Ashford, L. S. (2014). <em>Adding it up: The costs and benefits of investing in sexual and reproductive health</em>. Guttmacher Institute & UNFPA.<br>

                            Track20. (2023). <em>Family planning estimation tool</em>. http://www.track20.org<br>

                            United Nations, Department of Economic and Social Affairs, Population Division. (2024). <em>World population prospects 2024 revision</em>. UN DESA.<br>

                            United Nations Population Fund (UNFPA). (2024). <em>State of world population 2024</em>. UNFPA.<br>

                            United Nations Population Fund (UNFPA). (2024). <em>West and Central Africa regional report: Unmet need for family planning</em>. UNFPA WCARO.<br>

                            World Bank. (2023). <em>World development indicators: Fertility rate, total (births per woman)</em>. https://data.worldbank.org<br>

                            World Health Organization. (2023). <em>Family planning/contraception methods: Fact sheet</em>. WHO.<br>

                            World Health Organization. (2022). <em>Medical eligibility criteria for contraceptive use</em> (5th ed.). WHO Press.<br>

                            World Health Organization. (2018). <em>Family planning: A global handbook for providers</em> (3rd ed.). WHO Press & Johns Hopkins Bloomberg School of Public Health.

                        </p>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <p style="font-size: 20px; color: #718096;">
                        <strong>Note:</strong> ë³¸ í”„ë ˆì  í…Œì´ì…˜ì˜ ì£¼ìš” ë°ì´í„°ëŠ” Cleland et al. (2006)ì˜ ì—°êµ¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ë©°, ìµœì‹  í†µê³„ëŠ” ìœ„ ê¸°ê´€ë“¤ì˜ 2022-2023ë…„ ìë£Œë¥¼ ì°¸ì¡°í•˜ì˜€ìŠµë‹ˆë‹¤.
                    </p>
                </div>
            </div>

        </div>
    </div>

    <script>
        // ìŠ¬ë¼ì´ë“œ ë„¤ë¹„ê²Œì´ì…˜
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;

        // í˜ì´ì§€ ì¹´ìš´í„° ìƒì„±
        function createPageCounter() {
            const counter = document.createElement('div');
            counter.className = 'page-counter';
            counter.id = 'pageCounter';
            document.body.appendChild(counter);
            updatePageCounter();
        }

        // í˜ì´ì§€ ì¹´ìš´í„° ì—…ë°ì´íŠ¸
        function updatePageCounter() {
            const counter = document.getElementById('pageCounter');
            if (counter) {
                counter.textContent = `${currentSlide + 1} | ${totalSlides}`;
            }
        }

        // íˆ´íŒ ìœ„ì¹˜ ê³„ì‚° í•¨ìˆ˜
        function calculateTooltipPosition(tooltip, container) {
            const tooltipRect = tooltip.getBoundingClientRect();
            const containerRect = container.getBoundingClientRect();

            let x = tooltip.style.left;
            let y = tooltip.style.top;

            // ì˜¤ë¥¸ìª½ ê²½ê³„ ì²´í¬
            if (tooltipRect.right > containerRect.right) {
                x = containerRect.right - tooltipRect.width - 10 + 'px';
            }

            // ì™¼ìª½ ê²½ê³„ ì²´í¬
            if (tooltipRect.left < containerRect.left) {
                x = containerRect.left + 10 + 'px';
            }

            // ì•„ë˜ìª½ ê²½ê³„ ì²´í¬
            if (tooltipRect.bottom > containerRect.bottom) {
                y = containerRect.bottom - tooltipRect.height - 10 + 'px';
            }

            // ìœ„ìª½ ê²½ê³„ ì²´í¬
            if (tooltipRect.top < containerRect.top) {
                y = containerRect.top + 10 + 'px';
            }

            tooltip.style.left = x;
            tooltip.style.top = y;
        }

        // ì¸ìš© í˜•ì‹í™” í•¨ìˆ˜ë“¤
        function formatFullCitation() {
            return "Cleland, J., Bernstein, S., Ezeh, A., Faundes, A., Glasier, A., & Innis, J. (2006). Family planning: the unfinished agenda. The Lancet, 368(9549), 1810-1827.";
        }

        function formatInTextCitation() {
            return "(Cleland et al., 2006)";
        }

        function showSlide(index) {
            if (index < 0) index = totalSlides - 1;
            if (index >= totalSlides) index = 0;

            slides.forEach(slide => slide.classList.remove('active'));
            slides[index].classList.add('active');
            currentSlide = index;

            // í˜ì´ì§€ ì¹´ìš´í„° ì—…ë°ì´íŠ¸
            updatePageCounter();

            // ìŠ¬ë¼ì´ë“œë³„ ì°¨íŠ¸ ë° ì§€ë„ ì´ˆê¸°í™”
            initSlideContent(index);
        }

        // í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') {
                showSlide(currentSlide + 1);
            } else if (e.key === 'ArrowLeft') {
                showSlide(currentSlide - 1);
            } else if (e.key === 'Home') {
                showSlide(0);
            } else if (e.key === 'End') {
                showSlide(totalSlides - 1);
            }
        });

        // êµ­ê°€ ë°ì´í„°
        const countryData = {
            niger: {
                name: 'ë‹ˆì œë¥´',
                coords: [13.5, 2.1],
                tfr: 7.1, /* Corrected TFR per Table 2 */
                contraceptive: 4.6, /* Corrected from 5% to 4.6% per Table 2 */
                unmetNeed: 19,
                maternalMortality: 553,
                trend: 'ìœ„ê¸° - ê¸‰ì†í•œ ì¸êµ¬ ì¦ê°€',
                color: '#c97064'
            },
            kenya: {
                name: 'ì¼€ëƒ',
                coords: [-1.3, 36.8],
                tfr: 4.8,
                contraceptive: 41,
                unmetNeed: 18,
                maternalMortality: 342,
                trend: 'ì •ì²´ - ì¶”ê°€ ë…¸ë ¥ í•„ìš”',
                color: '#c4a977'
            },
            brazil: {
                name: 'ë¸Œë¼ì§ˆ',
                coords: [-14.2, -51.9],
                tfr: 2.5, /* Corrected from 2.3 to 2.5 per Panel 6 */
                contraceptive: 77,
                unmetNeed: 6,
                maternalMortality: 60,
                trend: 'ì„±ê³µ - ìì—°ì  ê°ì†Œ',
                color: '#69b7a4'
            },
            bangladesh: {
                name: 'ë°©ê¸€ë¼ë°ì‹œ',
                coords: [23.7, 90.4],
                tfr: 3.0,
                contraceptive: 58,
                unmetNeed: 12,
                maternalMortality: 173,
                trend: 'ë¹ ë¥¸ ì§„ì „',
                color: '#7db8b5'
            },
            pakistan: {
                name: 'íŒŒí‚¤ìŠ¤íƒ„',
                coords: [30.4, 69.3],
                tfr: 4.3,
                contraceptive: 30,
                unmetNeed: 20,
                maternalMortality: 140,
                trend: 'ëŠë¦° ì§„ì „',
                color: '#c4a977'
            },
            iran: {
                name: 'ì´ë€',
                coords: [32.4, 53.7],
                tfr: 2.0,
                contraceptive: 73,
                unmetNeed: 8,
                maternalMortality: 16,
                trend: 'ì„±ê³µ ì‚¬ë¡€',
                color: '#69b7a4'
            },
            thailand: {
                name: 'íƒœêµ­',
                coords: [15.9, 100.9],
                tfr: 1.8,
                contraceptive: 72,
                unmetNeed: 7,
                maternalMortality: 37,
                trend: 'ì„±ê³µ ì‚¬ë¡€',
                color: '#69b7a4'
            },
            rwanda: {
                name: 'ë¥´ì™„ë‹¤',
                coords: [-1.9, 29.9],
                tfr: 4.0,
                contraceptive: 53,
                unmetNeed: 14,
                maternalMortality: 248,
                trend: 'ë¹ ë¥¸ ê°œì„ ',
                color: '#7db8b5'
            },
            mexico: {
                name: 'ë©•ì‹œì½”',
                coords: [23.6, -102.5],
                tfr: 2.2,
                contraceptive: 67,
                unmetNeed: 10,
                maternalMortality: 33,
                trend: 'ì§€ì†ì  ê°œì„ ',
                color: '#69b7a4'
            },
            indonesia: {
                name: 'ì¸ë„ë„¤ì‹œì•„',
                coords: [-0.8, 113.9],
                tfr: 2.4,
                contraceptive: 61,
                unmetNeed: 11,
                maternalMortality: 177,
                trend: 'ê¾¸ì¤€í•œ ì§„ì „',
                color: '#7db8b5'
            },
            vietnam: {
                name: 'ë² íŠ¸ë‚¨',
                coords: [14.1, 108.3],
                tfr: 1.9,
                contraceptive: 68,
                unmetNeed: 9,
                maternalMortality: 43,
                trend: 'ì„±ê³µ ì‚¬ë¡€',
                color: '#69b7a4'
            }
        };

        // ì§€ë„ ì¸ìŠ¤í„´ìŠ¤ ì €ì¥
        let maps = {};

        // ì§€ë„ ìƒì„± í•¨ìˆ˜
        function createMap(elementId, center = [0, 0], zoom = 2) {
            if (maps[elementId]) {
                maps[elementId].remove();
            }

            const mapElement = document.getElementById(elementId);
            if (!mapElement) return null;

            const map = L.map(elementId).setView(center, zoom);

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap contributors'
            }).addTo(map);

            maps[elementId] = map;
            return map;
        }

        // êµ­ê°€ ë§ˆì»¤ ì¶”ê°€ í•¨ìˆ˜
        function addCountryMarker(map, country) {
            const data = countryData[country];
            if (!data || !map) return;

            const marker = L.circleMarker(data.coords, {
                radius: 8,
                fillColor: data.color,
                color: '#fff',
                weight: 2,
                opacity: 1,
                fillOpacity: 0.8
            }).addTo(map);

            // ì»¤ìŠ¤í…€ íˆ´íŒ HTML
            const tooltipContent = `
                <div class="map-tooltip">
                    <h4>${data.name}</h4>
                    <div class="tooltip-stat">
                        <span class="tooltip-label">í•©ê³„ì¶œì‚°ìœ¨:</span>
                        <span class="tooltip-value">${data.tfr}ëª…</span>
                    </div>
                    <div class="tooltip-stat">
                        <span class="tooltip-label">í”¼ì„ ì‚¬ìš©ë¥ :</span>
                        <span class="tooltip-value">${data.contraceptive}%</span>
                    </div>
                    <div class="tooltip-stat">
                        <span class="tooltip-label">ë¯¸ì¶©ì¡± ìˆ˜ìš”:</span>
                        <span class="tooltip-value">${data.unmetNeed}%</span>
                    </div>
                    <div class="tooltip-stat">
                        <span class="tooltip-label">ëª¨ì„±ì‚¬ë§ë¥ :</span>
                        <span class="tooltip-value">${data.maternalMortality}/10ë§Œ</span>
                    </div>
                    <div class="tooltip-trend ${data.color === '#10b981' ? 'trend-positive' : data.color === '#dc2626' ? 'trend-negative' : 'trend-neutral'}">
                        ${data.trend}
                    </div>
                </div>
            `;

            marker.bindTooltip(tooltipContent, {
                permanent: false,
                direction: 'top',
                className: 'custom-tooltip',
                offset: [0, -10]
            });

            marker.on('mouseover', function() {
                this.openTooltip();
            });

            marker.on('mouseout', function() {
                this.closeTooltip();
            });

            return marker;
        }

        // ì°¨íŠ¸ ìƒì„± í•¨ìˆ˜
        function createChart(canvasId, config) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;

            const ctx = canvas.getContext('2d');

            // ê¸°ì¡´ ì°¨íŠ¸ ì œê±°
            if (canvas.chart) {
                canvas.chart.destroy();
            }

            canvas.chart = new Chart(ctx, config);
        }

        // í•œêµ­ ì¸êµ¬ í”¼ë¼ë¯¸ë“œ ë°ì´í„° ë° í•¨ìˆ˜
        const koreaPyramidData = {
            '1960': {
                labels: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                males: [-2800, -2400, -2000, -1800, -1600, -1400, -1200, -1000, -900, -800, -700, -600, -500, -400, -300, -200],
                females: [2600, 2200, 1900, 1700, 1500, 1300, 1100, 950, 850, 750, 650, 550, 450, 350, 250, 180],
                description: 'ì „í˜•ì ì¸ í”¼ë¼ë¯¸ë“œí˜• - ë†’ì€ ì¶œìƒë¥  (TFR 6.1), 15ì„¸ ë¯¸ë§Œ 41.2%',
                stats: { young: 41.2, working: 55.1, elderly: 3.7, tfr: 6.1 }
            },
            '1970': {
                labels: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                males: [-2600, -2500, -2300, -2000, -1700, -1500, -1300, -1100, -950, -850, -750, -650, -550, -450, -350, -250],
                females: [2400, 2300, 2100, 1850, 1600, 1400, 1200, 1050, 900, 800, 700, 600, 500, 400, 300, 230],
                description: 'í”¼ë¼ë¯¸ë“œí˜• ìœ ì§€ - ê°€ì¡±ê³„íš ì‹œì‘, TFR 4.2ë¡œ ê°ì†Œ, 15ì„¸ ë¯¸ë§Œ 42.1%',
                stats: { young: 42.1, working: 54.6, elderly: 3.3, tfr: 4.2 }
            },
            '1980': {
                labels: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                males: [-2000, -2300, -2500, -2400, -2200, -1800, -1500, -1300, -1100, -950, -850, -750, -650, -500, -400, -300],
                females: [1850, 2100, 2300, 2200, 2000, 1700, 1400, 1200, 1050, 900, 800, 700, 600, 450, 350, 280],
                description: 'ë³€í™” ì‹œì‘ - TFR 2.8, 15ì„¸ ë¯¸ë§Œ 34.2%, ìƒì‚°ê°€ëŠ¥ì¸êµ¬ ì¦ê°€',
                stats: { young: 34.2, working: 62.0, elderly: 3.8, tfr: 2.8 }
            },
            '1990': {
                labels: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                males: [-1600, -1800, -2100, -2300, -2400, -2200, -1900, -1600, -1300, -1100, -950, -850, -750, -600, -450, -350],
                females: [1500, 1700, 1950, 2150, 2250, 2050, 1800, 1500, 1250, 1050, 900, 800, 700, 550, 400, 350],
                description: 'ì¢…í˜• êµ¬ì¡° - TFR 1.6 ë‹¬ì„±, 15ì„¸ ë¯¸ë§Œ 25.6%, ì¸êµ¬ë°°ë‹¹ íš¨ê³¼',
                stats: { young: 25.6, working: 69.4, elderly: 5.0, tfr: 1.6 }
            },
            '2000': {
                labels: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                males: [-1400, -1600, -1800, -2000, -2100, -2000, -2100, -2200, -1900, -1600, -1300, -1000, -800, -600, -400, -300],
                females: [1300, 1500, 1700, 1900, 2000, 1900, 2000, 2100, 1800, 1500, 1200, 950, 750, 600, 450, 400],
                description: 'í•­ì•„ë¦¬í˜• - ì´ˆì €ì¶œì‚° ì‹œì‘ (TFR 1.5), 15ì„¸ ë¯¸ë§Œ 21%, ê³ ë ¹í™” ì§„ì…',
                stats: { young: 21.0, working: 71.7, elderly: 7.3, tfr: 1.5 }
            },
            '2010': {
                labels: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                males: [-1200, -1300, -1500, -1700, -1900, -2000, -1900, -2000, -2100, -2000, -1800, -1500, -1200, -900, -600, -450],
                females: [1100, 1200, 1400, 1600, 1800, 1900, 1800, 1900, 2000, 1900, 1700, 1400, 1100, 850, 600, 500],
                description: 'ë‹¤ì´ì•„ëª¬ë“œí˜• - TFR 1.2, 15ì„¸ ë¯¸ë§Œ 16.2%, ê³ ë ¹ì‚¬íšŒ ì§„ì… (11.3%)',
                stats: { young: 16.2, working: 72.5, elderly: 11.3, tfr: 1.2 }
            },
            '2020': {
                labels: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                males: [-900, -1100, -1200, -1400, -1600, -1800, -1900, -1800, -1900, -2000, -2100, -1900, -1700, -1400, -1000, -700],
                females: [850, 1000, 1100, 1300, 1500, 1700, 1800, 1700, 1800, 1900, 2000, 1800, 1600, 1350, 1000, 850],
                description: 'ì—­í”¼ë¼ë¯¸ë“œ ì§„ì… - TFR 0.84 (ì„¸ê³„ ìµœì €), 15ì„¸ ë¯¸ë§Œ 12.2%, ì´ˆê³ ë ¹ì‚¬íšŒ ì„ë°•',
                stats: { young: 12.2, working: 71.7, elderly: 16.1, tfr: 0.84 }
            }
        };

        let currentPyramidChart = null;

        function updatePyramidBySlider(year) {
            document.getElementById('yearDisplay').textContent = year;
            showPyramid(year);
        }

        function showPyramid(year) {
            // ì„¤ëª… ì—…ë°ì´íŠ¸
            const descDiv = document.getElementById('pyramidDescription');
            const data = koreaPyramidData[year];
            if (descDiv && data) {
                descDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>${year}ë…„:</strong> ${data.description}
                        </div>
                        <div style="display: flex; gap: 15px; font-size: 13px;">
                            <span>ğŸ‘¶ ${data.stats.young}%</span>
                            <span>ğŸ’¼ ${data.stats.working}%</span>
                            <span>ğŸ‘´ ${data.stats.elderly}%</span>
                        </div>
                    </div>
                `;
            }

            // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            const canvas = document.getElementById('koreaPyramidChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            const data = koreaPyramidData[year];

            if (currentPyramidChart) {
                currentPyramidChart.destroy();
            }

            currentPyramidChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: 'ë‚¨ì„±',
                            data: data.males,
                            backgroundColor: 'rgba(54, 162, 235, 0.7)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'ì—¬ì„±',
                            data: data.females,
                            backgroundColor: 'rgba(255, 99, 132, 0.7)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: {
                        title: {
                            display: true,
                            text: `í•œêµ­ ì¸êµ¬êµ¬ì¡° ${year}`,
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = Math.abs(context.parsed.x);
                                    return context.dataset.label + ': ' + value.toLocaleString() + 'ì²œëª…';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            stacked: false,
                            ticks: {
                                callback: function(value) {
                                    return Math.abs(value).toLocaleString();
                                }
                            },
                            title: {
                                display: true,
                                text: 'ì¸êµ¬ (ì²œëª…)'
                            },
                            grid: {
                                display: true
                            }
                        },
                        y: {
                            stacked: false,
                            position: 'center',
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // ìŠ¬ë¼ì´ë“œë³„ ì½˜í…ì¸  ì´ˆê¸°í™”
        function initSlideContent(slideIndex) {
            switch(slideIndex) {
                case 1: // ì—­ì‚¬ì  ë§¥ë½
                    createChart('historicalTrend', {
                        type: 'line',
                        data: {
                            labels: ['1960', '1970', '1980', '1990', '1994', '2000', '2010', '2020'],
                            datasets: [{
                                label: 'ì„¸ê³„ í‰ê·  TFR',
                                data: [5.0, 4.5, 3.6, 3.0, 2.75, 2.5, 2.4, 2.3],
                                borderColor: '#69b7a4',
                                backgroundColor: 'rgba(105, 183, 164, 0.1)',
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false },
                                title: {
                                    display: true,
                                    text: 'ì„¸ê³„ í‰ê·  í•©ê³„ì¶œì‚°ìœ¨ ë³€í™”',
                                    font: { family: 'SeoulHangang', weight: 700 }
                                },
                                annotation: {
                                    annotations: {
                                        line1: {
                                            type: 'line',
                                            xMin: '1960',
                                            xMax: '1960',
                                            borderColor: 'rgb(255, 99, 132)',
                                            borderWidth: 2,
                                            label: {
                                                display: true,
                                                content: '1960ë…„ëŒ€: ì¸êµ¬í­ë°œ ìš°ë ¤',
                                                position: 'start'
                                            }
                                        },
                                        line2: {
                                            type: 'line',
                                            xMin: '1994',
                                            xMax: '1994',
                                            borderColor: 'rgb(54, 162, 235)',
                                            borderWidth: 2,
                                            label: {
                                                display: true,
                                                content: '1994 ì¹´ì´ë¡œ íšŒì˜',
                                                position: 'center'
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    });
                    break;

                case 2: // ê¸€ë¡œë²Œ ì¸êµ¬ í˜„í™©
                    setTimeout(() => {
                        const map = createMap('worldMap');
                        if (map) {
                            // ëª¨ë“  êµ­ê°€ ë§ˆì»¤ ì¶”ê°€
                            Object.keys(countryData).forEach(country => {
                                addCountryMarker(map, country);
                            });
                        }
                    }, 100);
                    break;

                case 3: // ë‹ˆì œë¥´ ì‚¬ë¡€
                    setTimeout(() => {
                        const map = createMap('nigerMap', [17, 8], 6);
                        if (map) {
                            addCountryMarker(map, 'niger');

                            // ì£¼ë³€ êµ­ê°€ë„ í‘œì‹œ
                            addCountryMarker(map, 'kenya');
                        }
                    }, 100);
                    break;

                case 4: // í†µí•©ëœ ì„±ê³µ/ì‹¤íŒ¨ ì‚¬ë¡€ (ìŠ¬ë¼ì´ë“œ 5-6 ë³‘í•©)
                    // ë‚¨ì•„ì‹œì•„ ë¹„êµ ì°¨íŠ¸ ìƒì„±
                    createChart('southAsiaComparison', {
                        type: 'line',
                        data: {
                            labels: ['1975', '1985', '1995', '2005', '2015'],
                            datasets: [
                                {
                                    label: 'ë°©ê¸€ë¼ë°ì‹œ',
                                    data: [6.3, 5.1, 3.4, 2.9, 2.3],
                                    borderColor: '#69b7a4',
                                    backgroundColor: 'rgba(105, 183, 164, 0.1)',
                                    borderWidth: 3,
                                    tension: 0.3
                                },
                                {
                                    label: 'íŒŒí‚¤ìŠ¤íƒ„',
                                    data: [6.3, 6.0, 5.4, 4.3, 3.7],
                                    borderColor: '#c4a977',
                                    backgroundColor: 'rgba(196, 169, 119, 0.1)',
                                    borderWidth: 3,
                                    borderDash: [5, 5],
                                    tension: 0.3
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'TFR ë³€í™” ë¹„êµ: ì„±ê³µ vs ì •ì²´',
                                    font: {
                                        family: 'SeoulHangang',
                                        size: 16,
                                        weight: 700
                                    }
                                },
                                legend: {
                                    display: true,
                                    position: 'top',
                                    labels: {
                                        font: { family: 'SeoulNamsan', size: 13 },
                                        usePointStyle: true
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: false,
                                    min: 2,
                                    max: 7,
                                    title: {
                                        display: true,
                                        text: 'í•©ê³„ì¶œì‚°ìœ¨(TFR)',
                                        font: { family: 'SeoulNamsan' }
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: 'ì—°ë„',
                                        font: { family: 'SeoulNamsan' }
                                    }
                                }
                            }
                        }
                    });
                    break;

                case 5: // ìœ„ê¸°ì˜ ê°€ì¡±ê³„íš
                    // Funding Decline Chart
                    createChart('fundingDeclineChart', {
                        type: 'line',
                        data: {
                            labels: ['1995', '1997', '1999', '2001', '2003'],
                            datasets: [{
                                label: 'êµ­ì œ ì›ì¡° (ë°±ë§Œ ë‹¬ëŸ¬)',
                                data: [560, 520, 480, 470, 460],
                                borderColor: '#ef4444',
                                backgroundColor: 'rgba(239, 68, 68, 0.1)',
                                borderWidth: 3,
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false },
                                title: {
                                    display: true,
                                    text: 'ê°€ì¡±ê³„íš ì›ì¡° ê°ì†Œ ($560M â†’ $460M)',
                                    font: { size: 14, weight: '600' },
                                    color: '#e5e7eb'
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                    ticks: { color: '#e5e7eb' }
                                },
                                x: {
                                    grid: { display: false },
                                    ticks: { color: '#e5e7eb' }
                                }
                            }
                        }
                    });

                    // Africa Crisis Map
                    setTimeout(() => {
                        const mapDiv = document.getElementById('africaCrisisMap');
                        if (mapDiv && !mapDiv._leaflet_id) {
                            const map = L.map('africaCrisisMap', {
                                center: [0, 20],
                                zoom: 3,
                                zoomControl: false,
                                attributionControl: false,
                                scrollWheelZoom: false,
                                doubleClickZoom: false,
                                dragging: false
                            });

                            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
                                maxZoom: 19
                            }).addTo(map);

                            // Crisis countries with unmet need data
                            const crisisCountries = [
                                { name: 'Niger', coords: [17, 8], unmetNeed: 16 },
                                { name: 'Chad', coords: [15, 19], unmetNeed: 23 },
                                { name: 'Mali', coords: [17, -4], unmetNeed: 29 },
                                { name: 'Uganda', coords: [1, 32], unmetNeed: 35 },
                                { name: 'Kenya', coords: [-1, 37], unmetNeed: 25 },
                                { name: 'Ethiopia', coords: [8, 38], unmetNeed: 34 },
                                { name: 'Nigeria', coords: [9, 8], unmetNeed: 17 },
                                { name: 'DRC', coords: [-3, 23], unmetNeed: 27 },
                                { name: 'Tanzania', coords: [-6, 35], unmetNeed: 22 }
                            ];

                            crisisCountries.forEach(country => {
                                const radius = 10 + (country.unmetNeed * 0.5);
                                L.circleMarker(country.coords, {
                                    radius: radius,
                                    fillColor: '#8B6F47',
                                    color: '#2D5F5D',
                                    weight: 3,
                                    opacity: 0.9,
                                    fillOpacity: 0.7
                                }).addTo(map)
                                .bindTooltip(`${country.name}: ${country.unmetNeed}% ë¯¸ì¶©ì¡±`, {
                                    permanent: false,
                                    direction: 'top',
                                    className: 'crisis-tooltip'
                                });
                            });
                        }
                    }, 100);

                    // Resource Gap Chart
                    createChart('resourceGapChart', {
                        type: 'bar',
                        data: {
                            labels: ['ì•„í”„ë¦¬ì¹´ í•„ìš”(2006)', 'ê³µì—¬êµ­ ì§€ì›', 'êµ­ë‚´ ìì›'],
                            datasets: [{
                                data: [270, 113, 87],
                                backgroundColor: ['#f59e0b', '#dc2626', '#dc2626'],
                                borderColor: ['#fbbf24', '#ef4444', '#ef4444'],
                                borderWidth: 2
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false },
                                title: {
                                    display: true,
                                    text: 'ì•„í”„ë¦¬ì¹´ ê°€ì¡±ê³„íš ìê¸ˆ ê°ì†Œ (ë°±ë§Œ ë‹¬ëŸ¬)',
                                    font: { size: 14, weight: '600' },
                                    color: '#e5e7eb'
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 300,
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                    ticks: { color: '#e5e7eb' }
                                },
                                x: {
                                    grid: { display: false },
                                    ticks: { color: '#e5e7eb' }
                                }
                            }
                        }
                    });
                    break;

                case 6: // ê±´ê°• ì˜í–¥ (ì›ë˜ case 5, ì´ì „ case 7)
                    createChart('healthImpactChart', {
                        type: 'bar',
                        data: {
                            labels: ['ëª¨ì„± ì‚¬ë§', 'ì˜ì•„ ì‚¬ë§'],
                            datasets: [{
                                label: 'ì˜ˆë°© ê°€ëŠ¥ ë¹„ìœ¨ (%)',
                                data: [32, 10],
                                backgroundColor: ['#c97064', '#69b7a4']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false },
                                title: {
                                    display: true,
                                    text: 'ê°€ì¡±ê³„íšìœ¼ë¡œ ì˜ˆë°© ê°€ëŠ¥í•œ ì‚¬ë§',
                                    font: { family: 'SeoulHangang' }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 40
                                }
                            }
                        }
                    });
                    break;

                case 7: // ê²½ì œì  ì˜í–¥ê³¼ ë‚¨í•œ ì‚¬ë¡€ (Slide 8)
                    // ì¸êµ¬ í”¼ë¼ë¯¸ë“œ ì´ˆê¸°í™” (1960ë…„ ê¸°ë³¸ í‘œì‹œ)
                    showPyramid('1960');

                    // ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                    const slider = document.getElementById('yearSlider');
                    if (slider) {
                        slider.addEventListener('input', function() {
                            updatePyramidBySlider(this.value);
                        });
                    }

                    createChart('southKoreaChart', {
                        type: 'line',
                        data: {
                            labels: ['1960', '1970', '1980', '1990', '2000'],
                            datasets: [{
                                label: 'TFR',
                                data: [6.0, 4.5, 2.8, 1.6, 1.5],
                                borderColor: '#69b7a4',
                                backgroundColor: 'rgba(105, 183, 164, 0.1)',
                                yAxisID: 'y',
                                tension: 0.3
                            }, {
                                label: 'GDP ì„±ì¥ë¥  (%)',
                                data: [5, 9, 8, 9, 4],
                                borderColor: '#c4a977',
                                backgroundColor: 'rgba(196, 169, 119, 0.1)',
                                yAxisID: 'y1',
                                borderDash: [5, 5],
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                mode: 'index',
                                intersect: false
                            },
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'TFR ê°ì†Œì™€ ê²½ì œ ì„±ì¥ì˜ ìƒê´€ê´€ê³„',
                                    font: { family: 'SeoulHangang' }
                                },
                                legend: {
                                    display: true
                                }
                            },
                            scales: {
                                y: {
                                    type: 'linear',
                                    display: true,
                                    position: 'left',
                                    title: {
                                        display: true,
                                        text: 'TFR'
                                    }
                                },
                                y1: {
                                    type: 'linear',
                                    display: true,
                                    position: 'right',
                                    title: {
                                        display: true,
                                        text: 'GDP ì„±ì¥ë¥  (%)'
                                    },
                                    grid: {
                                        drawOnChartArea: false
                                    }
                                }
                            }
                        }
                    });
                    break;

                case 7: // ë¯¸ì¶©ì¡± ìˆ˜ìš” (ì›ë˜ case 10)
                    // ì§€ì—­ë³„ ë¯¸ì¶©ì¡± ìˆ˜ìš” ì°¨íŠ¸
                    createChart('unmetNeedByRegion', {
                        type: 'bar',
                        data: {
                            labels: ['ì‚¬í•˜ë¼ì´ë‚¨', 'ì„œì•„ì‹œì•„/ë¶ì•„í”„ë¦¬ì¹´', 'ë‚¨ì•„ì‹œì•„', 'ë¼í‹´ì•„ë©”ë¦¬ì¹´', 'ë™ì•„ì‹œì•„'],
                            datasets: [{
                                label: 'ë¯¸ì¶©ì¡± ìˆ˜ìš”ìœ¨ (%)',
                                data: [24, 17, 13, 10, 6],
                                backgroundColor: ['#8b0000', '#cc4125', '#e06666', '#f4cccc', '#d9ead3']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 30
                                }
                            }
                        }
                    });

                    // ì›ì¸ë³„ ë¶„í¬ ì°¨íŠ¸
                    createChart('unmetNeedReasons', {
                        type: 'pie',
                        data: {
                            labels: ['ë¶€ì‘ìš© ìš°ë ¤', 'ì ‘ê·¼ì„± ë¶€ì¡±', 'ë¬¸í™”ì  ë°˜ëŒ€', 'ì •ë³´ ë¶€ì¡±', 'ê¸°íƒ€'],
                            datasets: [{
                                data: [35, 25, 20, 15, 5],
                                backgroundColor: ['#dc2626', '#f59e0b', '#fbbf24', '#fde68a', '#fef3c7']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'right',
                                    labels: {
                                        font: {
                                            size: 11
                                        }
                                    }
                                }
                            }
                        }
                    });

                    // ê²½ì œìˆ˜ì¤€ë³„ ì°¨ì´ ì°¨íŠ¸
                    createChart('unmetNeedByWealth', {
                        type: 'line',
                        data: {
                            labels: ['ìµœë¹ˆê³¤ì¸µ', 'ë¹ˆê³¤ì¸µ', 'ì¤‘ì‚°ì¸µ', 'ë¶€ìœ ì¸µ', 'ìµœë¶€ìœ ì¸µ'],
                            datasets: [{
                                label: 'ë¯¸ì¶©ì¡± ìˆ˜ìš” (%)',
                                data: [28, 22, 16, 12, 8],
                                borderColor: '#dc2626',
                                backgroundColor: 'rgba(220, 38, 38, 0.1)',
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 30
                                }
                            }
                        }
                    });
                    break;

                case 8: // ì„œë¹„ìŠ¤ ì „ë‹¬ (ì›ë˜ case 11)
                    createChart('accessBarriers', {
                        type: 'doughnut',
                        data: {
                            labels: ['ì ‘ê·¼ì„±', 'ë¶€ì‘ìš© ìš°ë ¤', 'ë¬¸í™”ì  ë°˜ëŒ€', 'ë¹„ìš©'],
                            datasets: [{
                                data: [45, 26, 23, 6],
                                backgroundColor: ['#69b7a4', '#8fa68e', '#a8957e', '#c4a977']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });

                    // ì„œë¹„ìŠ¤ í’ˆì§ˆ ì§€í‘œ ì°¨íŠ¸
                    createChart('serviceQuality', {
                        type: 'radar',
                        data: {
                            labels: ['ì ‘ê·¼ì„±', 'ì¹œì ˆë„', 'ìƒë‹´ í’ˆì§ˆ', 'ì‚¬ìƒí™œ ë³´í˜¸', 'ëŒ€ê¸° ì‹œê°„'],
                            datasets: [{
                                label: 'í˜„ì¬ ìˆ˜ì¤€',
                                data: [65, 70, 75, 80, 60],
                                borderColor: '#69b7a4',
                                backgroundColor: 'rgba(105, 183, 164, 0.2)'
                            }, {
                                label: 'ëª©í‘œ ìˆ˜ì¤€',
                                data: [90, 90, 90, 95, 85],
                                borderColor: '#c4a977',
                                backgroundColor: 'rgba(196, 169, 119, 0.1)',
                                borderDash: [5, 5]
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                r: {
                                    beginAtZero: true,
                                    max: 100
                                }
                            }
                        }
                    });
                    break;

                case 9: // ìƒˆë¡œìš´ Slide 10: Service Delivery, Finance and Strategies
                    // Funding Sources Pie Chart
                    createChart('fundingSourcesPie', {
                        type: 'pie',
                        data: {
                            labels: ['Bilateral donors', 'Multilateral', 'Domestic resources', 'Private sector', 'Foundations'],
                            datasets: [{
                                data: [38, 27, 22, 8, 5],
                                backgroundColor: ['#8B6F47', '#D4B896', '#B8D4CE', '#9DC3C2', '#A08C6C']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        font: { size: 14 },
                                        color: '#000'
                                    }
                                }
                            }
                        }
                    });
                    break;

                case 10: // ë‚¨ì„± ì°¸ì—¬ (ì›ë˜ case 13)
                    createChart('maleInvolvement', {
                        type: 'bar',
                        data: {
                            labels: ['ì°¸ì—¬ ì „', 'ì°¸ì—¬ í›„'],
                            datasets: [{
                                label: 'í”¼ì„ ì‚¬ìš©ë¥  (%)',
                                data: [35, 62],
                                backgroundColor: ['#c4a977', '#69b7a4']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });
                    break;

                case 14: // ìê¸ˆ ì¡°ë‹¬ ìŠ¬ë¼ì´ë“œ (Slide 15)
                    createChart('fundingTrendsMain', {
                        type: 'line',
                        data: {
                            labels: ['2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023'],
                            datasets: [
                                {
                                    label: 'í•„ìš” ìê¸ˆ',
                                    data: [9.5, 9.8, 10.2, 10.6, 11.1, 11.5, 11.9, 12.1, 12.0],
                                    borderColor: '#dc2626',
                                    backgroundColor: 'rgba(220, 38, 38, 0.1)',
                                    borderWidth: 3,
                                    borderDash: [5, 5],
                                    tension: 0.4,
                                    fill: true
                                },
                                {
                                    label: 'ì‹¤ì œ ìê¸ˆ',
                                    data: [7.2, 7.3, 7.5, 7.4, 7.8, 7.6, 7.9, 8.1, 8.0],
                                    borderColor: '#10b981',
                                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                    borderWidth: 3,
                                    tension: 0.4,
                                    fill: true
                                },
                                {
                                    label: 'ìê¸ˆ ê²©ì°¨',
                                    data: [2.3, 2.5, 2.7, 3.2, 3.3, 3.9, 4.0, 4.0, 4.0],
                                    borderColor: '#f59e0b',
                                    backgroundColor: 'rgba(245, 158, 11, 0.1)',
                                    borderWidth: 2,
                                    tension: 0.4,
                                    fill: true
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: true,
                                    position: 'top',
                                    labels: {
                                        font: { size: 14 },
                                        padding: 15
                                    }
                                },
                                title: {
                                    display: true,
                                    text: 'ê°€ì¡±ê³„íš ê¸€ë¡œë²Œ ìê¸ˆ ë™í–¥ (ì‹­ì–µ ë‹¬ëŸ¬)',
                                    font: { size: 18 }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            return context.dataset.label + ': $' + context.parsed.y.toFixed(1) + 'B';
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: false,
                                    min: 0,
                                    max: 14,
                                    title: {
                                        display: true,
                                        text: 'ì‹­ì–µ ë‹¬ëŸ¬ (USD)',
                                        font: { size: 14 }
                                    },
                                    grid: {
                                        color: 'rgba(200, 200, 200, 0.3)'
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: 'ì—°ë„',
                                        font: { size: 14 }
                                    },
                                    grid: {
                                        color: 'rgba(200, 200, 200, 0.3)'
                                    }
                                }
                            }
                        }
                    });
                    break;

                case 15: // ê¸€ë¡œë²Œ ìš°ì„ ìˆœìœ„ ì¸í¬ê·¸ë˜í”½ (Slide 16)
                    // ì¸í¬ê·¸ë˜í”½ ìŠ¬ë¼ì´ë“œëŠ” ì°¨íŠ¸ê°€ ì—†ìŒ - ìˆœìˆ˜ CSSë¡œ êµ¬í˜„
                    break;

                case 16: // í•µì‹¬ ë©”ì‹œì§€ (Slide 17)
                    // í•µì‹¬ ë©”ì‹œì§€ ìŠ¬ë¼ì´ë“œëŠ” ì°¨íŠ¸ê°€ ì—†ìŒ
                    break;
            }
        }

        // ì´ˆê¸° ë¡œë“œ
        window.addEventListener('load', () => {
            createPageCounter();
            showSlide(0);
        });

        // í´ë¦­ ë„¤ë¹„ê²Œì´ì…˜ (ì¢Œìš° ì˜ì—­)
        document.addEventListener('click', (e) => {
            const viewport = document.querySelector('.presentation-viewport');
            if (!viewport.contains(e.target)) return;

            const rect = viewport.getBoundingClientRect();
            const x = e.clientX - rect.left;

            if (x < rect.width * 0.3) {
                showSlide(currentSlide - 1);
            } else if (x > rect.width * 0.7) {
                showSlide(currentSlide + 1);
            }
        });

        // PDF ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥
        async function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const button = document.querySelector('.pdf-export-btn');
            const progress = document.getElementById('pdfProgress');
            const progressText = document.getElementById('pdfProgressText');
            const progressFill = document.getElementById('pdfProgressFill');

            // ë²„íŠ¼ ë¹„í™œì„±í™” ë° ì§„í–‰ ìƒíƒœ í‘œì‹œ
            button.disabled = true;
            progress.classList.add('active');

            try {
                // PDF ìƒì„± (A4 ê°€ë¡œ ë°©í–¥)
                const pdf = new jsPDF({
                    orientation: 'landscape',
                    unit: 'mm',
                    format: 'a4'
                });

                const totalSlidesToExport = totalSlides;
                const originalSlide = currentSlide;

                // ê° ìŠ¬ë¼ì´ë“œë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ìº¡ì²˜
                for (let i = 0; i < totalSlidesToExport; i++) {
                    // ì§„í–‰ ìƒíƒœ ì—…ë°ì´íŠ¸
                    const progressPercent = ((i + 1) / totalSlidesToExport) * 100;
                    progressText.textContent = `ìŠ¬ë¼ì´ë“œ ${i + 1} / ${totalSlidesToExport} ì²˜ë¦¬ ì¤‘...`;
                    progressFill.style.width = progressPercent + '%';

                    // ìŠ¬ë¼ì´ë“œ í‘œì‹œ
                    showSlide(i);

                    // ì°¨íŠ¸ë‚˜ ì§€ë„ê°€ ë¡œë“œë  ì‹œê°„ì„ ì¤Œ
                    await new Promise(resolve => setTimeout(resolve, 500));

                    // í˜„ì¬ ìŠ¬ë¼ì´ë“œ ìº¡ì²˜
                    const slideElement = slides[i];

                    // html2canvasë¡œ ìŠ¬ë¼ì´ë“œ ìº¡ì²˜
                    const canvas = await html2canvas(slideElement, {
                        scale: 2, // ê³ í™”ì§ˆì„ ìœ„í•´ 2ë°° ìŠ¤ì¼€ì¼
                        useCORS: true,
                        logging: false,
                        backgroundColor: '#ffffff'
                    });

                    // ìº”ë²„ìŠ¤ë¥¼ ì´ë¯¸ì§€ë¡œ ë³€í™˜
                    const imgData = canvas.toDataURL('image/jpeg', 0.95);

                    // PDFì— ì´ë¯¸ì§€ ì¶”ê°€
                    if (i > 0) {
                        pdf.addPage();
                    }

                    // A4 ê°€ë¡œ ì‚¬ì´ì¦ˆì— ë§ì¶° ì´ë¯¸ì§€ ë°°ì¹˜
                    const pdfWidth = 297; // A4 ê°€ë¡œ ë„ˆë¹„ (mm)
                    const pdfHeight = 210; // A4 ê°€ë¡œ ë†’ì´ (mm)

                    // ì´ë¯¸ì§€ ë¹„ìœ¨ ê³„ì‚°
                    const imgWidth = canvas.width;
                    const imgHeight = canvas.height;
                    const ratio = Math.min(pdfWidth / imgWidth, pdfHeight / imgHeight);

                    const finalWidth = imgWidth * ratio;
                    const finalHeight = imgHeight * ratio;

                    // ì¤‘ì•™ ì •ë ¬
                    const x = (pdfWidth - finalWidth) / 2;
                    const y = (pdfHeight - finalHeight) / 2;

                    pdf.addImage(imgData, 'JPEG', x, y, finalWidth, finalHeight);

                    // ìŠ¬ë¼ì´ë“œ ë²ˆí˜¸ ì¶”ê°€ (ìš°ì¸¡ í•˜ë‹¨)
                    pdf.setFontSize(10);
                    pdf.setTextColor(100, 100, 100);
                    pdf.text(`${i + 1} / ${totalSlidesToExport}`, pdfWidth - 20, pdfHeight - 10);
                }

                // PDF ì €ì¥
                progressText.textContent = 'PDF íŒŒì¼ ìƒì„± ì™„ë£Œ!';
                pdf.save('ê°€ì¡±ê³„íš_ë¯¸ì™„ì˜_ê³¼ì œ_ë°œí‘œìë£Œ.pdf');

                // ì›ë˜ ìŠ¬ë¼ì´ë“œë¡œ ë³µê·€
                showSlide(originalSlide);

                // 2ì´ˆ í›„ ì§„í–‰ ìƒíƒœ ìˆ¨ê¹€
                setTimeout(() => {
                    progress.classList.remove('active');
                    button.disabled = false;
                    progressFill.style.width = '0%';
                }, 2000);

            } catch (error) {
                console.error('PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                alert('PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');

                // ì—ëŸ¬ ë°œìƒ ì‹œ ë³µêµ¬
                progress.classList.remove('active');
                button.disabled = false;
                progressFill.style.width = '0%';
                showSlide(originalSlide);
            }
        }
    </script>
</body>
</html><!-- Last updated: Wed, Sep 24, 2025  1:36:07 PM -->
