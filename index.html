<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>가족계획: 미완의 과제 - 통합 발표자료</title>

    <!-- Seoul Fonts CDN -->
    <link href="https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangang.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulNamsan.css" rel="stylesheet">

    <!-- External Libraries CDN -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1"></script>

    <!-- PDF Export Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        /* ==================== 기본 설정 ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Seoul 폰트 적용 및 Weight 정의 */
        @font-face {
            font-family: 'SeoulHangang';
            font-weight: 200;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangangL.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulHangang';
            font-weight: 300;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangangL.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulHangang';
            font-weight: 500;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangangM.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulHangang';
            font-weight: 700;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangangB.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulHangang';
            font-weight: 800;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangangEB.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulNamsan';
            font-weight: 300;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulNamsanL.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulNamsan';
            font-weight: 500;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulNamsanM.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulNamsan';
            font-weight: 700;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulNamsanB.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulNamsan';
            font-weight: 800;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulNamsanEB.woff') format('woff');
        }

        body {
            font-family: 'SeoulNamsan', 'Malgun Gothic', sans-serif;
            font-weight: 300;
            background: linear-gradient(135deg, #2d3a3a 0%, #576066 100%);
            overflow: hidden;
            width: 100vw;
            height: 100vh;
        }

        /* Crisis theme colors */
        :root {
            --crisis-danger: #dc2626;
            --crisis-warning: #ea580c;
            --crisis-caution: #ca8a04;
            --crisis-dark: #1f2937;
            --crisis-darker: #111827;
            --crisis-text-primary: #ffffff;
            --crisis-text-secondary: #e5e7eb;
            --crisis-text-accent: #fbbf24;
        }

        /* ==================== 16:9 비율 강제 ==================== */
        .presentation-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #000;
        }

        .presentation-viewport {
            position: relative;
            width: 100%;
            height: 100%;
            max-width: calc(100vh * 16 / 9);
            max-height: calc(100vw * 9 / 16);
            background: #fff;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            overflow: hidden;
        }

        /* ==================== 슬라이드 기본 스타일 ==================== */
        .slide {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
            padding: 40px 60px;
            background: white;
            overflow: hidden;
        }

        .slide.active {
            display: flex;
            flex-direction: column;
        }

        /* ==================== Typography ==================== */
        h1 {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 800;
            font-size: 46px;
            color: #2d3a3a;
            line-height: 1.2;
            margin-bottom: 20px;
        }

        h2 {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 700;
            font-size: 36px;
            color: #576066;
            margin-bottom: 16px;
        }

        h3 {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 500;
            font-size: 36px;
            color: #3e4948;
            margin-bottom: 14px;
        }

        h4 {
            font-family: 'SeoulNamsan', sans-serif;
            font-weight: 700;
            font-size: 22px;
            color: #576066;
            margin-bottom: 12px;
        }

        p {
            font-family: 'SeoulNamsan', sans-serif;
            font-weight: 300;
            font-size: 18px;
            line-height: 1.7;
            color: #576066;
        }

        strong, b {
            font-family: 'SeoulNamsan', sans-serif;
            font-weight: 700;
        }

        /* ==================== 레이아웃 ==================== */
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            height: calc(100% - 60px);
        }

        .three-column {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            height: calc(100% - 60px);
        }

        .main-with-side {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
            height: calc(100% - 60px);
        }

        /* ==================== 컴포넌트 스타일 ==================== */
        .panel-box {
            background: linear-gradient(135deg, #e5e7e7 0%, #d1d5d5 100%);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #69b7a4;
        }

        .data-card {
            background: white;
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s;
        }

        .data-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .stat-number {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 800;
            font-size: 48px;
            color: #69b7a4;
            margin: 8px 0;
        }

        .chart-container {
            position: relative;
            height: 250px;
            width: 100%;
            margin: 10px 0;
        }

        .small-chart {
            height: 180px;
        }

        .map-container {
            position: relative;
            height: 100%;
            width: 100%;
            border-radius: 8px;
            overflow: hidden;
        }

        /* Crisis Slide Styles */
        .crisis-slide {
            background: #F5F0E8;
        }

        .crisis-slide h1 {
            color: #000000;
            font-size: 48px;
            margin-bottom: 10px;
        }

        .crisis-slide .subtitle {
            color: #000000;
            font-size: 24px;
            margin-bottom: 30px;
        }

        .crisis-panels {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
            height: calc(100% - 180px);
            padding: 0 20px;
        }

        .crisis-panel {
            padding: 25px;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        .panel-funding {
            background: linear-gradient(135deg, #B8D4CE 0%, #9DC3C2 100%);
            border: 3px solid #4A7C7E;
        }

        .panel-africa {
            background: linear-gradient(135deg, #D4B896 0%, #A08C6C 100%);
            border: 3px solid #8B6F47;
        }

        .panel-resource {
            background: linear-gradient(135deg, #9DC3C2 0%, #B8D4CE 100%);
            border: 3px solid #2D5F5D;
        }

        .panel-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .panel-icon {
            font-size: 32px;
            margin-right: 12px;
        }

        .panel-header h3 {
            color: #000000;
            font-size: 26px;
            font-weight: 700;
            margin: 0;
        }

        .key-metric {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }

        .metric-value {
            font-size: 48px;
            font-weight: 800;
            color: #000000;
        }

        .metric-label {
            font-size: 18px;
            color: #000000;
            text-align: center;
            font-weight: 500;
        }

        .crisis-panel canvas {
            width: 100%;
            height: 150px;
            margin: 10px 0;
        }

        #africaCrisisMap {
            width: 100%;
            height: 240px;
            margin: 15px 0;
            border-radius: 8px;
            border: 2px solid #8B6F47;
            box-shadow: 0 2px 8px rgba(139, 111, 71, 0.3);
        }

        .panel-points {
            list-style: none;
            padding: 0;
            margin: 10px 0 0;
        }

        .panel-points li {
            color: #000000;
            font-size: 17px;
            margin: 10px 0;
            padding-left: 24px;
            position: relative;
            font-weight: 500;
            line-height: 1.6;
        }

        .panel-points li:before {
            content: "▸";
            position: absolute;
            left: 0;
            color: #2D5F5D;
            font-weight: bold;
            font-size: 18px;
        }

        .citation-footer {
            position: absolute;
            bottom: 20px;
            right: 40px;
            color: #000000;
            font-size: 16px;
            font-style: italic;
            font-weight: 500;
        }

        /* Timeline Slider Styles */
        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(to right, #3b82f6 0%, #93c5fd 100%);
            outline: none;
            opacity: 0.9;
            transition: opacity 0.2s;
        }

        input[type="range"]:hover {
            opacity: 1;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            transition: all 0.2s;
        }

        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            transition: all 0.2s;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            background: #2563eb;
        }

        input[type="range"]::-moz-range-thumb:hover {
            transform: scale(1.2);
            background: #2563eb;
        }

        /* 테이블 */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 18px;
            margin: 10px 0;
        }

        .data-table th {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 700;
            background: #576066;
            color: white;
            padding: 8px;
            text-align: left;
        }

        .data-table td {
            font-family: 'SeoulNamsan', sans-serif;
            font-weight: 300;
            padding: 6px 8px;
            border-bottom: 1px solid #e2e8f0;
        }

        /* 인용문 */
        .quote-box {
            position: relative;
            padding: 15px 20px;
            background: #f5f6f6;
            border-left: 3px solid #69b7a4;
            margin: 15px 0;
            font-style: italic;
        }

        /* ==================== 지도 툴팁 스타일 ==================== */
        .map-tooltip {
            font-family: 'SeoulNamsan', sans-serif;
            background: rgba(255, 255, 255, 0.98);
            border: 2px solid #69b7a4;
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            min-width: 200px;
        }

        .map-tooltip h4 {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 700;
            font-size: 20px;
            color: #2d3748;
            margin: 0 0 8px 0;
            padding-bottom: 6px;
            border-bottom: 1px solid #e2e8f0;
        }

        .tooltip-stat {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            font-size: 19px;
        }

        .tooltip-label {
            font-weight: 500;
            color: #718096;
        }

        .tooltip-value {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 700;
            color: #69b7a4;
        }

        .tooltip-trend {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #e2e8f0;
            font-size: 18px;
            font-style: italic;
        }

        .trend-positive { color: #69b7a4; }
        .trend-negative { color: #c97064; }
        .trend-neutral { color: #718096; }

        /* ==================== UI 컨트롤 숨김 ==================== */
        .nav-controls, .timer-display, .progress-bar, .slide-number {
            display: none !important;
        }

        /* ==================== 페이지 카운터 ==================== */
        .page-counter {
            position: fixed;
            bottom: 20px;
            right: 20px;
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 700;
            font-size: 24px;
            color: #2d3a3a;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 16px;
            border-radius: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 1000;
        }

        /* ==================== PDF 내보내기 ==================== */
        .pdf-export-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(59, 130, 246, 0.3);
            z-index: 1000;
            transition: all 0.3s;
            font-family: 'SeoulNamsan', sans-serif;
            display: none; /* 버튼 숨기기 */
        }

        .pdf-export-btn:hover {
            background: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }

        .pdf-export-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }

        .pdf-progress {
            position: fixed;
            top: 70px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            display: none;
            z-index: 1001;
            min-width: 250px;
            font-family: 'SeoulNamsan', sans-serif;
        }

        .pdf-progress.active {
            display: block;
        }

        .pdf-progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .pdf-progress-fill {
            height: 100%;
            background: #3b82f6;
            border-radius: 4px;
            transition: width 0.3s;
            width: 0%;
        }

        /* ==================== 타이틀 슬라이드 ==================== */
        .title-slide {
            background: linear-gradient(135deg, #576066 0%, #3e4948 100%);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .title-slide h1 {
            font-size: 64px;
            color: #FFFFFF !important;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .title-slide p {
            color: #FFFFFF !important;
        }

        .title-slide h4 {
            color: #FFFFFF !important;
        }

        .key-messages {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 30px;
            width: 80%;
        }

        .key-message {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .key-message h4, .key-message p {
            color: #FFFFFF !important;
        }

        .key-message h4 {
            color: white;
            margin-bottom: 5px;
        }

        .key-message p {
            color: rgba(255,255,255,0.9);
            font-size: 18px;
        }

        /* ==================== 반응형 조정 ==================== */
        @media (max-width: 1200px) {
            h1 { font-size: 42px; }
            h2 { font-size: 42px; }
            h3 { font-size: 18px; }
            p { font-size: 19px; }
            .slide { padding: 30px 40px; }
        }
    </style>
</head>
<body>
    <!-- PDF 내보내기 버튼 -->
    <button class="pdf-export-btn" onclick="exportToPDF()">PDF로 저장</button>

    <!-- PDF 진행 상태 -->
    <div class="pdf-progress" id="pdfProgress">
        <div>PDF 생성 중...</div>
        <div id="pdfProgressText">준비 중...</div>
        <div class="pdf-progress-bar">
            <div class="pdf-progress-fill" id="pdfProgressFill"></div>
        </div>
    </div>

    <div class="presentation-container">
        <div class="presentation-viewport">

            <!-- Slide 1: 타이틀 + 핵심 메시지 -->
            <div class="slide title-slide active">
                <h1>가족계획: 미완의 과제</h1>
                <p style="font-size: 42px; margin-bottom: 30px;">
                    Family planning: The unfinished agenda
                </p>
                <div class="key-messages">
                    <div class="key-message">
                        <h4>보건 향상</h4>
                        <p>모성·영아 사망률 감소</p>
                    </div>
                    <div class="key-message">
                        <h4>경제 발전</h4>
                        <p>빈곤 감소와 성장 촉진</p>
                    </div>
                    <div class="key-message">
                        <h4>여성 권한</h4>
                        <p>교육·경제 참여 확대</p>
                    </div>
                    <div class="key-message">
                        <h4>지속가능성</h4>
                        <p>인구·환경 균형</p>
                    </div>
                </div>
                <p style="margin-top: 40px; font-size: 20px; color: #FFFFFF;">
                    Cleland, J., Bernstein, S., Ezeh, A., Faundes, A., Glasier, A., & Innis, J. (2006). Family planning: the unfinished agenda. The Lancet, 368(9549), 1810-1827.
                </p>
            </div>

            <!-- Slide 2: 역사적 맥락 -->
            <div class="slide">
                <h1>가족계획의 역사적 전환점</h1>
                <div class="two-column">
                    <div>
                        <div class="panel-box">
                            <h3>1960년대: 시작</h3>
                            <p><strong>인구 폭발 우려</strong></p>
                            <ul style="font-size: 19px; margin: 10px 0; padding-left: 20px; list-style: none;">
                                <li style="margin: 5px 0;">• 개발도상국 급속 인구 증가</li>
                                <li style="margin: 5px 0;">• 경제발전 저해 우려</li>
                                <li style="margin: 5px 0;">• 정부 주도 프로그램 시작</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: linear-gradient(135deg, #fef5e7 0%, #fdebd0 100%);">
                            <h3>1994년: 카이로 회의</h3>
                            <p><strong>패러다임 전환</strong></p>
                            <ul style="font-size: 19px; margin: 10px 0; padding-left: 20px; list-style: none;">
                                <li style="margin: 5px 0;">• 인구 목표 → 개인 권리</li>
                                <li style="margin: 5px 0;">• 숫자 중심 → 인권 중심</li>
                                <li style="margin: 5px 0;">• 여성 생식건강권 강조</li>
                            </ul>
                        </div>
                    </div>
                    <div>
                        <h3>주요 성과와 도전</h3>
                        <div class="chart-container">
                            <canvas id="historicalTrend"></canvas>
                        </div>
                        <div class="data-card" style="margin-top: 15px;">
                            <p style="font-size: 19px;">전 세계 피임 사용률 (Cleland et al., 2006)</p>
                            <div class="stat-number">10% → 60%</div>
                            <p style="font-size: 18px; color: #718096;">1960 → 2005</p>
                            <p style="font-size: 16px; color: #c97064; margin-top: 10px; font-style: italic;">
                                ※ 2025년 현황: 65% (현대적 방법 59%) (UN, 2024)
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 3: 글로벌 인구 현황 (지도 포함) -->
            <div class="slide">
                <h1>글로벌 인구 동향과 지역별 현황</h1>
                <div class="main-with-side">
                    <div>
                        <div class="map-container" id="worldMap" style="height: 350px;"></div>
                        <div style="display: flex; gap: 15px; margin-top: 15px;">
                            <div class="data-card" style="flex: 1;">
                                <p>1960년</p>
                                <div class="stat-number" style="font-size: 36px;">30.2억</div>
                            </div>
                            <div class="data-card" style="flex: 1;">
                                <p>2005년</p>
                                <div class="stat-number" style="font-size: 36px;">64.6억</div>
                            </div>
                            <div class="data-card" style="flex: 1;">
                                <p>2050년 예측</p>
                                <div class="stat-number" style="font-size: 36px;">90.8억</div>
                            </div>
                        </div>
                        <p style="font-size: 16px; color: #c97064; margin-top: 10px; font-style: italic; text-align: center;">
                            ※ 2025년 현황: 세계 TFR 2.3 (UN, 2024)
                        </p>
                    </div>
                    <div>
                        <h3>지역별 인구 (Table 1, Lancet 2006)</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>지역</th>
                                    <th>1960</th>
                                    <th>2005</th>
                                    <th>2050</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background: #f0f9ff;">
                                    <td><strong>세계 전체</strong></td>
                                    <td>3,019M</td>
                                    <td>6,464M</td>
                                    <td>9,075M</td>
                                </tr>
                                <tr>
                                    <td>선진국</td>
                                    <td>916M</td>
                                    <td>1,211M</td>
                                    <td>1,236M</td>
                                </tr>
                                <tr>
                                    <td>개발도상국</td>
                                    <td>2,104M</td>
                                    <td>5,253M</td>
                                    <td>7,839M</td>
                                </tr>
                                <tr style="background: #fafafa;">
                                    <td colspan="4" style="font-weight: 600; padding: 8px;">대륙별</td>
                                </tr>
                                <tr>
                                    <td>아프리카</td>
                                    <td>283M</td>
                                    <td>906M</td>
                                    <td>1,937M</td>
                                </tr>
                                <tr>
                                    <td>아시아</td>
                                    <td>1,699M</td>
                                    <td>3,905M</td>
                                    <td>5,217M</td>
                                </tr>
                                <tr>
                                    <td>유럽</td>
                                    <td>604M</td>
                                    <td>728M</td>
                                    <td>653M</td>
                                </tr>
                                <tr>
                                    <td>라틴아메리카/카리브</td>
                                    <td>221M</td>
                                    <td>561M</td>
                                    <td>783M</td>
                                </tr>
                                <tr>
                                    <td>북아메리카</td>
                                    <td>204M</td>
                                    <td>329M</td>
                                    <td>438M</td>
                                </tr>
                                <tr>
                                    <td>오세아니아</td>
                                    <td>16M</td>
                                    <td>33M</td>
                                    <td>48M</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="panel-box" style="margin-top: 15px;">
                            <h4>핵심 인사이트</h4>
                            <p style="font-size: 18px;">
                                <span style="margin-left: 20px;">• 전체 증가분의 <strong>95%</strong>가 개발도상국에서 발생</span><br>
                                <span style="margin-left: 20px;">• 아프리카 인구 <strong>2.1배</strong> 증가 예상 (906M→1,937M)</span><br>
                                <span style="margin-left: 20px;">• 유럽은 유일하게 <strong>인구 감소</strong> 예상 (728M→653M)</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 4: 니제르 사례 -->
            <div class="slide">
                <h1>사하라이남 아프리카: 니제르 위기</h1>
                <div class="two-column">
                    <div>
                        <div id="nigerMap" class="map-container" style="height: 280px;"></div>
                        <div class="panel-box" style="margin-top: 15px; background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);">
                            <h3>니제르 현황</h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div>
                                    <p style="font-size: 16px; color: #718096;">합계출산율 (1998)</p>
                                    <p style="font-size: 42px; font-weight: 800; color: #dc2626;">7.5명</p>
                                </div>
                                <div>
                                    <p style="font-size: 16px; color: #718096;">피임 사용률</p>
                                    <p style="font-size: 42px; font-weight: 800; color: #dc2626;">4.6%</p>
                                </div>
                                <div>
                                    <p style="font-size: 16px; color: #718096;">인구 증가율</p>
                                    <p style="font-size: 42px; font-weight: 800; color: #dc2626;">3.3%/년</p>
                                </div>
                                <div>
                                    <p style="font-size: 16px; color: #718096;">2050년 예측</p>
                                    <p style="font-size: 42px; font-weight: 800; color: #dc2626;">5,000만명</p><!-- Corrected from <5천만 to 5,000만 per Table 2 -->
                                </div>
                                <div>
                                    <p style="font-size: 16px; color: #718096;">현재 인구 (2005)</p>
                                    <p style="font-size: 42px; font-weight: 800; color: #dc2626;">1,400만명</p><!-- Corrected from 1,250만 to 1,400만 per Table 2 -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3>도전과 결과</h3>
                        <div class="quote-box">
                            <p>"현재 추세 지속 시 2050년까지 인구 4배 증가, 식량 안보와 환경 지속가능성 위협"</p>
                        </div>
                        <h4>주요 장애요인</h4>
                        <ul style="font-size: 19px; line-height: 1.8;">
                            <li>👥 <strong>문화적 요인</strong>: 대가족 선호, 조혼 관습</li>
                            <li>🏥 <strong>서비스 접근성</strong>: 농촌 지역 의료 시설 부족</li>
                            <li>📚 <strong>교육 부족</strong>: 여성 문해율 15% 미만</li>
                            <li>💰 <strong>경제적 제약</strong>: 피임 비용 부담</li>
                            <li>⚖️ <strong>성 불평등</strong>: 여성 의사결정권 제한</li>
                        </ul>
                        <div class="data-card" style="background: #fef3c7; margin-top: 15px;">
                            <h4 style="color: #92400e;">긴급 대응 필요</h4>
                            <p style="font-size: 18px;">
                                통합적 접근: 교육 + 보건 + 여성권한 + 경제개발
                            </p>
                            <p style="font-size: 16px; color: #c97064; margin-top: 10px; font-style: italic;">
                                ※ 2025년 현황: Niger TFR 6.7명 (세계 최고), 피임률 17% (UN, 2024)
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 5: 통합된 성공/실패 사례 -->
            <div class="slide">
                <h1>가족계획 성공과 실패: 국가별 비교</h1>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; height: 85%;">
                    <!-- 왼쪽: 성공 사례들 -->
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <h3 style="text-align: center; margin: 5px 0;">✅ 성공 사례</h3>

                        <!-- 케냐 -->
                        <div class="panel-box" style="background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); flex: 1;">
                            <h4 style="margin: 5px 0;">🇰🇪 케냐: 정부 주도</h4>
                            <div style="display: flex; gap: 10px; margin: 5px 0;">
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">TFR</span><br>
                                    <strong style="color: #059669;">8.0→4.8</strong>
                                </div>
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">피임률</span><br>
                                    <strong style="color: #059669;">7→27%</strong>
                                </div>
                            </div>
                            <p style="font-size: 14px; margin: 5px 0;">
                                • 강력한 정치적 의지<br>
                                • 지역사회 기반 프로그램
                            </p>
                        </div>

                        <!-- 브라질 -->
                        <div class="panel-box" style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); flex: 1;">
                            <h4 style="margin: 5px 0;">🇧🇷 브라질: 사회 주도</h4>
                            <div style="display: flex; gap: 10px; margin: 5px 0;">
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">TFR</span><br>
                                    <strong style="color: #2563eb;">6.2→2.5</strong>
                                </div>
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">피임률</span><br>
                                    <strong style="color: #2563eb;">77%</strong>
                                </div>
                            </div>
                            <p style="font-size: 14px; margin: 5px 0;">
                                • 미디어 영향 (TV 노벨라)<br>
                                • 여성 교육 확대
                            </p>
                        </div>

                        <!-- 방글라데시 -->
                        <div class="panel-box" style="background: linear-gradient(135deg, #e5f5e0 0%, #c8e6c9 100%); flex: 1;">
                            <h4 style="margin: 5px 0;">🇧🇩 방글라데시: 혁신적 접근</h4>
                            <div style="display: flex; gap: 10px; margin: 5px 0;">
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">TFR</span><br>
                                    <strong style="color: #16a34a;">6.3→3.0</strong>
                                </div>
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">피임률</span><br>
                                    <strong style="color: #16a34a;">58%</strong>
                                </div>
                            </div>
                            <p style="font-size: 14px; margin: 5px 0;">
                                • 여성 지역보건요원<br>
                                • 문맹 여성 프로그램<br>
                                • 소액금융 연계
                            </p>
                        </div>
                    </div>

                    <!-- 오른쪽: 실패/정체 사례 및 차트 -->
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <h3 style="text-align: center; margin: 5px 0;">❌ 정체/실패 사례</h3>

                        <!-- 파키스탄 -->
                        <div class="panel-box" style="background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);">
                            <h4 style="margin: 5px 0;">🇵🇰 파키스탄: 정체 상태</h4>
                            <div style="display: flex; gap: 10px; margin: 5px 0;">
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">TFR</span><br>
                                    <strong style="color: #ea580c;">6.0→4.3</strong>
                                </div>
                                <div style="flex: 1; text-align: center;">
                                    <span style="font-size: 14px;">피임률</span><br>
                                    <strong style="color: #ea580c;">12%</strong>
                                </div>
                            </div>
                            <p style="font-size: 14px; margin: 5px 0;">
                                • 정치적 불안정<br>
                                • 종교적 반대<br>
                                • 여성 이동 제한
                            </p>
                        </div>

                        <!-- 비교 차트 -->
                        <div style="flex: 1; background: white; border-radius: 8px; padding: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <h4 style="margin: 5px 0; text-align: center;">남아시아 TFR 비교</h4>
                            <div class="chart-container" style="height: 200px;">
                                <canvas id="southAsiaComparison"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <p style="text-align: center; font-size: 14px; margin-top: 10px; font-style: italic;">
                    출처: Cleland et al. (2006)<br>
                    <span style="color: #c97064;">※ 2025년 현황: 방글라데시 TFR 1.9, 파키스탄 TFR 3.2 (UNFPA, 2024)</span>
                </p>
            </div>

            <!-- Slide 6: 위기의 가족계획 -->
            <div class="slide crisis-slide">
                <h1>위기의 가족계획: 국제적 외면과 자원 부족</h1>
                <p class="subtitle">가족계획이 직면한 3대 위기와 긴급한 행동의 필요성</p>

                <div class="crisis-panels">
                    <!-- Panel 1: Funding Decline -->
                    <div class="crisis-panel panel-funding">
                        <div class="panel-header">
                            <span class="panel-icon">📉</span>
                            <h3>국제 우선순위 하락</h3>
                        </div>
                        <div class="key-metric">
                            <span class="metric-value">$100M</span>
                            <span class="metric-label">자금 감소 (1995-2003)</span>
                        </div>
                        <canvas id="fundingDeclineChart"></canvas>
                        <ul class="panel-points">
                            <li>MDG에서 가족계획 제외</li>
                            <li>국제사회의 관심 급감</li>
                            <li>리더십 부재 심화</li>
                        </ul>
                    </div>

                    <!-- Panel 2: Africa Crisis -->
                    <div class="crisis-panel panel-africa">
                        <div class="panel-header">
                            <span class="panel-icon">🌍</span>
                            <h3>아프리카 위기</h3>
                        </div>
                        <div class="key-metric">
                            <span class="metric-value">3배</span>
                            <span class="metric-label">Niger 인구 증가 예상</span>
                        </div>
                        <div id="africaCrisisMap"></div>
                        <ul class="panel-points">
                            <li>HIV/AIDS보다 큰 위협</li>
                            <li>9개국 미충족 수요 증가</li>
                            <li>빈곤 악순환 지속</li>
                        </ul>
                    </div>

                    <!-- Panel 3: Resource Gap -->
                    <div class="crisis-panel panel-resource">
                        <div class="panel-header">
                            <span class="panel-icon">💰</span>
                            <h3>자원 격차</h3>
                        </div>
                        <div class="key-metric">
                            <span class="metric-value">$3.8B</span>
                            <span class="metric-label">10년 필요 자금</span>
                        </div>
                        <canvas id="resourceGapChart"></canvas>
                        <ul class="panel-points">
                            <li>아프리카: $270M 필요 vs $200M 가용</li>
                            <li>2006-2015년 총 $3.8B 필요</li>
                            <li>긴급 자금 확보 필요</li>
                        </ul>
                    </div>
                </div>

                <p class="citation-footer">출처: Cleland et al. (2006)<br>
                    <span style="color: #000000; font-size: 16px; font-weight: 500;">※ 2025년: US 가족계획 원조 $1.74B 요청, 아프리카 미충족 수요 24% (UNFPA, 2024)</span>
                </p>
            </div>

            <!-- Slide 7: MDG와 가족계획 (원래 Slide 6) -->
            <div class="slide">
                <h1>밀레니엄 개발목표(MDG)와 가족계획</h1>
                <div class="two-column">
                    <div>
                        <h3>MDG와 가족계획 연계</h3>
                        <div class="panel-box">
                            <h4>MDG 5: 모성 건강 개선</h4>
                            <p style="font-size: 19px;">
                                <strong>목표 5A:</strong> 모성 사망률 75% 감소<br>
                                <strong>목표 5B:</strong> 생식건강 보편적 접근<br>
                                <span style="margin-left: 20px;">• 2007년 추가 (초기 MDG에서 제외)</span><br>
                                <span style="margin-left: 20px;">• 모성 사망 32% 예방 가능 (Cleland et al., 2006)</span>
                            </p>
                        </div>
                        <div class="panel-box">
                            <h4>MDG 4: 아동 사망률 감소</h4>
                            <p style="font-size: 19px;">
                                <span style="margin-left: 20px;">• 출산 간격 조절로 영아 사망 감소</span><br>
                                <span style="margin-left: 20px;">• 아동 사망 10% 감소 가능</span><br>
                                <span style="margin-left: 20px;">• 산전 관리 접근성 개선</span>
                            </p>
                        </div>
                        <div class="panel-box">
                            <h4>MDG 1 & 3: 빈곤 퇴치와 성평등</h4>
                            <p style="font-size: 19px;">
                                <span style="margin-left: 20px;">• 가구 규모 감소로 자원 집중</span><br>
                                <span style="margin-left: 20px;">• 여성 노동 참여 증가</span><br>
                                <span style="margin-left: 20px;">• 교육 기회 확대</span>
                            </p>
                        </div>
                    </div>
                    <div>
                        <h3>생식건강 목표의 역사</h3>
                        <div class="quote-box" style="background: linear-gradient(135deg, #fef5e7 0%, #fdebd0 100%);">
                            <p style="font-size: 20px;">
                                <strong>1994년:</strong> 카이로 회의 - 생식건강권 합의<br>
                                <strong>2000년:</strong> MDG 제정 - 생식건강 제외<br>
                                <strong>2007년:</strong> MDG 5B 추가 (13년 지연)
                            </p>
                        </div>
                        <div class="panel-box" style="margin-top: 15px;">
                            <h4>달성 현황 (2015년)</h4>
                            <ul style="font-size: 18px; padding-left: 20px; list-style: none;">
                                <li style="margin: 5px 0;">• <strong>모성 사망률:</strong> 45% 감소 (목표 75% 미달)</li>
                                <li style="margin: 5px 0;">• <strong>피임률:</strong> 64% (55%에서 증가)</li>
                                <li style="margin: 5px 0;">• <strong>미충족 수요:</strong> 12% 여성</li>
                                <li style="margin: 5px 0;">• <strong>산전 관리(4회+):</strong> 64%</li>
                            </ul>
                        </div>
                        <div class="quote-box" style="margin-top: 15px;">
                            <p>"가족계획은 모든 MDG 달성의 핵심 개입"</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 7: 건강 혜택 종합 -->
            <div class="slide">
                <h1>가족계획의 건강 영향</h1>
                <div class="two-column">
                    <div>
                        <h3>모성 및 영아 건강 개선</h3>
                        <div class="panel-box" style="background: linear-gradient(135deg, #e5f5e0 0%, #c8e6c9 100%);">
                            <h4>예방 가능한 사망</h4>
                            <p style="font-size: 19px;">
                                <strong>모성 사망:</strong> 32% 예방 가능<br>
                                <strong>영아 사망:</strong> 거의 10% 감소<br>
                                <span style="font-size: 16px; font-style: italic;">(Cleland et al., 2006)</span>
                            </p>
                        </div>
                        <div class="panel-box" style="margin-top: 15px;">
                            <h4>건강 개선 효과</h4>
                            <ul style="font-size: 18px; padding-left: 20px; list-style: none;">
                                <li style="margin: 5px 0;">• 모성 빈혈 감소</li>
                                <li style="margin: 5px 0;">• 영아 저체중 예방</li>
                                <li style="margin: 5px 0;">• 모유수유 기간 연장</li>
                                <li style="margin: 5px 0;">• 산후 회복 개선</li>
                            </ul>
                        </div>
                    </div>
                    <div>
                        <h3>출산 간격의 중요성</h3>
                        <div class="panel-box">
                            <h4>권장 출산 간격</h4>
                            <p style="font-size: 19px;">
                                <span style="margin-left: 20px;">• 최소 2년 이상 권장</span><br>
                                <span style="margin-left: 20px;">• 모성 및 영아 건강 개선</span><br>
                                <span style="margin-left: 20px;">• 영양 상태 회복 기간 확보</span>
                            </p>
                        </div>
                        <div class="panel-box" style="background: #fef3c7;">
                            <h4>위험 임신 예방</h4>
                            <p style="font-size: 19px;">
                                <span style="margin-left: 20px;">• 너무 이른 임신 (18세 이하)</span><br>
                                <span style="margin-left: 20px;">• 너무 늦은 임신 (35세 이상)</span><br>
                                <span style="margin-left: 20px;">• 너무 잦은 임신 (간격 2년 미만)</span><br>
                                <span style="margin-left: 20px;">• 너무 많은 임신 (4회 이상)</span>
                            </p>
                        </div>
                        <div class="quote-box" style="margin-top: 15px;">
                            <p>"가족계획은 가장 비용효과적인 보건 개입"<br>
                            <span style="font-size: 20px;">(Cleland et al., 2006)</span></p>
                            <p style="font-size: 16px; color: #c97064; margin-top: 10px; font-style: italic;">
                                ※ 2025년: 가족계획으로 연간 39,000명 모성사망 예방 (UNFPA, 2024)
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 8: 경제적 영향과 남한 사례 -->
            <div class="slide">
                <h1>인구 배당과 경제 성장: 남한 사례</h1>
                <div class="two-column">
                    <div>
                        <h3>대한민국의 인구 구조 변화 (1960-2020)</h3>
                        <!-- 타임라인 슬라이더 -->
                        <div style="margin-bottom: 20px;">
                            <label style="font-size: 16px; font-weight: 600;">연도 선택: <span id="yearDisplay" style="color: #3b82f6;">1960</span></label>
                            <input type="range" id="yearSlider" min="1960" max="2020" step="10" value="1960"
                                   style="width: 100%; margin-top: 10px; cursor: pointer;"
                                   oninput="updatePyramidBySlider(this.value)">
                            <div style="display: flex; justify-content: space-between; font-size: 12px; color: #666; margin-top: 5px;">
                                <span>1960</span>
                                <span>1970</span>
                                <span>1980</span>
                                <span>1990</span>
                                <span>2000</span>
                                <span>2010</span>
                                <span>2020</span>
                            </div>
                        </div>
                        <div class="chart-container" style="position: relative; height: 300px;">
                            <canvas id="koreaPyramidChart"></canvas>
                            <div id="pyramidDescription" style="position: absolute; bottom: 10px; left: 10px; right: 10px; background: rgba(255,255,255,0.95); padding: 12px; border-radius: 8px; font-size: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <strong>1960년:</strong> 전형적인 피라미드형 - 높은 출생률과 젊은 인구 구조
                            </div>
                        </div>
                        <p style="font-size: 14px; font-style: italic; margin-top: 5px;">
                            출처: Lancet 2006; KOSIS 2024; UN Population Division 2023
                        </p>
                        <div class="panel-box" style="margin-top: 15px;">
                            <h4>주요 정책 및 인구 변화</h4>
                            <ul style="font-size: 16px; line-height: 1.8;">
                                <li><strong>1961:</strong> 가족계획 프로그램 시작</li>
                                <li><strong>1973:</strong> 모자보건법 제정</li>
                                <li><strong>1983:</strong> 두 자녀 정책 (TFR 2.0 달성)</li>
                                <li><strong>2006:</strong> 초저출산 (TFR 1.13)</li>
                                <li><strong>2023:</strong> TFR 0.72 세계 최저</li>
                            </ul>
                        </div>
                    </div>
                    <div>
                        <h3>경제적 영향</h3>
                        <div class="panel-box" style="background: linear-gradient(135deg, #e5f5e0 0%, #c8e6c9 100%);">
                            <h4>인구 배당 효과</h4>
                            <p style="font-size: 19px;">
                                <strong>동아시아 경제 기적:</strong><br>
                                1965-1990년 경제성장의 <strong>약 1/3</strong>이 인구구조 변화에 기인
                            </p>
                            <p style="font-size: 16px; margin-top: 10px;">
                                (Cleland et al., 2006)
                            </p>
                        </div>
                        <div class="data-card" style="margin-top: 15px;">
                            <h4>TFR 감소</h4>
                            <div style="display: flex; align-items: center; justify-content: center;">
                                <span style="font-size: 42px; font-weight: bold;">6.0</span>
                                <span style="font-size: 18px; margin: 0 10px;">→</span>
                                <span style="font-size: 42px; font-weight: bold;">1.6</span>
                            </div>
                            <p style="font-size: 16px;">1960-1990년</p>
                        </div>
                        <div class="data-card" style="margin-top: 10px;">
                            <h4>경제 성장</h4>
                            <p style="font-size: 19px;">
                                <span style="margin-left: 20px;">• GDP 연평균 8% 성장</span><br>
                                <span style="margin-left: 20px;">• 1인당 소득 20배 증가</span><br>
                                <span style="margin-left: 20px;">• 저축률 35% 달성</span>
                            </p>
                            <p style="font-size: 16px; color: #c97064; margin-top: 10px; font-style: italic;">
                                ※ 2025년 현황: 한국 TFR 0.75 (세계 최저), 9년만에 첫 상승 (KOSIS, 2024)
                            </p>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Slide 9: 미충족 수요 -->
            <div class="slide">
                <h1>미충족 수요: 정의와 지역별 분포</h1>
                <div class="main-with-side">
                    <div>
                        <h3>미충족 수요 지역별 분포</h3>
                        <div class="chart-container" style="height: 280px;">
                            <canvas id="unmetNeedByRegion"></canvas>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px;">
                            <div class="panel-box">
                                <h4>원인별 분포</h4>
                                <canvas id="unmetNeedReasons" style="height: 140px;"></canvas>
                            </div>
                            <div class="panel-box">
                                <h4>경제수준별 차이</h4>
                                <canvas id="unmetNeedByWealth" style="height: 140px;"></canvas>
                            </div>
                        </div>
                        <p style="font-size: 16px; margin-top: 10px; font-style: italic;">
                            데이터: Guttmacher Institute (2023), UN Population Division (2022)
                        </p>
                    </div>
                    <div>
                        <h3>미충족 수요란?</h3>
                        <div class="panel-box" style="background: linear-gradient(135deg, #fef5e7 0%, #fdebd0 100%);">
                            <h4>정의</h4>
                            <p style="font-size: 18px;">
                                임신을 원하지 않거나 연기하고 싶지만 피임법을 사용하지 않는 가임기 여성
                            </p>
                        </div>
                        <div class="panel-box">
                            <h4>지역별 미충족 수요율</h4>
                            <ul style="font-size: 17px; padding-left: 20px; list-style: none;">
                                <li style="margin: 5px 0;">• <strong style="color: #8b0000;">사하라이남:</strong> 24%</li>
                                <li style="margin: 5px 0;">• <strong style="color: #cc4125;">서아시아/북아프리카:</strong> 17%</li>
                                <li style="margin: 5px 0;">• <strong style="color: #e06666;">남아시아:</strong> 13%</li>
                                <li style="margin: 5px 0;">• <strong style="color: #f4cccc;">라틴아메리카:</strong> 10%</li>
                                <li style="margin: 5px 0;">• <strong style="color: #d9ead3;">동아시아:</strong> 6%</li>
                            </ul>
                        </div>
                        <!-- Added qualitative insights per main.pdf text analysis -->
                        <div class="panel-box" style="background: linear-gradient(135deg, #e8f4fd 0%, #d1e7f5 100%);">
                            <h4>주요 인사이트</h4>
                            <ul style="font-size: 17px; padding-left: 20px; list-style: none;">
                                <li style="margin: 5px 0;">• <strong>사하라 이남:</strong> 출산 간격 조정 수요 > 가족 수 제한 수요</li>
                                <li style="margin: 5px 0;">• <strong>아시아/라틴:</strong> 최빈곤층 미충족 수요가 최부유층보다 2배 높음</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);">
                            <h4>해결의 중요성</h4>
                            <p style="font-size: 17px;">
                                <span style="margin-left: 20px;">• 모성 사망 예방</span><br>
                                <span style="margin-left: 20px;">• 안전하지 않은 낙태 감소</span><br>
                                <span style="margin-left: 20px;">• 여성 자기결정권 보장</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 10: Service Delivery, Finance and Strategies -->
            <div class="slide">
                <h1>서비스 전달, 재원 조달 및 실행 전략</h1>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; padding: 20px;">
                    <!-- Service Delivery Column -->
                    <div>
                        <h3 style="color: #000; font-size: 22px; margin-bottom: 15px;">효과적인 서비스 전달</h3>
                        <div class="panel-box" style="background: #F5F0E8; border: 2px solid #B8D4CE; padding: 15px; margin-bottom: 15px;">
                            <h4 style="color: #000; font-size: 18px; margin-bottom: 10px;">지역사회 기반</h4>
                            <ul style="font-size: 16px; color: #000; padding-left: 20px;">
                                <li>Community Health Workers</li>
                                <li>Mobile clinics</li>
                                <li>Outreach programs</li>
                                <li>Traditional birth attendants training</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: #F5F0E8; border: 2px solid #9DC3C2; padding: 15px; margin-bottom: 15px;">
                            <h4 style="color: #000; font-size: 18px; margin-bottom: 10px;">시설 기반</h4>
                            <ul style="font-size: 16px; color: #000; padding-left: 20px;">
                                <li>Postpartum/postabortion FP</li>
                                <li>Integration with MCH services</li>
                                <li>Youth-friendly services</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: #F5F0E8; border: 2px solid #A08C6C; padding: 15px;">
                            <h4 style="color: #000; font-size: 18px; margin-bottom: 10px;">혁신 모델</h4>
                            <ul style="font-size: 16px; color: #000; padding-left: 20px;">
                                <li>Social franchising</li>
                                <li>Voucher schemes</li>
                                <li>mHealth applications</li>
                                <li>Public-private partnerships</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Financing Column -->
                    <div>
                        <h3 style="color: #000; font-size: 22px; margin-bottom: 15px;">재원 조달 메커니즘</h3>
                        <div class="chart-container" style="height: 200px; margin-bottom: 15px;">
                            <canvas id="fundingSourcesPie"></canvas>
                        </div>
                        <div class="panel-box" style="background: #F5F0E8; border: 2px solid #8B6F47; padding: 15px; margin-bottom: 15px;">
                            <h4 style="color: #000; font-size: 18px; margin-bottom: 10px;">Current Gaps (2024)</h4>
                            <div style="font-size: 24px; font-weight: bold; color: #8B6F47; text-align: center; margin: 10px 0;">$3.9B shortfall</div>
                            <p style="font-size: 16px; color: #000; text-align: center;">Need $12B annually<br>Currently only $8.1B</p>
                        </div>
                        <div class="panel-box" style="background: #F5F0E8; border: 2px solid #6B5D54; padding: 15px;">
                            <h4 style="color: #000; font-size: 18px; margin-bottom: 10px;">Investment Returns</h4>
                            <ul style="font-size: 16px; color: #000; padding-left: 20px;">
                                <li><strong>1:4</strong> - Economic return ratio</li>
                                <li><strong>32M</strong> - Unintended pregnancies prevented</li>
                                <li><strong>120K</strong> - Maternal deaths averted</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Strategies Column -->
                    <div>
                        <h3 style="color: #000; font-size: 22px; margin-bottom: 15px;">핵심 실행 전략</h3>
                        <div class="panel-box" style="background: linear-gradient(135deg, #D4B896 0%, #A08C6C 100%); padding: 15px; margin-bottom: 15px;">
                            <h4 style="color: #FFF; font-size: 18px; margin-bottom: 10px;">Quality Improvement</h4>
                            <ul style="font-size: 16px; color: #FFF; padding-left: 20px;">
                                <li>Method mix expansion</li>
                                <li>Provider training</li>
                                <li>Supply chain strengthening</li>
                                <li>Client counseling</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: linear-gradient(135deg, #B8D4CE 0%, #9DC3C2 100%); padding: 15px; margin-bottom: 15px;">
                            <h4 style="color: #FFF; font-size: 18px; margin-bottom: 10px;">Demand Creation</h4>
                            <ul style="font-size: 16px; color: #FFF; padding-left: 20px;">
                                <li>Community mobilization</li>
                                <li>Male engagement</li>
                                <li>Mass media campaigns</li>
                                <li>Peer education</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: linear-gradient(135deg, #8B6F47 0%, #6B5D54 100%); padding: 15px;">
                            <h4 style="color: #FFF; font-size: 18px; margin-bottom: 10px;">Policy Environment</h4>
                            <ul style="font-size: 16px; color: #FFF; padding-left: 20px;">
                                <li>Remove legal barriers</li>
                                <li>Task shifting policies</li>
                                <li>Commodity security</li>
                                <li>Integration policies</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <p style="font-size: 18px; color: #000; font-style: italic;">"Effective family planning requires coordinated action across service delivery, financing, and policy" - Lancet 2006</p>
                </div>
            </div>

            <!-- Slide 11: Priority Actions and Implementation Framework -->
            <div class="slide">
                <h1>우선 과제 및 실행 프레임워크</h1>
                <div style="display: grid; grid-template-columns: 2fr 3fr; gap: 30px; padding: 20px;">
                    <!-- Priority Countries Visual -->
                    <div>
                        <h3 style="color: #000; font-size: 22px; margin-bottom: 15px;">우선순위 국가 분류</h3>
                        <div style="position: relative; height: 400px;">
                            <!-- High Priority Circle -->
                            <div style="position: absolute; top: 20px; left: 50%; transform: translateX(-50%); text-align: center;">
                                <div style="width: 140px; height: 140px; background: linear-gradient(135deg, #8B6F47 0%, #6B5D54 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 20px rgba(139, 111, 71, 0.3);">
                                    <div style="color: white; text-align: center;">
                                        <h2 style="font-size: 36px; margin: 0; color: white;">26</h2>
                                        <p style="font-size: 14px; margin: 2px 0; color: white;">High Priority</p>
                                    </div>
                                </div>
                                <div style="background: #F5F0E8; border: 2px solid #8B6F47; padding: 10px; border-radius: 8px; margin-top: 10px; width: 200px; transform: translateX(-30px);">
                                    <p style="font-size: 14px; color: #000; margin: 2px 0;">• TFR >5</p>
                                    <p style="font-size: 14px; color: #000; margin: 2px 0;">• CPR <20%</p>
                                    <p style="font-size: 14px; color: #000; margin: 2px 0;">• Unmet need >20%</p>
                                </div>
                            </div>
                            <!-- Medium Priority Circle -->
                            <div style="position: absolute; top: 200px; left: 20%; text-align: center;">
                                <div style="width: 120px; height: 120px; background: linear-gradient(135deg, #D4B896 0%, #A08C6C 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 6px 15px rgba(212, 184, 150, 0.3);">
                                    <div style="color: white; text-align: center;">
                                        <h2 style="font-size: 30px; margin: 0; color: white;">31</h2>
                                        <p style="font-size: 12px; margin: 2px 0; color: white;">Medium</p>
                                    </div>
                                </div>
                            </div>
                            <!-- Low Priority Circle -->
                            <div style="position: absolute; top: 200px; right: 20%; text-align: center;">
                                <div style="width: 100px; height: 100px; background: linear-gradient(135deg, #B8D4CE 0%, #9DC3C2 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(184, 212, 206, 0.3);">
                                    <div style="color: white; text-align: center;">
                                        <h2 style="font-size: 26px; margin: 0; color: white;">18</h2>
                                        <p style="font-size: 11px; margin: 2px 0; color: white;">Low</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-box" style="background: #F5F0E8; border: 2px solid #8B6F47; padding: 15px; margin-top: 20px;">
                            <h4 style="color: #000; font-size: 18px;">Geographic Focus</h4>
                            <p style="font-size: 16px; color: #000;"><strong>85%</strong> of high-priority countries are in Sub-Saharan Africa</p>
                            <p style="font-size: 14px; color: #666; margin-top: 5px;">Based on 75 low- and lower-middle income countries</p>
                        </div>
                    </div>

                    <!-- Action Framework -->
                    <div>
                        <h3 style="color: #000; font-size: 22px; margin-bottom: 15px;">실행을 위한 핵심 행동</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <!-- Political Commitment -->
                            <div class="panel-box" style="background: linear-gradient(135deg, #8B6F47 0%, #6B5D54 100%); padding: 15px;">
                                <h4 style="color: #FFF; font-size: 18px; margin-bottom: 10px;">정치적 약속</h4>
                                <ul style="font-size: 15px; color: #FFF; padding-left: 20px;">
                                    <li>National FP strategies</li>
                                    <li>Budget allocation</li>
                                    <li>Legal framework reform</li>
                                    <li>Multi-sectoral coordination</li>
                                </ul>
                            </div>

                            <!-- Health System -->
                            <div class="panel-box" style="background: linear-gradient(135deg, #D4B896 0%, #A08C6C 100%); padding: 15px;">
                                <h4 style="color: #FFF; font-size: 18px; margin-bottom: 10px;">보건 시스템 강화</h4>
                                <ul style="font-size: 15px; color: #FFF; padding-left: 20px;">
                                    <li>Infrastructure development</li>
                                    <li>Human resource capacity</li>
                                    <li>Supply chain management</li>
                                    <li>Information systems</li>
                                </ul>
                            </div>

                            <!-- Community Engagement -->
                            <div class="panel-box" style="background: linear-gradient(135deg, #B8D4CE 0%, #9DC3C2 100%); padding: 15px;">
                                <h4 style="color: #FFF; font-size: 18px; margin-bottom: 10px;">지역사회 참여</h4>
                                <ul style="font-size: 15px; color: #FFF; padding-left: 20px;">
                                    <li>Religious leader engagement</li>
                                    <li>Male involvement</li>
                                    <li>Youth participation</li>
                                    <li>Women empowerment</li>
                                </ul>
                            </div>

                            <!-- Innovation -->
                            <div class="panel-box" style="background: linear-gradient(135deg, #9DC3C2 0%, #7DB8B5 100%); padding: 15px;">
                                <h4 style="color: #FFF; font-size: 18px; margin-bottom: 10px;">혁신과 기술</h4>
                                <ul style="font-size: 15px; color: #FFF; padding-left: 20px;">
                                    <li>Digital health solutions</li>
                                    <li>New contraceptive methods</li>
                                    <li>Self-care approaches</li>
                                    <li>Data-driven decisions</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Key Messages -->
                        <div class="panel-box" style="background: #F5F0E8; border: 3px solid #8B6F47; padding: 20px; margin-top: 20px;">
                            <h4 style="color: #000; font-size: 20px; margin-bottom: 15px; text-align: center;">핵심 메시지</h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; text-align: center;">
                                <div>
                                    <div style="font-size: 32px; font-weight: bold; color: #8B6F47;">201M</div>
                                    <p style="font-size: 14px; color: #000; margin-top: 5px;">Women with unmet need</p>
                                </div>
                                <div>
                                    <div style="font-size: 32px; font-weight: bold; color: #D4B896;">$1→$4</div>
                                    <p style="font-size: 14px; color: #000; margin-top: 5px;">Return on investment</p>
                                </div>
                                <div>
                                    <div style="font-size: 32px; font-weight: bold; color: #9DC3C2;">2030</div>
                                    <p style="font-size: 14px; color: #000; margin-top: 5px;">Universal access goal</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>



            <!-- Slide 20: 참고문헌 (APA 7th Edition) -->
            <div class="slide">
                <h1>참고문헌 (References)</h1>
                <div style="overflow-y: auto; height: calc(100% - 100px); padding-right: 20px;">
                    <div class="panel-box" style="background: #f9fafb; padding: 15px;">
                        <p style="font-size: 14px; line-height: 1.5; text-align: left; color: #2d3a3a;">

                            Bloom, D. E., Canning, D., & Sevilla, J. (2003). <em>The demographic dividend: A new perspective on the economic consequences of population change</em>. RAND Corporation.<br>

                            Bongaarts, J., & Bruce, J. (1995). The causes of unmet need for contraception and the social content of services. <em>Studies in Family Planning, 26</em>(2), 57-75.<br>

                            Cleland, J., Bernstein, S., Ezeh, A., Faundes, A., Glasier, A., & Innis, J. (2006). Family planning: The unfinished agenda. <em>The Lancet, 368</em>(9549), 1810-1827. https://doi.org/10.1016/S0140-6736(06)69480-4<br>

                            Korean Statistical Information Service (KOSIS). (2024). <em>Total fertility rate statistics</em>. https://kosis.kr<br>

                            Population Connection Action. (2024). <em>FY2025 funding request for family planning</em>. https://www.populationconnectionaction.org<br>

                            Family Planning 2030. (2023). <em>FP2030 progress report 2023: The arc of progress</em>. https://fp2030.org<br>

                            Guttmacher Institute. (2023). <em>Adding it up: Investing in sexual and reproductive health</em>. https://www.guttmacher.org<br>

                            Population Council. (2023). <em>Evidence for action: Research to improve family planning programs</em>. https://www.popcouncil.org<br>

                            Seltzer, J. R. (2002). <em>The origins and evolution of family planning programs in developing countries</em>. RAND Corporation.<br>

                            Singh, S., Darroch, J. E., & Ashford, L. S. (2014). <em>Adding it up: The costs and benefits of investing in sexual and reproductive health</em>. Guttmacher Institute & UNFPA.<br>

                            Track20. (2023). <em>Family planning estimation tool</em>. http://www.track20.org<br>

                            United Nations, Department of Economic and Social Affairs, Population Division. (2024). <em>World population prospects 2024 revision</em>. UN DESA.<br>

                            United Nations Population Fund (UNFPA). (2024). <em>State of world population 2024</em>. UNFPA.<br>

                            United Nations Population Fund (UNFPA). (2024). <em>West and Central Africa regional report: Unmet need for family planning</em>. UNFPA WCARO.<br>

                            World Bank. (2023). <em>World development indicators: Fertility rate, total (births per woman)</em>. https://data.worldbank.org<br>

                            World Health Organization. (2023). <em>Family planning/contraception methods: Fact sheet</em>. WHO.<br>

                            World Health Organization. (2022). <em>Medical eligibility criteria for contraceptive use</em> (5th ed.). WHO Press.<br>

                            World Health Organization. (2018). <em>Family planning: A global handbook for providers</em> (3rd ed.). WHO Press & Johns Hopkins Bloomberg School of Public Health.

                        </p>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <p style="font-size: 20px; color: #718096;">
                        <strong>Note:</strong> 본 프레젠테이션의 주요 데이터는 Cleland et al. (2006)의 연구를 기반으로 하며, 최신 통계는 위 기관들의 2022-2023년 자료를 참조하였습니다.
                    </p>
                </div>
            </div>

        </div>
    </div>

    <script>
        // 슬라이드 네비게이션
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;

        // 페이지 카운터 생성
        function createPageCounter() {
            const counter = document.createElement('div');
            counter.className = 'page-counter';
            counter.id = 'pageCounter';
            document.body.appendChild(counter);
            updatePageCounter();
        }

        // 페이지 카운터 업데이트
        function updatePageCounter() {
            const counter = document.getElementById('pageCounter');
            if (counter) {
                counter.textContent = `${currentSlide + 1} | ${totalSlides}`;
            }
        }

        // 툴팁 위치 계산 함수
        function calculateTooltipPosition(tooltip, container) {
            const tooltipRect = tooltip.getBoundingClientRect();
            const containerRect = container.getBoundingClientRect();

            let x = tooltip.style.left;
            let y = tooltip.style.top;

            // 오른쪽 경계 체크
            if (tooltipRect.right > containerRect.right) {
                x = containerRect.right - tooltipRect.width - 10 + 'px';
            }

            // 왼쪽 경계 체크
            if (tooltipRect.left < containerRect.left) {
                x = containerRect.left + 10 + 'px';
            }

            // 아래쪽 경계 체크
            if (tooltipRect.bottom > containerRect.bottom) {
                y = containerRect.bottom - tooltipRect.height - 10 + 'px';
            }

            // 위쪽 경계 체크
            if (tooltipRect.top < containerRect.top) {
                y = containerRect.top + 10 + 'px';
            }

            tooltip.style.left = x;
            tooltip.style.top = y;
        }

        // 인용 형식화 함수들
        function formatFullCitation() {
            return "Cleland, J., Bernstein, S., Ezeh, A., Faundes, A., Glasier, A., & Innis, J. (2006). Family planning: the unfinished agenda. The Lancet, 368(9549), 1810-1827.";
        }

        function formatInTextCitation() {
            return "(Cleland et al., 2006)";
        }

        function showSlide(index) {
            if (index < 0) index = totalSlides - 1;
            if (index >= totalSlides) index = 0;

            slides.forEach(slide => slide.classList.remove('active'));
            slides[index].classList.add('active');
            currentSlide = index;

            // 페이지 카운터 업데이트
            updatePageCounter();

            // 슬라이드별 차트 및 지도 초기화
            initSlideContent(index);
        }

        // 키보드 네비게이션
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') {
                showSlide(currentSlide + 1);
            } else if (e.key === 'ArrowLeft') {
                showSlide(currentSlide - 1);
            } else if (e.key === 'Home') {
                showSlide(0);
            } else if (e.key === 'End') {
                showSlide(totalSlides - 1);
            }
        });

        // 국가 데이터
        const countryData = {
            niger: {
                name: '니제르',
                coords: [13.5, 2.1],
                tfr: 7.1, /* Corrected TFR per Table 2 */
                contraceptive: 4.6, /* Corrected from 5% to 4.6% per Table 2 */
                unmetNeed: 19,
                maternalMortality: 553,
                trend: '위기 - 급속한 인구 증가',
                color: '#c97064'
            },
            kenya: {
                name: '케냐',
                coords: [-1.3, 36.8],
                tfr: 4.8,
                contraceptive: 41,
                unmetNeed: 18,
                maternalMortality: 342,
                trend: '정체 - 추가 노력 필요',
                color: '#c4a977'
            },
            brazil: {
                name: '브라질',
                coords: [-14.2, -51.9],
                tfr: 2.5, /* Corrected from 2.3 to 2.5 per Panel 6 */
                contraceptive: 77,
                unmetNeed: 6,
                maternalMortality: 60,
                trend: '성공 - 자연적 감소',
                color: '#69b7a4'
            },
            bangladesh: {
                name: '방글라데시',
                coords: [23.7, 90.4],
                tfr: 3.0,
                contraceptive: 58,
                unmetNeed: 12,
                maternalMortality: 173,
                trend: '빠른 진전',
                color: '#7db8b5'
            },
            pakistan: {
                name: '파키스탄',
                coords: [30.4, 69.3],
                tfr: 4.3,
                contraceptive: 30,
                unmetNeed: 20,
                maternalMortality: 140,
                trend: '느린 진전',
                color: '#c4a977'
            },
            iran: {
                name: '이란',
                coords: [32.4, 53.7],
                tfr: 2.0,
                contraceptive: 73,
                unmetNeed: 8,
                maternalMortality: 16,
                trend: '성공 사례',
                color: '#69b7a4'
            },
            thailand: {
                name: '태국',
                coords: [15.9, 100.9],
                tfr: 1.8,
                contraceptive: 72,
                unmetNeed: 7,
                maternalMortality: 37,
                trend: '성공 사례',
                color: '#69b7a4'
            },
            rwanda: {
                name: '르완다',
                coords: [-1.9, 29.9],
                tfr: 4.0,
                contraceptive: 53,
                unmetNeed: 14,
                maternalMortality: 248,
                trend: '빠른 개선',
                color: '#7db8b5'
            },
            mexico: {
                name: '멕시코',
                coords: [23.6, -102.5],
                tfr: 2.2,
                contraceptive: 67,
                unmetNeed: 10,
                maternalMortality: 33,
                trend: '지속적 개선',
                color: '#69b7a4'
            },
            indonesia: {
                name: '인도네시아',
                coords: [-0.8, 113.9],
                tfr: 2.4,
                contraceptive: 61,
                unmetNeed: 11,
                maternalMortality: 177,
                trend: '꾸준한 진전',
                color: '#7db8b5'
            },
            vietnam: {
                name: '베트남',
                coords: [14.1, 108.3],
                tfr: 1.9,
                contraceptive: 68,
                unmetNeed: 9,
                maternalMortality: 43,
                trend: '성공 사례',
                color: '#69b7a4'
            }
        };

        // 지도 인스턴스 저장
        let maps = {};

        // 지도 생성 함수
        function createMap(elementId, center = [0, 0], zoom = 2) {
            if (maps[elementId]) {
                maps[elementId].remove();
            }

            const mapElement = document.getElementById(elementId);
            if (!mapElement) return null;

            const map = L.map(elementId).setView(center, zoom);

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);

            maps[elementId] = map;
            return map;
        }

        // 국가 마커 추가 함수
        function addCountryMarker(map, country) {
            const data = countryData[country];
            if (!data || !map) return;

            const marker = L.circleMarker(data.coords, {
                radius: 8,
                fillColor: data.color,
                color: '#fff',
                weight: 2,
                opacity: 1,
                fillOpacity: 0.8
            }).addTo(map);

            // 커스텀 툴팁 HTML
            const tooltipContent = `
                <div class="map-tooltip">
                    <h4>${data.name}</h4>
                    <div class="tooltip-stat">
                        <span class="tooltip-label">합계출산율:</span>
                        <span class="tooltip-value">${data.tfr}명</span>
                    </div>
                    <div class="tooltip-stat">
                        <span class="tooltip-label">피임 사용률:</span>
                        <span class="tooltip-value">${data.contraceptive}%</span>
                    </div>
                    <div class="tooltip-stat">
                        <span class="tooltip-label">미충족 수요:</span>
                        <span class="tooltip-value">${data.unmetNeed}%</span>
                    </div>
                    <div class="tooltip-stat">
                        <span class="tooltip-label">모성사망률:</span>
                        <span class="tooltip-value">${data.maternalMortality}/10만</span>
                    </div>
                    <div class="tooltip-trend ${data.color === '#10b981' ? 'trend-positive' : data.color === '#dc2626' ? 'trend-negative' : 'trend-neutral'}">
                        ${data.trend}
                    </div>
                </div>
            `;

            marker.bindTooltip(tooltipContent, {
                permanent: false,
                direction: 'top',
                className: 'custom-tooltip',
                offset: [0, -10]
            });

            marker.on('mouseover', function() {
                this.openTooltip();
            });

            marker.on('mouseout', function() {
                this.closeTooltip();
            });

            return marker;
        }

        // 차트 생성 함수
        function createChart(canvasId, config) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;

            const ctx = canvas.getContext('2d');

            // 기존 차트 제거
            if (canvas.chart) {
                canvas.chart.destroy();
            }

            canvas.chart = new Chart(ctx, config);
        }

        // 한국 인구 피라미드 데이터 및 함수
        const koreaPyramidData = {
            '1960': {
                labels: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                males: [-2800, -2400, -2000, -1800, -1600, -1400, -1200, -1000, -900, -800, -700, -600, -500, -400, -300, -200],
                females: [2600, 2200, 1900, 1700, 1500, 1300, 1100, 950, 850, 750, 650, 550, 450, 350, 250, 180],
                description: '전형적인 피라미드형 - 높은 출생률 (TFR 6.1), 15세 미만 41.2%',
                stats: { young: 41.2, working: 55.1, elderly: 3.7, tfr: 6.1 }
            },
            '1970': {
                labels: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                males: [-2600, -2500, -2300, -2000, -1700, -1500, -1300, -1100, -950, -850, -750, -650, -550, -450, -350, -250],
                females: [2400, 2300, 2100, 1850, 1600, 1400, 1200, 1050, 900, 800, 700, 600, 500, 400, 300, 230],
                description: '피라미드형 유지 - 가족계획 시작, TFR 4.2로 감소, 15세 미만 42.1%',
                stats: { young: 42.1, working: 54.6, elderly: 3.3, tfr: 4.2 }
            },
            '1980': {
                labels: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                males: [-2000, -2300, -2500, -2400, -2200, -1800, -1500, -1300, -1100, -950, -850, -750, -650, -500, -400, -300],
                females: [1850, 2100, 2300, 2200, 2000, 1700, 1400, 1200, 1050, 900, 800, 700, 600, 450, 350, 280],
                description: '변화 시작 - TFR 2.8, 15세 미만 34.2%, 생산가능인구 증가',
                stats: { young: 34.2, working: 62.0, elderly: 3.8, tfr: 2.8 }
            },
            '1990': {
                labels: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                males: [-1600, -1800, -2100, -2300, -2400, -2200, -1900, -1600, -1300, -1100, -950, -850, -750, -600, -450, -350],
                females: [1500, 1700, 1950, 2150, 2250, 2050, 1800, 1500, 1250, 1050, 900, 800, 700, 550, 400, 350],
                description: '종형 구조 - TFR 1.6 달성, 15세 미만 25.6%, 인구배당 효과',
                stats: { young: 25.6, working: 69.4, elderly: 5.0, tfr: 1.6 }
            },
            '2000': {
                labels: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                males: [-1400, -1600, -1800, -2000, -2100, -2000, -2100, -2200, -1900, -1600, -1300, -1000, -800, -600, -400, -300],
                females: [1300, 1500, 1700, 1900, 2000, 1900, 2000, 2100, 1800, 1500, 1200, 950, 750, 600, 450, 400],
                description: '항아리형 - 초저출산 시작 (TFR 1.5), 15세 미만 21%, 고령화 진입',
                stats: { young: 21.0, working: 71.7, elderly: 7.3, tfr: 1.5 }
            },
            '2010': {
                labels: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                males: [-1200, -1300, -1500, -1700, -1900, -2000, -1900, -2000, -2100, -2000, -1800, -1500, -1200, -900, -600, -450],
                females: [1100, 1200, 1400, 1600, 1800, 1900, 1800, 1900, 2000, 1900, 1700, 1400, 1100, 850, 600, 500],
                description: '다이아몬드형 - TFR 1.2, 15세 미만 16.2%, 고령사회 진입 (11.3%)',
                stats: { young: 16.2, working: 72.5, elderly: 11.3, tfr: 1.2 }
            },
            '2020': {
                labels: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                males: [-900, -1100, -1200, -1400, -1600, -1800, -1900, -1800, -1900, -2000, -2100, -1900, -1700, -1400, -1000, -700],
                females: [850, 1000, 1100, 1300, 1500, 1700, 1800, 1700, 1800, 1900, 2000, 1800, 1600, 1350, 1000, 850],
                description: '역피라미드 진입 - TFR 0.84 (세계 최저), 15세 미만 12.2%, 초고령사회 임박',
                stats: { young: 12.2, working: 71.7, elderly: 16.1, tfr: 0.84 }
            }
        };

        let currentPyramidChart = null;

        function updatePyramidBySlider(year) {
            document.getElementById('yearDisplay').textContent = year;
            showPyramid(year);
        }

        function showPyramid(year) {
            // 설명 업데이트
            const descDiv = document.getElementById('pyramidDescription');
            const data = koreaPyramidData[year];
            if (descDiv && data) {
                descDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>${year}년:</strong> ${data.description}
                        </div>
                        <div style="display: flex; gap: 15px; font-size: 13px;">
                            <span>👶 ${data.stats.young}%</span>
                            <span>💼 ${data.stats.working}%</span>
                            <span>👴 ${data.stats.elderly}%</span>
                        </div>
                    </div>
                `;
            }

            // 차트 업데이트
            const canvas = document.getElementById('koreaPyramidChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            const data = koreaPyramidData[year];

            if (currentPyramidChart) {
                currentPyramidChart.destroy();
            }

            currentPyramidChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: '남성',
                            data: data.males,
                            backgroundColor: 'rgba(54, 162, 235, 0.7)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        },
                        {
                            label: '여성',
                            data: data.females,
                            backgroundColor: 'rgba(255, 99, 132, 0.7)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: {
                        title: {
                            display: true,
                            text: `한국 인구구조 ${year}`,
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = Math.abs(context.parsed.x);
                                    return context.dataset.label + ': ' + value.toLocaleString() + '천명';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            stacked: false,
                            ticks: {
                                callback: function(value) {
                                    return Math.abs(value).toLocaleString();
                                }
                            },
                            title: {
                                display: true,
                                text: '인구 (천명)'
                            },
                            grid: {
                                display: true
                            }
                        },
                        y: {
                            stacked: false,
                            position: 'center',
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // 슬라이드별 콘텐츠 초기화
        function initSlideContent(slideIndex) {
            switch(slideIndex) {
                case 1: // 역사적 맥락
                    createChart('historicalTrend', {
                        type: 'line',
                        data: {
                            labels: ['1960', '1970', '1980', '1990', '1994', '2000', '2010', '2020'],
                            datasets: [{
                                label: '세계 평균 TFR',
                                data: [5.0, 4.5, 3.6, 3.0, 2.75, 2.5, 2.4, 2.3],
                                borderColor: '#69b7a4',
                                backgroundColor: 'rgba(105, 183, 164, 0.1)',
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false },
                                title: {
                                    display: true,
                                    text: '세계 평균 합계출산율 변화',
                                    font: { family: 'SeoulHangang', weight: 700 }
                                },
                                annotation: {
                                    annotations: {
                                        line1: {
                                            type: 'line',
                                            xMin: '1960',
                                            xMax: '1960',
                                            borderColor: 'rgb(255, 99, 132)',
                                            borderWidth: 2,
                                            label: {
                                                display: true,
                                                content: '1960년대: 인구폭발 우려',
                                                position: 'start'
                                            }
                                        },
                                        line2: {
                                            type: 'line',
                                            xMin: '1994',
                                            xMax: '1994',
                                            borderColor: 'rgb(54, 162, 235)',
                                            borderWidth: 2,
                                            label: {
                                                display: true,
                                                content: '1994 카이로 회의',
                                                position: 'center'
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    });
                    break;

                case 2: // 글로벌 인구 현황
                    setTimeout(() => {
                        const map = createMap('worldMap');
                        if (map) {
                            // 모든 국가 마커 추가
                            Object.keys(countryData).forEach(country => {
                                addCountryMarker(map, country);
                            });
                        }
                    }, 100);
                    break;

                case 3: // 니제르 사례
                    setTimeout(() => {
                        const map = createMap('nigerMap', [17, 8], 6);
                        if (map) {
                            addCountryMarker(map, 'niger');

                            // 주변 국가도 표시
                            addCountryMarker(map, 'kenya');
                        }
                    }, 100);
                    break;

                case 4: // 통합된 성공/실패 사례 (슬라이드 5-6 병합)
                    // 남아시아 비교 차트 생성
                    createChart('southAsiaComparison', {
                        type: 'line',
                        data: {
                            labels: ['1975', '1985', '1995', '2005', '2015'],
                            datasets: [
                                {
                                    label: '방글라데시',
                                    data: [6.3, 5.1, 3.4, 2.9, 2.3],
                                    borderColor: '#69b7a4',
                                    backgroundColor: 'rgba(105, 183, 164, 0.1)',
                                    borderWidth: 3,
                                    tension: 0.3
                                },
                                {
                                    label: '파키스탄',
                                    data: [6.3, 6.0, 5.4, 4.3, 3.7],
                                    borderColor: '#c4a977',
                                    backgroundColor: 'rgba(196, 169, 119, 0.1)',
                                    borderWidth: 3,
                                    borderDash: [5, 5],
                                    tension: 0.3
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'TFR 변화 비교: 성공 vs 정체',
                                    font: {
                                        family: 'SeoulHangang',
                                        size: 16,
                                        weight: 700
                                    }
                                },
                                legend: {
                                    display: true,
                                    position: 'top',
                                    labels: {
                                        font: { family: 'SeoulNamsan', size: 13 },
                                        usePointStyle: true
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: false,
                                    min: 2,
                                    max: 7,
                                    title: {
                                        display: true,
                                        text: '합계출산율(TFR)',
                                        font: { family: 'SeoulNamsan' }
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: '연도',
                                        font: { family: 'SeoulNamsan' }
                                    }
                                }
                            }
                        }
                    });
                    break;

                case 5: // 위기의 가족계획
                    // Funding Decline Chart
                    createChart('fundingDeclineChart', {
                        type: 'line',
                        data: {
                            labels: ['1995', '1997', '1999', '2001', '2003'],
                            datasets: [{
                                label: '국제 원조 (백만 달러)',
                                data: [560, 520, 480, 470, 460],
                                borderColor: '#ef4444',
                                backgroundColor: 'rgba(239, 68, 68, 0.1)',
                                borderWidth: 3,
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false },
                                title: {
                                    display: true,
                                    text: '가족계획 원조 감소 ($560M → $460M)',
                                    font: { size: 14, weight: '600' },
                                    color: '#e5e7eb'
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                    ticks: { color: '#e5e7eb' }
                                },
                                x: {
                                    grid: { display: false },
                                    ticks: { color: '#e5e7eb' }
                                }
                            }
                        }
                    });

                    // Africa Crisis Map
                    setTimeout(() => {
                        const mapDiv = document.getElementById('africaCrisisMap');
                        if (mapDiv && !mapDiv._leaflet_id) {
                            const map = L.map('africaCrisisMap', {
                                center: [0, 20],
                                zoom: 3,
                                zoomControl: false,
                                attributionControl: false,
                                scrollWheelZoom: false,
                                doubleClickZoom: false,
                                dragging: false
                            });

                            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
                                maxZoom: 19
                            }).addTo(map);

                            // Crisis countries with unmet need data
                            const crisisCountries = [
                                { name: 'Niger', coords: [17, 8], unmetNeed: 16 },
                                { name: 'Chad', coords: [15, 19], unmetNeed: 23 },
                                { name: 'Mali', coords: [17, -4], unmetNeed: 29 },
                                { name: 'Uganda', coords: [1, 32], unmetNeed: 35 },
                                { name: 'Kenya', coords: [-1, 37], unmetNeed: 25 },
                                { name: 'Ethiopia', coords: [8, 38], unmetNeed: 34 },
                                { name: 'Nigeria', coords: [9, 8], unmetNeed: 17 },
                                { name: 'DRC', coords: [-3, 23], unmetNeed: 27 },
                                { name: 'Tanzania', coords: [-6, 35], unmetNeed: 22 }
                            ];

                            crisisCountries.forEach(country => {
                                const radius = 10 + (country.unmetNeed * 0.5);
                                L.circleMarker(country.coords, {
                                    radius: radius,
                                    fillColor: '#8B6F47',
                                    color: '#2D5F5D',
                                    weight: 3,
                                    opacity: 0.9,
                                    fillOpacity: 0.7
                                }).addTo(map)
                                .bindTooltip(`${country.name}: ${country.unmetNeed}% 미충족`, {
                                    permanent: false,
                                    direction: 'top',
                                    className: 'crisis-tooltip'
                                });
                            });
                        }
                    }, 100);

                    // Resource Gap Chart
                    createChart('resourceGapChart', {
                        type: 'bar',
                        data: {
                            labels: ['아프리카 필요(2006)', '공여국 지원', '국내 자원'],
                            datasets: [{
                                data: [270, 113, 87],
                                backgroundColor: ['#f59e0b', '#dc2626', '#dc2626'],
                                borderColor: ['#fbbf24', '#ef4444', '#ef4444'],
                                borderWidth: 2
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false },
                                title: {
                                    display: true,
                                    text: '아프리카 가족계획 자금 감소 (백만 달러)',
                                    font: { size: 14, weight: '600' },
                                    color: '#e5e7eb'
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 300,
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                    ticks: { color: '#e5e7eb' }
                                },
                                x: {
                                    grid: { display: false },
                                    ticks: { color: '#e5e7eb' }
                                }
                            }
                        }
                    });
                    break;

                case 6: // 건강 영향 (원래 case 5, 이전 case 7)
                    createChart('healthImpactChart', {
                        type: 'bar',
                        data: {
                            labels: ['모성 사망', '영아 사망'],
                            datasets: [{
                                label: '예방 가능 비율 (%)',
                                data: [32, 10],
                                backgroundColor: ['#c97064', '#69b7a4']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false },
                                title: {
                                    display: true,
                                    text: '가족계획으로 예방 가능한 사망',
                                    font: { family: 'SeoulHangang' }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 40
                                }
                            }
                        }
                    });
                    break;

                case 7: // 경제적 영향과 남한 사례 (Slide 8)
                    // 인구 피라미드 초기화 (1960년 기본 표시)
                    showPyramid('1960');

                    // 슬라이더 이벤트 리스너 추가
                    const slider = document.getElementById('yearSlider');
                    if (slider) {
                        slider.addEventListener('input', function() {
                            updatePyramidBySlider(this.value);
                        });
                    }

                    createChart('southKoreaChart', {
                        type: 'line',
                        data: {
                            labels: ['1960', '1970', '1980', '1990', '2000'],
                            datasets: [{
                                label: 'TFR',
                                data: [6.0, 4.5, 2.8, 1.6, 1.5],
                                borderColor: '#69b7a4',
                                backgroundColor: 'rgba(105, 183, 164, 0.1)',
                                yAxisID: 'y',
                                tension: 0.3
                            }, {
                                label: 'GDP 성장률 (%)',
                                data: [5, 9, 8, 9, 4],
                                borderColor: '#c4a977',
                                backgroundColor: 'rgba(196, 169, 119, 0.1)',
                                yAxisID: 'y1',
                                borderDash: [5, 5],
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                mode: 'index',
                                intersect: false
                            },
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'TFR 감소와 경제 성장의 상관관계',
                                    font: { family: 'SeoulHangang' }
                                },
                                legend: {
                                    display: true
                                }
                            },
                            scales: {
                                y: {
                                    type: 'linear',
                                    display: true,
                                    position: 'left',
                                    title: {
                                        display: true,
                                        text: 'TFR'
                                    }
                                },
                                y1: {
                                    type: 'linear',
                                    display: true,
                                    position: 'right',
                                    title: {
                                        display: true,
                                        text: 'GDP 성장률 (%)'
                                    },
                                    grid: {
                                        drawOnChartArea: false
                                    }
                                }
                            }
                        }
                    });
                    break;

                case 7: // 미충족 수요 (원래 case 10)
                    // 지역별 미충족 수요 차트
                    createChart('unmetNeedByRegion', {
                        type: 'bar',
                        data: {
                            labels: ['사하라이남', '서아시아/북아프리카', '남아시아', '라틴아메리카', '동아시아'],
                            datasets: [{
                                label: '미충족 수요율 (%)',
                                data: [24, 17, 13, 10, 6],
                                backgroundColor: ['#8b0000', '#cc4125', '#e06666', '#f4cccc', '#d9ead3']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 30
                                }
                            }
                        }
                    });

                    // 원인별 분포 차트
                    createChart('unmetNeedReasons', {
                        type: 'pie',
                        data: {
                            labels: ['부작용 우려', '접근성 부족', '문화적 반대', '정보 부족', '기타'],
                            datasets: [{
                                data: [35, 25, 20, 15, 5],
                                backgroundColor: ['#dc2626', '#f59e0b', '#fbbf24', '#fde68a', '#fef3c7']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'right',
                                    labels: {
                                        font: {
                                            size: 11
                                        }
                                    }
                                }
                            }
                        }
                    });

                    // 경제수준별 차이 차트
                    createChart('unmetNeedByWealth', {
                        type: 'line',
                        data: {
                            labels: ['최빈곤층', '빈곤층', '중산층', '부유층', '최부유층'],
                            datasets: [{
                                label: '미충족 수요 (%)',
                                data: [28, 22, 16, 12, 8],
                                borderColor: '#dc2626',
                                backgroundColor: 'rgba(220, 38, 38, 0.1)',
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 30
                                }
                            }
                        }
                    });
                    break;

                case 8: // 서비스 전달 (원래 case 11)
                    createChart('accessBarriers', {
                        type: 'doughnut',
                        data: {
                            labels: ['접근성', '부작용 우려', '문화적 반대', '비용'],
                            datasets: [{
                                data: [45, 26, 23, 6],
                                backgroundColor: ['#69b7a4', '#8fa68e', '#a8957e', '#c4a977']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });

                    // 서비스 품질 지표 차트
                    createChart('serviceQuality', {
                        type: 'radar',
                        data: {
                            labels: ['접근성', '친절도', '상담 품질', '사생활 보호', '대기 시간'],
                            datasets: [{
                                label: '현재 수준',
                                data: [65, 70, 75, 80, 60],
                                borderColor: '#69b7a4',
                                backgroundColor: 'rgba(105, 183, 164, 0.2)'
                            }, {
                                label: '목표 수준',
                                data: [90, 90, 90, 95, 85],
                                borderColor: '#c4a977',
                                backgroundColor: 'rgba(196, 169, 119, 0.1)',
                                borderDash: [5, 5]
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                r: {
                                    beginAtZero: true,
                                    max: 100
                                }
                            }
                        }
                    });
                    break;

                case 9: // 새로운 Slide 10: Service Delivery, Finance and Strategies
                    // Funding Sources Pie Chart
                    createChart('fundingSourcesPie', {
                        type: 'pie',
                        data: {
                            labels: ['Bilateral donors', 'Multilateral', 'Domestic resources', 'Private sector', 'Foundations'],
                            datasets: [{
                                data: [38, 27, 22, 8, 5],
                                backgroundColor: ['#8B6F47', '#D4B896', '#B8D4CE', '#9DC3C2', '#A08C6C']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        font: { size: 14 },
                                        color: '#000'
                                    }
                                }
                            }
                        }
                    });
                    break;

                case 10: // 남성 참여 (원래 case 13)
                    createChart('maleInvolvement', {
                        type: 'bar',
                        data: {
                            labels: ['참여 전', '참여 후'],
                            datasets: [{
                                label: '피임 사용률 (%)',
                                data: [35, 62],
                                backgroundColor: ['#c4a977', '#69b7a4']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });
                    break;

                case 14: // 자금 조달 슬라이드 (Slide 15)
                    createChart('fundingTrendsMain', {
                        type: 'line',
                        data: {
                            labels: ['2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023'],
                            datasets: [
                                {
                                    label: '필요 자금',
                                    data: [9.5, 9.8, 10.2, 10.6, 11.1, 11.5, 11.9, 12.1, 12.0],
                                    borderColor: '#dc2626',
                                    backgroundColor: 'rgba(220, 38, 38, 0.1)',
                                    borderWidth: 3,
                                    borderDash: [5, 5],
                                    tension: 0.4,
                                    fill: true
                                },
                                {
                                    label: '실제 자금',
                                    data: [7.2, 7.3, 7.5, 7.4, 7.8, 7.6, 7.9, 8.1, 8.0],
                                    borderColor: '#10b981',
                                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                    borderWidth: 3,
                                    tension: 0.4,
                                    fill: true
                                },
                                {
                                    label: '자금 격차',
                                    data: [2.3, 2.5, 2.7, 3.2, 3.3, 3.9, 4.0, 4.0, 4.0],
                                    borderColor: '#f59e0b',
                                    backgroundColor: 'rgba(245, 158, 11, 0.1)',
                                    borderWidth: 2,
                                    tension: 0.4,
                                    fill: true
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: true,
                                    position: 'top',
                                    labels: {
                                        font: { size: 14 },
                                        padding: 15
                                    }
                                },
                                title: {
                                    display: true,
                                    text: '가족계획 글로벌 자금 동향 (십억 달러)',
                                    font: { size: 18 }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            return context.dataset.label + ': $' + context.parsed.y.toFixed(1) + 'B';
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: false,
                                    min: 0,
                                    max: 14,
                                    title: {
                                        display: true,
                                        text: '십억 달러 (USD)',
                                        font: { size: 14 }
                                    },
                                    grid: {
                                        color: 'rgba(200, 200, 200, 0.3)'
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: '연도',
                                        font: { size: 14 }
                                    },
                                    grid: {
                                        color: 'rgba(200, 200, 200, 0.3)'
                                    }
                                }
                            }
                        }
                    });
                    break;

                case 15: // 글로벌 우선순위 인포그래픽 (Slide 16)
                    // 인포그래픽 슬라이드는 차트가 없음 - 순수 CSS로 구현
                    break;

                case 16: // 핵심 메시지 (Slide 17)
                    // 핵심 메시지 슬라이드는 차트가 없음
                    break;
            }
        }

        // 초기 로드
        window.addEventListener('load', () => {
            createPageCounter();
            showSlide(0);
        });

        // 클릭 네비게이션 (좌우 영역)
        document.addEventListener('click', (e) => {
            const viewport = document.querySelector('.presentation-viewport');
            if (!viewport.contains(e.target)) return;

            const rect = viewport.getBoundingClientRect();
            const x = e.clientX - rect.left;

            if (x < rect.width * 0.3) {
                showSlide(currentSlide - 1);
            } else if (x > rect.width * 0.7) {
                showSlide(currentSlide + 1);
            }
        });

        // PDF 내보내기 기능
        async function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const button = document.querySelector('.pdf-export-btn');
            const progress = document.getElementById('pdfProgress');
            const progressText = document.getElementById('pdfProgressText');
            const progressFill = document.getElementById('pdfProgressFill');

            // 버튼 비활성화 및 진행 상태 표시
            button.disabled = true;
            progress.classList.add('active');

            try {
                // PDF 생성 (A4 가로 방향)
                const pdf = new jsPDF({
                    orientation: 'landscape',
                    unit: 'mm',
                    format: 'a4'
                });

                const totalSlidesToExport = totalSlides;
                const originalSlide = currentSlide;

                // 각 슬라이드를 순차적으로 캡처
                for (let i = 0; i < totalSlidesToExport; i++) {
                    // 진행 상태 업데이트
                    const progressPercent = ((i + 1) / totalSlidesToExport) * 100;
                    progressText.textContent = `슬라이드 ${i + 1} / ${totalSlidesToExport} 처리 중...`;
                    progressFill.style.width = progressPercent + '%';

                    // 슬라이드 표시
                    showSlide(i);

                    // 차트나 지도가 로드될 시간을 줌
                    await new Promise(resolve => setTimeout(resolve, 500));

                    // 현재 슬라이드 캡처
                    const slideElement = slides[i];

                    // html2canvas로 슬라이드 캡처
                    const canvas = await html2canvas(slideElement, {
                        scale: 2, // 고화질을 위해 2배 스케일
                        useCORS: true,
                        logging: false,
                        backgroundColor: '#ffffff'
                    });

                    // 캔버스를 이미지로 변환
                    const imgData = canvas.toDataURL('image/jpeg', 0.95);

                    // PDF에 이미지 추가
                    if (i > 0) {
                        pdf.addPage();
                    }

                    // A4 가로 사이즈에 맞춰 이미지 배치
                    const pdfWidth = 297; // A4 가로 너비 (mm)
                    const pdfHeight = 210; // A4 가로 높이 (mm)

                    // 이미지 비율 계산
                    const imgWidth = canvas.width;
                    const imgHeight = canvas.height;
                    const ratio = Math.min(pdfWidth / imgWidth, pdfHeight / imgHeight);

                    const finalWidth = imgWidth * ratio;
                    const finalHeight = imgHeight * ratio;

                    // 중앙 정렬
                    const x = (pdfWidth - finalWidth) / 2;
                    const y = (pdfHeight - finalHeight) / 2;

                    pdf.addImage(imgData, 'JPEG', x, y, finalWidth, finalHeight);

                    // 슬라이드 번호 추가 (우측 하단)
                    pdf.setFontSize(10);
                    pdf.setTextColor(100, 100, 100);
                    pdf.text(`${i + 1} / ${totalSlidesToExport}`, pdfWidth - 20, pdfHeight - 10);
                }

                // PDF 저장
                progressText.textContent = 'PDF 파일 생성 완료!';
                pdf.save('가족계획_미완의_과제_발표자료.pdf');

                // 원래 슬라이드로 복귀
                showSlide(originalSlide);

                // 2초 후 진행 상태 숨김
                setTimeout(() => {
                    progress.classList.remove('active');
                    button.disabled = false;
                    progressFill.style.width = '0%';
                }, 2000);

            } catch (error) {
                console.error('PDF 생성 중 오류 발생:', error);
                alert('PDF 생성 중 오류가 발생했습니다. 다시 시도해주세요.');

                // 에러 발생 시 복구
                progress.classList.remove('active');
                button.disabled = false;
                progressFill.style.width = '0%';
                showSlide(originalSlide);
            }
        }
    </script>
</body>
</html><!-- Last updated: Wed, Sep 24, 2025  1:36:07 PM -->
