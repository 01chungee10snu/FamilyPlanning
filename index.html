<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>가족계획: 미완의 과제 - 통합 발표자료</title>

    <!-- Seoul Fonts CDN -->
    <link href="https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangang.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulNamsan.css" rel="stylesheet">

    <!-- External Libraries CDN -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>

    <style>
        /* ==================== 기본 설정 ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Seoul 폰트 적용 및 Weight 정의 */
        @font-face {
            font-family: 'SeoulHangang';
            font-weight: 200;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangangL.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulHangang';
            font-weight: 300;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangangL.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulHangang';
            font-weight: 500;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangangM.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulHangang';
            font-weight: 700;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangangB.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulHangang';
            font-weight: 800;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulHangangEB.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulNamsan';
            font-weight: 300;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulNamsanL.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulNamsan';
            font-weight: 500;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulNamsanM.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulNamsan';
            font-weight: 700;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulNamsanB.woff') format('woff');
        }

        @font-face {
            font-family: 'SeoulNamsan';
            font-weight: 800;
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/SeoulNamsanEB.woff') format('woff');
        }

        body {
            font-family: 'SeoulNamsan', 'Malgun Gothic', sans-serif;
            font-weight: 300;
            background: linear-gradient(135deg, #2d3a3a 0%, #576066 100%);
            overflow: hidden;
            width: 100vw;
            height: 100vh;
        }

        /* ==================== 16:9 비율 강제 ==================== */
        .presentation-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #000;
        }

        .presentation-viewport {
            position: relative;
            width: 100%;
            height: 100%;
            max-width: calc(100vh * 16 / 9);
            max-height: calc(100vw * 9 / 16);
            background: #fff;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            overflow: hidden;
        }

        /* ==================== 슬라이드 기본 스타일 ==================== */
        .slide {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
            padding: 40px 60px;
            background: white;
            overflow: hidden;
        }

        .slide.active {
            display: flex;
            flex-direction: column;
        }

        /* ==================== Typography ==================== */
        h1 {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 800;
            font-size: 38px;
            color: #2d3a3a;
            line-height: 1.2;
            margin-bottom: 15px;
        }

        h2 {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 700;
            font-size: 28px;
            color: #576066;
            margin-bottom: 12px;
        }

        h3 {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 500;
            font-size: 20px;
            color: #3e4948;
            margin-bottom: 10px;
        }

        h4 {
            font-family: 'SeoulNamsan', sans-serif;
            font-weight: 700;
            font-size: 16px;
            color: #576066;
            margin-bottom: 8px;
        }

        p {
            font-family: 'SeoulNamsan', sans-serif;
            font-weight: 300;
            font-size: 14px;
            line-height: 1.6;
            color: #576066;
        }

        strong, b {
            font-family: 'SeoulNamsan', sans-serif;
            font-weight: 700;
        }

        /* ==================== 레이아웃 ==================== */
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            height: calc(100% - 60px);
        }

        .three-column {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            height: calc(100% - 60px);
        }

        .main-with-side {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
            height: calc(100% - 60px);
        }

        /* ==================== 컴포넌트 스타일 ==================== */
        .panel-box {
            background: linear-gradient(135deg, #e5e7e7 0%, #d1d5d5 100%);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #69b7a4;
        }

        .data-card {
            background: white;
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s;
        }

        .data-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .stat-number {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 800;
            font-size: 36px;
            color: #69b7a4;
            margin: 8px 0;
        }

        .chart-container {
            position: relative;
            height: 250px;
            width: 100%;
            margin: 10px 0;
        }

        .small-chart {
            height: 180px;
        }

        .map-container {
            position: relative;
            height: 100%;
            width: 100%;
            border-radius: 8px;
            overflow: hidden;
        }

        /* 테이블 */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            margin: 10px 0;
        }

        .data-table th {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 700;
            background: #576066;
            color: white;
            padding: 8px;
            text-align: left;
        }

        .data-table td {
            font-family: 'SeoulNamsan', sans-serif;
            font-weight: 300;
            padding: 6px 8px;
            border-bottom: 1px solid #e2e8f0;
        }

        /* 인용문 */
        .quote-box {
            position: relative;
            padding: 15px 20px;
            background: #f5f6f6;
            border-left: 3px solid #69b7a4;
            margin: 15px 0;
            font-style: italic;
        }

        /* ==================== 지도 툴팁 스타일 ==================== */
        .map-tooltip {
            font-family: 'SeoulNamsan', sans-serif;
            background: rgba(255, 255, 255, 0.98);
            border: 2px solid #69b7a4;
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            min-width: 200px;
        }

        .map-tooltip h4 {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 700;
            font-size: 16px;
            color: #2d3748;
            margin: 0 0 8px 0;
            padding-bottom: 6px;
            border-bottom: 1px solid #e2e8f0;
        }

        .tooltip-stat {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            font-size: 13px;
        }

        .tooltip-label {
            font-weight: 500;
            color: #718096;
        }

        .tooltip-value {
            font-family: 'SeoulHangang', sans-serif;
            font-weight: 700;
            color: #69b7a4;
        }

        .tooltip-trend {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #e2e8f0;
            font-size: 12px;
            font-style: italic;
        }

        .trend-positive { color: #69b7a4; }
        .trend-negative { color: #c97064; }
        .trend-neutral { color: #718096; }

        /* ==================== UI 컨트롤 숨김 ==================== */
        .nav-controls, .timer-display, .progress-bar, .slide-number {
            display: none !important;
        }

        /* ==================== 타이틀 슬라이드 ==================== */
        .title-slide {
            background: linear-gradient(135deg, #576066 0%, #3e4948 100%);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .title-slide h1 {
            font-size: 52px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .key-messages {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 30px;
            width: 80%;
        }

        .key-message {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .key-message h4 {
            color: white;
            margin-bottom: 5px;
        }

        .key-message p {
            color: rgba(255,255,255,0.9);
            font-size: 12px;
        }

        /* ==================== 반응형 조정 ==================== */
        @media (max-width: 1200px) {
            h1 { font-size: 32px; }
            h2 { font-size: 24px; }
            h3 { font-size: 18px; }
            p { font-size: 13px; }
            .slide { padding: 30px 40px; }
        }
    </style>
</head>
<body>
    <div class="presentation-container">
        <div class="presentation-viewport">

            <!-- Slide 1: 타이틀 + 핵심 메시지 -->
            <div class="slide title-slide active">
                <h1>가족계획: 미완의 과제</h1>
                <p style="font-size: 24px; margin-bottom: 30px;">
                    Family planning: The unfinished agenda
                </p>
                <div class="key-messages">
                    <div class="key-message">
                        <h4>보건 향상</h4>
                        <p>모성·영아 사망률 감소</p>
                    </div>
                    <div class="key-message">
                        <h4>경제 발전</h4>
                        <p>빈곤 감소와 성장 촉진</p>
                    </div>
                    <div class="key-message">
                        <h4>여성 권한</h4>
                        <p>교육·경제 참여 확대</p>
                    </div>
                    <div class="key-message">
                        <h4>지속가능성</h4>
                        <p>인구·환경 균형</p>
                    </div>
                </div>
                <p style="margin-top: 40px; font-size: 14px; opacity: 0.8;">
                    Lancet 2006 | Cleland J, et al.
                </p>
            </div>

            <!-- Slide 2: 역사적 맥락 -->
            <div class="slide">
                <h1>가족계획의 역사적 전환점</h1>
                <div class="two-column">
                    <div>
                        <div class="panel-box">
                            <h3>1960년대: 시작</h3>
                            <p><strong>인구 폭발 우려</strong></p>
                            <ul style="font-size: 13px; margin: 10px 0;">
                                <li>개발도상국 급속 인구 증가</li>
                                <li>경제발전 저해 우려</li>
                                <li>정부 주도 프로그램 시작</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: linear-gradient(135deg, #fef5e7 0%, #fdebd0 100%);">
                            <h3>1994년: 카이로 회의</h3>
                            <p><strong>패러다임 전환</strong></p>
                            <ul style="font-size: 13px; margin: 10px 0;">
                                <li>인구 목표 → 개인 권리</li>
                                <li>숫자 중심 → 인권 중심</li>
                                <li>여성 생식건강권 강조</li>
                            </ul>
                        </div>
                    </div>
                    <div>
                        <h3>주요 성과와 도전</h3>
                        <div class="chart-container">
                            <canvas id="historicalTrend"></canvas>
                        </div>
                        <div class="data-card" style="margin-top: 15px;">
                            <p style="font-size: 13px;">전 세계 피임 사용률</p>
                            <div class="stat-number">10% → 60%</div>
                            <p style="font-size: 12px; color: #718096;">1960 → 2005</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 3: 글로벌 인구 현황 (지도 포함) -->
            <div class="slide">
                <h1>글로벌 인구 동향과 지역별 현황</h1>
                <div class="main-with-side">
                    <div>
                        <div class="map-container" id="worldMap" style="height: 350px;"></div>
                        <div style="display: flex; gap: 15px; margin-top: 15px;">
                            <div class="data-card" style="flex: 1;">
                                <p>1960년</p>
                                <div class="stat-number" style="font-size: 28px;">30억</div>
                            </div>
                            <div class="data-card" style="flex: 1;">
                                <p>2005년</p>
                                <div class="stat-number" style="font-size: 28px;">65억</div>
                            </div>
                            <div class="data-card" style="flex: 1;">
                                <p>2050년 예측</p>
                                <div class="stat-number" style="font-size: 28px;">91억</div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3>인구증가 3대 주요 요인</h3>
                        <div class="panel-box" style="background: linear-gradient(135deg, #fef5e7 0%, #fdebd0 100%); margin-bottom: 10px;">
                            <h4>1. 인구구조 모멘텀</h4>
                            <p style="font-size: 11px;">
                                개발도상국의 높은 출산율 유지는 <strong>생식연령대 인구비율이 높기 때문</strong><br>
                                • 젊은 연령구조로 인한 지속적 출산<br>
                                • 인구 피라미드 기저부 확대
                            </p>
                        </div>
                        <div class="panel-box" style="background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); margin-bottom: 10px;">
                            <h4>2. 원하지 않는 출생</h4>
                            <p style="font-size: 11px;">
                                <strong>피임에 대한 미충족 수요의 결과</strong><br>
                                • 2억 명의 여성이 피임 접근 제한<br>
                                • 계획되지 않은 임신 지속
                            </p>
                        </div>
                        <div class="panel-box" style="background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%); margin-bottom: 15px;">
                            <h4>3. 높은 희망 가족 규모</h4>
                            <p style="font-size: 11px;">
                                <strong>문화적 선호와 사회경제적 요인</strong><br>
                                • 대가족 전통과 자녀 경제적 가치<br>
                                • 높은 영아 사망률에 대한 보상 심리
                            </p>
                        </div>
                        <h3>지역별 증가율</h3>
                        <table class="data-table" style="font-size: 11px;">
                            <thead>
                                <tr>
                                    <th>지역</th>
                                    <th>2005</th>
                                    <th>2050</th>
                                    <th>증가</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>사하라이남</td>
                                    <td>751M</td>
                                    <td>1,692M</td>
                                    <td style="color: #f56565;">+125%</td>
                                </tr>
                                <tr>
                                    <td>남아시아</td>
                                    <td>1,611M</td>
                                    <td>2,495M</td>
                                    <td style="color: #ed8936;">+55%</td>
                                </tr>
                                <tr>
                                    <td>동아시아</td>
                                    <td>1,524M</td>
                                    <td>1,587M</td>
                                    <td style="color: #48bb78;">+4%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Slide 4: 니제르 사례 -->
            <div class="slide">
                <h1>사하라이남 아프리카: 니제르 위기</h1>
                <div class="two-column">
                    <div>
                        <div id="nigerMap" class="map-container" style="height: 280px;"></div>
                        <div class="panel-box" style="margin-top: 15px; background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);">
                            <h3>니제르 현황</h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div>
                                    <p style="font-size: 11px; color: #718096;">합계출산율</p>
                                    <p style="font-size: 24px; font-weight: 800; color: #dc2626;">7.4명</p>
                                </div>
                                <div>
                                    <p style="font-size: 11px; color: #718096;">피임 사용률</p>
                                    <p style="font-size: 24px; font-weight: 800; color: #dc2626;">5%</p>
                                </div>
                                <div>
                                    <p style="font-size: 11px; color: #718096;">인구 증가율</p>
                                    <p style="font-size: 24px; font-weight: 800; color: #dc2626;">3.3%/년</p>
                                </div>
                                <div>
                                    <p style="font-size: 11px; color: #718096;">2050년 예측</p>
                                    <p style="font-size: 24px; font-weight: 800; color: #dc2626;">5천만명</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3>도전과 결과</h3>
                        <div class="quote-box">
                            <p>"현재 추세 지속 시 2050년까지 인구 4배 증가, 식량 안보와 환경 지속가능성 위협"</p>
                        </div>
                        <h4>주요 장애요인</h4>
                        <ul style="font-size: 13px; line-height: 1.8;">
                            <li>👥 <strong>문화적 요인</strong>: 대가족 선호, 조혼 관습</li>
                            <li>🏥 <strong>서비스 접근성</strong>: 농촌 지역 의료 시설 부족</li>
                            <li>📚 <strong>교육 부족</strong>: 여성 문해율 15% 미만</li>
                            <li>💰 <strong>경제적 제약</strong>: 피임 비용 부담</li>
                            <li>⚖️ <strong>성 불평등</strong>: 여성 의사결정권 제한</li>
                        </ul>
                        <div class="data-card" style="background: #fef3c7; margin-top: 15px;">
                            <h4 style="color: #92400e;">긴급 대응 필요</h4>
                            <p style="font-size: 12px;">
                                통합적 접근: 교육 + 보건 + 여성권한 + 경제개발
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 5: 성공 사례 - 케냐 & 브라질 -->
            <div class="slide">
                <h1>성공 스토리: 케냐와 브라질</h1>
                <div id="successMap" class="map-container" style="height: 300px;"></div>
                <div class="two-column" style="margin-top: 20px; height: auto;">
                    <div class="panel-box" style="background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);">
                        <h3>🇰🇪 케냐: 정부 주도 성공</h3>
                        <div style="display: flex; gap: 10px; margin: 10px 0;">
                            <div class="data-card" style="flex: 1;">
                                <p style="font-size: 11px;">TFR 변화</p>
                                <p style="font-weight: 800; color: #059669;">7.8→4.8</p>
                            </div>
                            <div class="data-card" style="flex: 1;">
                                <p style="font-size: 11px;">피임률</p>
                                <p style="font-weight: 800; color: #059669;">10→41%</p>
                            </div>
                        </div>
                        <p style="font-size: 12px;">
                            <strong>성공 요인:</strong><br>
                            • 강력한 정치적 의지<br>
                            • 지역사회 기반 프로그램<br>
                            • 남성 참여 프로그램
                        </p>
                    </div>
                    <div class="panel-box" style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);">
                        <h3>🇧🇷 브라질: 사회 주도 전환</h3>
                        <div style="display: flex; gap: 10px; margin: 10px 0;">
                            <div class="data-card" style="flex: 1;">
                                <p style="font-size: 11px;">TFR 변화</p>
                                <p style="font-weight: 800; color: #2563eb;">6.2→2.3</p>
                            </div>
                            <div class="data-card" style="flex: 1;">
                                <p style="font-size: 11px;">피임률</p>
                                <p style="font-weight: 800; color: #2563eb;">77%</p>
                            </div>
                        </div>
                        <p style="font-size: 12px;">
                            <strong>성공 요인:</strong><br>
                            • 미디어 영향 (TV 노벨라)<br>
                            • 여성 교육 확대<br>
                            • 도시화와 경제 발전
                        </p>
                    </div>
                </div>
            </div>

            <!-- Slide 6: 남아시아 비교 -->
            <div class="slide">
                <h1>남아시아 대조: 방글라데시 vs 파키스탄</h1>
                <div id="southAsiaMap" class="map-container" style="height: 320px;"></div>
                <div class="two-column" style="margin-top: 20px; height: auto;">
                    <div>
                        <h3>🇧🇩 방글라데시: 혁신적 성공</h3>
                        <div class="chart-container small-chart">
                            <canvas id="bangladeshChart"></canvas>
                        </div>
                        <p style="font-size: 12px; margin-top: 10px;">
                            <strong>핵심 전략:</strong> 여성 지역보건요원, 문맹 여성 대상 프로그램, 소액금융 연계
                        </p>
                    </div>
                    <div>
                        <h3>🇵🇰 파키스탄: 정체 상태</h3>
                        <div class="chart-container small-chart">
                            <canvas id="pakistanChart"></canvas>
                        </div>
                        <p style="font-size: 12px; margin-top: 10px;">
                            <strong>장애 요인:</strong> 정치적 불안정, 종교적 반대, 여성 이동 제한
                        </p>
                    </div>
                </div>
            </div>

            <!-- Slide 7: MDG와 가족계획 -->
            <div class="slide">
                <h1>밀레니엄 개발목표(MDG)와 가족계획</h1>
                <div class="two-column">
                    <div>
                        <h3>MDG 달성을 위한 가족계획의 기여</h3>
                        <div class="panel-box">
                            <h4>MDG 1: 빈곤 퇴치</h4>
                            <p style="font-size: 13px;">
                                • 인구 증가율 감소 → 1인당 소득 증가<br>
                                • 가구당 자녀수 감소 → 교육 투자 증대<br>
                                • 여성 경제활동 참여 증가
                            </p>
                        </div>
                        <div class="panel-box">
                            <h4>MDG 4 & 5: 모성·아동 건강</h4>
                            <p style="font-size: 13px;">
                                • 모성 사망 32% 예방 가능<br>
                                • 아동 사망 10% 감소 가능<br>
                                • 출산 간격 조절로 건강 개선
                            </p>
                        </div>
                        <div class="panel-box">
                            <h4>MDG 3: 성평등</h4>
                            <p style="font-size: 13px;">
                                • 여성의 생식건강 자기결정권<br>
                                • 교육 및 경제활동 기회 확대<br>
                                • 가정 내 의사결정 참여 증대
                            </p>
                        </div>
                    </div>
                    <div>
                        <h3>비용 효과성</h3>
                        <div class="chart-container">
                            <canvas id="costEffectiveness"></canvas>
                        </div>
                        <div class="data-card" style="margin-top: 15px; background: #69b7a4; color: white;">
                            <h4 style="color: white;">투자 대비 효과</h4>
                            <p style="font-size: 24px; font-weight: 800;">1:120</p>
                            <p style="font-size: 12px;">가족계획 $1 투자 → $120 경제적 편익</p>
                        </div>
                        <div class="quote-box" style="margin-top: 15px;">
                            <p>"가족계획은 모든 MDG 달성에 기여하는 핵심 개입"</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 8: 건강 혜택 종합 -->
            <div class="slide">
                <h1>가족계획의 건강 영향</h1>
                <div class="two-column">
                    <div>
                        <h3>모성 및 영아 건강</h3>
                        <div class="chart-container">
                            <canvas id="healthImpactChart"></canvas>
                        </div>
                        <div class="data-card" style="margin-top: 15px;">
                            <p>모성 사망 감소</p>
                            <div class="stat-number" style="font-size: 32px;">-32%</div>
                            <p style="font-size: 11px;">가족계획 보편화 시</p>
                        </div>
                    </div>
                    <div>
                        <h3>피임의 추가 건강 혜택</h3>
                        <div class="panel-box">
                            <h4>경구피임약 효과</h4>
                            <ul style="font-size: 12px;">
                                <li>난소암 위험 <strong>50% 감소</strong></li>
                                <li>자궁내막암 <strong>50% 감소</strong></li>
                                <li>대장암 위험 감소</li>
                                <li>월경 관련 빈혈 개선</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: #fef3c7;">
                            <h4>간격 조절 효과</h4>
                            <ul style="font-size: 12px;">
                                <li>조산 위험 <strong>40% 감소</strong></li>
                                <li>저체중아 <strong>30% 감소</strong></li>
                                <li>영아 사망률 <strong>20% 감소</strong></li>
                            </ul>
                        </div>
                        <div class="quote-box" style="margin-top: 15px;">
                            <p>"가족계획은 가장 비용효과적인 보건 개입"</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 9: 한국 인구구조 변화 -->
            <div class="slide">
                <h1>한국 인구구조 변화: 1960-2040</h1>
                <div style="position: relative; height: 450px;">
                    <div id="koreaPyramidContainer" style="position: relative; width: 100%; height: 400px;">
                        <canvas id="koreaPyramid" style="width: 100%; height: 100%;"></canvas>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
                        <div style="flex: 1;">
                            <h3 id="pyramidYear" style="font-size: 24px; color: #2d3a3a;">1960년</h3>
                            <div class="data-card" style="background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%);">
                                <p style="font-size: 11px;">생산연령인구(15-64세)</p>
                                <p id="workingAgePercent" style="font-size: 20px; font-weight: 800; color: #0284c7;">54.8%</p>
                            </div>
                        </div>
                        <div style="flex: 2; text-align: center;">
                            <div class="panel-box" style="background: linear-gradient(135deg, #fef5e7 0%, #fdebd0 100%);">
                                <h4>인구구조 특징</h4>
                                <p id="pyramidDescription" style="font-size: 12px;">
                                    피라미드형 - 높은 출산율, 짧은 기대수명
                                </p>
                            </div>
                        </div>
                        <div style="flex: 1; text-align: right;">
                            <div class="data-card" style="background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);">
                                <p style="font-size: 11px;">고령인구(65세+)</p>
                                <p id="elderlyPercent" style="font-size: 20px; font-weight: 800; color: #dc2626;">2.9%</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 10: 교육과 출산율 -->
            <div class="slide">
                <h1>교육과 출산율의 상관관계</h1>
                <div class="two-column">
                    <div>
                        <div class="chart-container">
                            <canvas id="educationFertility"></canvas>
                        </div>
                        <div class="panel-box" style="margin-top: 15px;">
                            <h4>교육 효과</h4>
                            <p style="font-size: 12px;">
                                여성 중등교육 1년 증가 → TFR <strong>0.3명 감소</strong>
                            </p>
                        </div>
                    </div>
                    <div>
                        <h3>연령별 출산 패턴</h3>
                        <div class="chart-container small-chart">
                            <canvas id="agePatterns"></canvas>
                        </div>
                        <table class="data-table" style="margin-top: 15px;">
                            <tr>
                                <th>교육수준</th>
                                <th>첫출산 연령</th>
                                <th>완결출산율</th>
                            </tr>
                            <tr>
                                <td>무학</td>
                                <td>18.5세</td>
                                <td>5.8명</td>
                            </tr>
                            <tr>
                                <td>초등</td>
                                <td>20.2세</td>
                                <td>4.2명</td>
                            </tr>
                            <tr>
                                <td>중등</td>
                                <td>23.8세</td>
                                <td>2.9명</td>
                            </tr>
                            <tr>
                                <td>고등</td>
                                <td>27.3세</td>
                                <td>1.8명</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Slide 11: 미충족 수요 분석 -->
            <div class="slide">
                <h1>미충족 수요: 정의와 지역별 분포</h1>
                <div class="two-column">
                    <div>
                        <h3>지역별 미충족 수요</h3>
                        <div class="chart-container" style="height: 250px;">
                            <canvas id="unmetNeedByRegion"></canvas>
                        </div>
                        <div class="panel-box" style="margin-top: 15px;">
                            <h4>총 미충족 수요</h4>
                            <div class="stat-number" style="font-size: 24px;">2.01억명</div>
                            <p style="font-size: 11px;">가임기 기혼 여성 중</p>
                        </div>
                    </div>
                    <div>
                        <h3>미충족 수요의 원인</h3>
                        <div class="chart-container small-chart" style="height: 200px;">
                            <canvas id="unmetNeedReasons"></canvas>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px;">
                            <div class="data-card">
                                <h4>경제 수준별</h4>
                                <canvas id="unmetNeedByWealth" style="height: 120px;"></canvas>
                            </div>
                            <div class="data-card">
                                <h4>정의</h4>
                                <p style="font-size: 10px;">
                                    임신을 원하지 않거나 연기하고자 하지만 피임을 사용하지 않는 여성
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 12: 서비스 전달 -->
            <div class="slide">
                <h1>서비스 전달 모델과 접근성 개선</h1>
                <div class="two-column">
                    <div>
                        <h3>효과적인 전달 모델</h3>
                        <div class="panel-box">
                            <h4>1. 지역사회 기반</h4>
                            <p style="font-size: 12px;">
                                • 마을 보건요원 활용<br>
                                • 이동식 클리닉<br>
                                • 또래 교육자 프로그램
                            </p>
                        </div>
                        <div class="panel-box">
                            <h4>2. 시설 기반</h4>
                            <p style="font-size: 12px;">
                                • 원스톱 서비스<br>
                                • 산후 즉시 제공<br>
                                • 청소년 친화적 공간
                            </p>
                        </div>
                        <div class="panel-box">
                            <h4>3. 혁신적 접근</h4>
                            <p style="font-size: 12px;">
                                • 모바일 헬스 (mHealth)<br>
                                • 바우처 시스템<br>
                                • 소셜 프랜차이즈
                            </p>
                        </div>
                    </div>
                    <div>
                        <h3>접근성 장벽 제거</h3>
                        <div class="chart-container">
                            <canvas id="accessBarriers"></canvas>
                        </div>
                        <div class="quote-box" style="margin-top: 15px;">
                            <p>"마지막 1마일 문제 해결이 핵심"</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 13: 피임 방법과 효과성 -->
            <div class="slide">
                <h1>피임 방법별 효과성과 지역별 선호</h1>
                <div class="main-with-side">
                    <div>
                        <h3>방법별 효과성</h3>
                        <div class="chart-container">
                            <canvas id="methodEffectiveness"></canvas>
                        </div>
                        <div class="panel-box" style="margin-top: 15px;">
                            <h4>피임법 효과성 비교</h4>
                            <ul style="font-size: 12px;">
                                <li>장기지속형: 가장 효과적 (>99%)</li>
                                <li>IUD: 높은 효과성, 장기 사용 가능</li>
                                <li>호르몬 방법: 주사제, 경구약</li>
                                <li>차단형: 콘돔, 페미돔</li>
                                <li>자연 방법: 낮은 효과성</li>
                            </ul>
                        </div>
                    </div>
                    <div>
                        <h3>지역별 선호</h3>
                        <div class="data-card">
                            <h4>아프리카</h4>
                            <p style="font-size: 11px;">주사제 (31%), 경구약 (23%)</p>
                        </div>
                        <div class="data-card">
                            <h4>아시아</h4>
                            <p style="font-size: 11px;">불임수술 (37%), IUD (15%)</p>
                        </div>
                        <div class="data-card">
                            <h4>라틴아메리카</h4>
                            <p style="font-size: 11px;">불임수술 (31%), 경구약 (25%)</p>
                        </div>
                        <div class="panel-box" style="margin-top: 15px;">
                            <h4>방법 선택 고려사항</h4>
                            <ul style="font-size: 11px;">
                                <li>문화적 수용성</li>
                                <li>부작용 프로필</li>
                                <li>가역성 요구</li>
                                <li>비용과 접근성</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 14: 남성 참여와 서비스 통합 -->
            <div class="slide">
                <h1>남성 참여와 서비스 통합</h1>
                <div class="two-column">
                    <div>
                        <h3>남성 참여의 중요성</h3>
                        <div class="panel-box">
                            <h4>남성 참여 필요성</h4>
                            <ul style="font-size: 12px;">
                                <li>부부 의사결정 공유</li>
                                <li>지속적 피임 사용 증가</li>
                                <li>성평등 증진</li>
                                <li>부부 간 의사소통 개선</li>
                            </ul>
                        </div>
                        <div class="chart-container small-chart">
                            <canvas id="maleInvolvement"></canvas>
                        </div>
                    </div>
                    <div>
                        <h3>서비스 통합 전략</h3>
                        <div class="panel-box" style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);">
                            <h4>모자보건 통합</h4>
                            <p style="font-size: 12px;">
                                • 산전/산후 관리와 연계<br>
                                • 예방접종 시 가족계획 상담<br>
                                • 안전한 출산 서비스
                            </p>
                        </div>
                        <div class="panel-box" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);">
                            <h4>HIV/STI 서비스 연계</h4>
                            <p style="font-size: 12px;">
                                • 이중보호 전략<br>
                                • VCT 센터 활용<br>
                                • 통합 상담 서비스
                            </p>
                        </div>
                        <div class="panel-box" style="background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);">
                            <h4>청소년 친화 서비스</h4>
                            <p style="font-size: 12px;">
                                • 학교 보건 프로그램<br>
                                • 또래 교육자 활용<br>
                                • 비밀보장 서비스
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 15: 자금 조달 -->
            <div class="slide">
                <h1>자금 조달과 자원 배분</h1>
                <div class="two-column">
                    <div>
                        <h3>글로벌 자금 동향</h3>
                        <div class="chart-container">
                            <canvas id="fundingTrends"></canvas>
                        </div>
                        <div class="data-card" style="margin-top: 15px;">
                            <p>자금 격차</p>
                            <div class="stat-number" style="font-size: 28px;">증가 필요</div>
                            <p style="font-size: 11px;">지속적 투자 확대 필요</p>
                        </div>
                    </div>
                    <div>
                        <h3>자금 출처와 배분</h3>
                        <div class="panel-box">
                            <h4>자금 지원 필요</h4>
                            <ul style="font-size: 12px;">
                                <li>국제 공여자 지원</li>
                                <li>국내 자원 동원</li>
                                <li>민간 부문 참여</li>
                                <li>혁신적 자금 조달</li>
                                <li>지속가능 재원 확보</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: #fef3c7;">
                            <h4>투자 우선순위</h4>
                            <p style="font-size: 12px;">
                                • 사하라이남 아프리카<br>
                                • 청소년 프로그램<br>
                                • 가장 취약한 계층<br>
                                • 품질 개선 투자
                            </p>
                        </div>
                        <div class="quote-box" style="margin-top: 15px;">
                            <p>"투자 1달러 = 120달러 경제 효과"</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 16: 정책 프레임워크 -->
            <div class="slide">
                <h1>정책 프레임워크와 SDG 연계</h1>
                <div class="main-with-side">
                    <div>
                        <h3>SDG 목표와 가족계획</h3>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                            <div class="data-card">
                                <h4 style="color: #dc2626;">SDG 3</h4>
                                <p style="font-size: 11px;">건강과 웰빙</p>
                            </div>
                            <div class="data-card">
                                <h4 style="color: #ea580c;">SDG 5</h4>
                                <p style="font-size: 11px;">성평등</p>
                            </div>
                            <div class="data-card">
                                <h4 style="color: #ca8a04;">SDG 1</h4>
                                <p style="font-size: 11px;">빈곤 종식</p>
                            </div>
                            <div class="data-card">
                                <h4 style="color: #65a30d;">SDG 4</h4>
                                <p style="font-size: 11px;">양질의 교육</p>
                            </div>
                            <div class="data-card">
                                <h4 style="color: #0891b2;">SDG 8</h4>
                                <p style="font-size: 11px;">경제성장</p>
                            </div>
                            <div class="data-card">
                                <h4 style="color: #7c3aed;">SDG 13</h4>
                                <p style="font-size: 11px;">기후행동</p>
                            </div>
                        </div>
                        <div class="panel-box" style="margin-top: 15px;">
                            <h4>정책 권고사항</h4>
                            <ol style="font-size: 12px;">
                                <li>보편적 접근성 보장</li>
                                <li>청소년 서비스 확대</li>
                                <li>남성 참여 의무화</li>
                                <li>품질 보증 시스템</li>
                                <li>지속가능 자금 확보</li>
                            </ol>
                        </div>
                    </div>
                    <div>
                        <h3>실행 로드맵</h3>
                        <div class="panel-box" style="background: #fee2e2;">
                            <h4>단기 (1-2년)</h4>
                            <ul style="font-size: 11px;">
                                <li>서비스 격차 평가</li>
                                <li>인력 교육</li>
                                <li>공급망 강화</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: #fef3c7;">
                            <h4>중기 (3-5년)</h4>
                            <ul style="font-size: 11px;">
                                <li>통합 서비스 구축</li>
                                <li>디지털 시스템</li>
                                <li>품질 개선</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: #dcfce7;">
                            <h4>장기 (5년+)</h4>
                            <ul style="font-size: 11px;">
                                <li>보편적 커버리지</li>
                                <li>지속가능성 확보</li>
                                <li>혁신 확산</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 17: 연구 우선순위 -->
            <div class="slide">
                <h1>연구 개발과 미래 우선순위</h1>
                <div class="two-column">
                    <div>
                        <h3>연구 개발 우선순위</h3>
                        <div class="panel-box">
                            <h4>신기술 개발</h4>
                            <ul style="font-size: 12px;">
                                <li>장기 지속형 피임법</li>
                                <li>남성 피임약 개발</li>
                                <li>비호르몬 옵션</li>
                                <li>자가 투여 방법</li>
                            </ul>
                        </div>
                        <div class="panel-box">
                            <h4>서비스 연구</h4>
                            <ul style="font-size: 12px;">
                                <li>통합 서비스 모델</li>
                                <li>디지털 헬스 효과</li>
                                <li>행동 변화 전략</li>
                                <li>비용 효과성</li>
                            </ul>
                        </div>
                    </div>
                    <div>
                        <h3>환경 지속가능성</h3>
                        <div class="chart-container small-chart">
                            <canvas id="environmentImpact"></canvas>
                        </div>
                        <div class="quote-box" style="margin-top: 15px;">
                            <p>"인구 안정화는 기후 변화 대응의 핵심 전략"</p>
                        </div>
                        <div class="data-card" style="margin-top: 15px;">
                            <h4>환경 영향</h4>
                            <p style="font-size: 11px;">
                                인구 안정화로 <strong>환경 부담 감소</strong><br>
                                지속가능 발전 기여
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 18: 글로벌 구현 지도 -->
            <div class="slide">
                <h1>가족계획 우선순위 국가 분류</h1>
                <div id="globalMap" class="map-container" style="height: 380px;"></div>
                <div class="panel-box" style="margin-top: 15px;">
                    <h4>우선순위 설정 기준 (75개 저소득/중저소득 국가)</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px;">
                        <div>
                            <p style="font-size: 12px;"><strong>높은 우선순위 (26개국)</strong><br>
                            • 인구증가율 ≥2%/년<br>
                            • 미충족 수요 ≥20%<br>
                            • 피임 사용률 평균 17%<br>
                            • TFR >5명</p>
                        </div>
                        <div>
                            <p style="font-size: 12px;"><strong>주요 특징</strong><br>
                            • 대부분 사하라이남 아프리카<br>
                            • 제한적 낙태법<br>
                            • 높은 모성·아동 사망률<br>
                            • MDG 달성 위험</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 19: 핵심 메시지 -->
            <div class="slide">
                <h1>핵심 메시지와 행동 촉구</h1>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div>
                        <h3>미완의 과제</h3>
                        <div class="panel-box">
                            <ul style="font-size: 13px; line-height: 1.8;">
                                <li>2억 명의 미충족 수요</li>
                                <li>높은 모성 사망률 지속</li>
                                <li>청소년 임신 문제</li>
                                <li>성평등 과제</li>
                            </ul>
                        </div>
                        <h3 style="margin-top: 20px;">기회의 창</h3>
                        <div class="panel-box" style="background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);">
                            <ul style="font-size: 13px; line-height: 1.8;">
                                <li>인구 배당 효과 실현</li>
                                <li>SDG 목표 달성</li>
                                <li>기후 변화 완화</li>
                                <li>경제 성장 가속화</li>
                            </ul>
                        </div>
                    </div>
                    <div>
                        <h3>행동 촉구</h3>
                        <div class="data-card" style="background: #69b7a4; color: white;">
                            <h4 style="color: white;">정부</h4>
                            <p>정치적 의지와 자원 투입</p>
                        </div>
                        <div class="data-card" style="margin-top: 10px; background: #8fa68e; color: white;">
                            <h4 style="color: white;">개발 파트너</h4>
                            <p>지속가능한 자금 지원</p>
                        </div>
                        <div class="data-card" style="margin-top: 10px; background: #a8957e; color: white;">
                            <h4 style="color: white;">시민사회</h4>
                            <p>옹호와 모니터링</p>
                        </div>
                        <div class="data-card" style="margin-top: 10px; background: #c4a977; color: white;">
                            <h4 style="color: white;">개인</h4>
                            <p>정보 기반 선택</p>
                        </div>
                    </div>
                </div>
                <div class="quote-box" style="margin-top: 30px; text-align: center;">
                    <p style="font-size: 16px; font-weight: 500;">
                        "모든 임신이 원하는 임신이 되는 세상을 향하여"
                    </p>
                </div>
            </div>

            <!-- Slide 20: 참고문헌 -->
            <div class="slide">
                <h1>참고문헌 및 추가 자료</h1>
                <div class="two-column">
                    <div>
                        <h3>주요 문헌</h3>
                        <div class="panel-box">
                            <p style="font-size: 12px; line-height: 1.8;">
                                <strong>Cleland J, Bernstein S, Ezeh A, et al.</strong><br>
                                Family planning: the unfinished agenda.<br>
                                <em>Lancet</em> 2006; 368: 1810-27.<br><br>

                                <strong>WHO</strong><br>
                                Family Planning/Contraception Methods.<br>
                                Geneva: World Health Organization, 2023.<br><br>

                                <strong>UNFPA</strong><br>
                                State of World Population 2023.<br>
                                New York: United Nations Population Fund.
                            </p>
                        </div>
                    </div>
                    <div>
                        <h3>추가 자원</h3>
                        <div class="panel-box" style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);">
                            <h4>온라인 리소스</h4>
                            <ul style="font-size: 12px;">
                                <li>FP2030 (fp2030.org)</li>
                                <li>Guttmacher Institute</li>
                                <li>Population Council</li>
                                <li>Track20 데이터</li>
                            </ul>
                        </div>
                        <div class="panel-box" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);">
                            <h4>실무 도구</h4>
                            <ul style="font-size: 12px;">
                                <li>WHO 의료 자격 기준</li>
                                <li>FP 글로벌 핸드북</li>
                                <li>품질 보증 도구</li>
                                <li>비용 계산기</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 40px;">
                    <p style="font-size: 14px; color: #718096;">
                        감사합니다
                    </p>
                </div>
            </div>

        </div>
    </div>

    <script>
        // 슬라이드 네비게이션
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;

        function showSlide(index) {
            if (index < 0) index = totalSlides - 1;
            if (index >= totalSlides) index = 0;

            slides.forEach(slide => slide.classList.remove('active'));
            slides[index].classList.add('active');
            currentSlide = index;

            // 슬라이드별 차트 및 지도 초기화
            initSlideContent(index);
        }

        // 키보드 네비게이션
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') {
                showSlide(currentSlide + 1);
            } else if (e.key === 'ArrowLeft') {
                showSlide(currentSlide - 1);
            } else if (e.key === 'Home') {
                showSlide(0);
            } else if (e.key === 'End') {
                showSlide(totalSlides - 1);
            }
        });

        // 국가 데이터
        const countryData = {
            niger: {
                name: '니제르',
                coords: [13.5, 2.1],
                tfr: 7.4,
                contraceptive: 5,
                unmetNeed: 19,
                maternalMortality: 553,
                trend: '위기 - 급속한 인구 증가',
                color: '#c97064'
            },
            kenya: {
                name: '케냐',
                coords: [-1.3, 36.8],
                tfr: 4.8,
                contraceptive: 41,
                unmetNeed: 18,
                maternalMortality: 342,
                trend: '정체 - 추가 노력 필요',
                color: '#c4a977'
            },
            brazil: {
                name: '브라질',
                coords: [-14.2, -51.9],
                tfr: 2.3,
                contraceptive: 77,
                unmetNeed: 6,
                maternalMortality: 60,
                trend: '성공 - 자연적 감소',
                color: '#69b7a4'
            },
            bangladesh: {
                name: '방글라데시',
                coords: [23.7, 90.4],
                tfr: 3.0,
                contraceptive: 58,
                unmetNeed: 12,
                maternalMortality: 173,
                trend: '빠른 진전',
                color: '#7db8b5'
            },
            pakistan: {
                name: '파키스탄',
                coords: [30.4, 69.3],
                tfr: 4.3,
                contraceptive: 30,
                unmetNeed: 20,
                maternalMortality: 140,
                trend: '느린 진전',
                color: '#c4a977'
            },
            iran: {
                name: '이란',
                coords: [32.4, 53.7],
                tfr: 2.0,
                contraceptive: 73,
                unmetNeed: 8,
                maternalMortality: 16,
                trend: '성공 사례',
                color: '#69b7a4'
            },
            thailand: {
                name: '태국',
                coords: [15.9, 100.9],
                tfr: 1.8,
                contraceptive: 72,
                unmetNeed: 7,
                maternalMortality: 37,
                trend: '성공 사례',
                color: '#69b7a4'
            },
            rwanda: {
                name: '르완다',
                coords: [-1.9, 29.9],
                tfr: 4.0,
                contraceptive: 53,
                unmetNeed: 14,
                maternalMortality: 248,
                trend: '빠른 개선',
                color: '#7db8b5'
            },
            mexico: {
                name: '멕시코',
                coords: [23.6, -102.5],
                tfr: 2.2,
                contraceptive: 67,
                unmetNeed: 10,
                maternalMortality: 33,
                trend: '지속적 개선',
                color: '#69b7a4'
            },
            indonesia: {
                name: '인도네시아',
                coords: [-0.8, 113.9],
                tfr: 2.4,
                contraceptive: 61,
                unmetNeed: 11,
                maternalMortality: 177,
                trend: '꾸준한 진전',
                color: '#7db8b5'
            },
            vietnam: {
                name: '베트남',
                coords: [14.1, 108.3],
                tfr: 1.9,
                contraceptive: 68,
                unmetNeed: 9,
                maternalMortality: 43,
                trend: '성공 사례',
                color: '#69b7a4'
            }
        };

        // 지도 인스턴스 저장
        let maps = {};

        // 지도 생성 함수
        function createMap(elementId, center = [0, 0], zoom = 2) {
            if (maps[elementId]) {
                maps[elementId].remove();
            }

            const mapElement = document.getElementById(elementId);
            if (!mapElement) return null;

            const map = L.map(elementId).setView(center, zoom);

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);

            maps[elementId] = map;
            return map;
        }

        // 국가 마커 추가 함수
        function addCountryMarker(map, country) {
            const data = countryData[country];
            if (!data || !map) return;

            const marker = L.circleMarker(data.coords, {
                radius: 8,
                fillColor: data.color,
                color: '#fff',
                weight: 2,
                opacity: 1,
                fillOpacity: 0.8
            }).addTo(map);

            // 커스텀 툴팁 HTML
            const tooltipContent = `
                <div class="map-tooltip">
                    <h4>${data.name}</h4>
                    <div class="tooltip-stat">
                        <span class="tooltip-label">합계출산율:</span>
                        <span class="tooltip-value">${data.tfr}명</span>
                    </div>
                    <div class="tooltip-stat">
                        <span class="tooltip-label">피임 사용률:</span>
                        <span class="tooltip-value">${data.contraceptive}%</span>
                    </div>
                    <div class="tooltip-stat">
                        <span class="tooltip-label">미충족 수요:</span>
                        <span class="tooltip-value">${data.unmetNeed}%</span>
                    </div>
                    <div class="tooltip-stat">
                        <span class="tooltip-label">모성사망률:</span>
                        <span class="tooltip-value">${data.maternalMortality}/10만</span>
                    </div>
                    <div class="tooltip-trend ${data.color === '#10b981' ? 'trend-positive' : data.color === '#dc2626' ? 'trend-negative' : 'trend-neutral'}">
                        ${data.trend}
                    </div>
                </div>
            `;

            marker.bindTooltip(tooltipContent, {
                permanent: false,
                direction: 'top',
                className: 'custom-tooltip',
                offset: [0, -10]
            });

            marker.on('mouseover', function() {
                this.openTooltip();
            });

            marker.on('mouseout', function() {
                this.closeTooltip();
            });

            return marker;
        }

        // 차트 생성 함수
        function createChart(canvasId, config) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;

            const ctx = canvas.getContext('2d');

            // 기존 차트 제거
            if (canvas.chart) {
                canvas.chart.destroy();
            }

            canvas.chart = new Chart(ctx, config);
        }

        // 슬라이드별 콘텐츠 초기화
        function initSlideContent(slideIndex) {
            switch(slideIndex) {
                case 1: // 역사적 맥락
                    createChart('historicalTrend', {
                        type: 'line',
                        data: {
                            labels: ['1960', '1970', '1980', '1990', '2000', '2010', '2020'],
                            datasets: [{
                                label: '세계 평균 TFR',
                                data: [5.0, 4.5, 3.6, 3.0, 2.5, 2.4, 2.3],
                                borderColor: '#69b7a4',
                                backgroundColor: 'rgba(105, 183, 164, 0.1)',
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false },
                                title: {
                                    display: true,
                                    text: '세계 평균 합계출산율 변화',
                                    font: { family: 'SeoulHangang', weight: 700 }
                                }
                            }
                        }
                    });
                    break;

                case 2: // 글로벌 인구 현황
                    setTimeout(() => {
                        const map = createMap('worldMap');
                        if (map) {
                            // 모든 국가 마커 추가
                            Object.keys(countryData).forEach(country => {
                                addCountryMarker(map, country);
                            });
                        }
                    }, 100);
                    break;

                case 3: // 니제르 사례
                    setTimeout(() => {
                        const map = createMap('nigerMap', [17, 8], 6);
                        if (map) {
                            addCountryMarker(map, 'niger');

                            // 주변 국가도 표시
                            addCountryMarker(map, 'kenya');
                        }
                    }, 100);
                    break;

                case 4: // 성공 사례
                    setTimeout(() => {
                        const map = createMap('successMap', [-10, -30], 2);
                        if (map) {
                            addCountryMarker(map, 'kenya');
                            addCountryMarker(map, 'brazil');
                            addCountryMarker(map, 'thailand');
                            addCountryMarker(map, 'iran');
                        }
                    }, 100);
                    break;

                case 5: // 남아시아 비교
                    setTimeout(() => {
                        const map = createMap('southAsiaMap', [25, 80], 4);
                        if (map) {
                            addCountryMarker(map, 'bangladesh');
                            addCountryMarker(map, 'pakistan');
                        }
                    }, 100);

                    createChart('bangladeshChart', {
                        type: 'line',
                        data: {
                            labels: ['1975', '1985', '1995', '2005', '2015'],
                            datasets: [{
                                label: 'TFR',
                                data: [6.3, 5.1, 3.4, 2.9, 2.3],
                                borderColor: '#69b7a4',
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                title: {
                                    display: true,
                                    text: '방글라데시 TFR 감소',
                                    font: { family: 'SeoulHangang' }
                                }
                            }
                        }
                    });

                    createChart('pakistanChart', {
                        type: 'line',
                        data: {
                            labels: ['1975', '1985', '1995', '2005', '2015'],
                            datasets: [{
                                label: 'TFR',
                                data: [6.3, 6.0, 5.4, 4.3, 3.7],
                                borderColor: '#c4a977',
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                title: {
                                    display: true,
                                    text: '파키스탄 TFR 정체',
                                    font: { family: 'SeoulHangang' }
                                }
                            }
                        }
                    });
                    break;

                case 7: // 건강 영향
                    createChart('healthImpactChart', {
                        type: 'bar',
                        data: {
                            labels: ['모성 사망', '영아 사망', '5세 이하 사망'],
                            datasets: [{
                                label: '감소율 (%)',
                                data: [32, 20, 25],
                                backgroundColor: ['#c97064', '#c4a977', '#69b7a4']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false }
                            }
                        }
                    });
                    break;

                case 8: // 한국 인구구조 변화
                    initKoreaPyramid();
                    break;

                case 9: // 교육과 출산율
                    createChart('educationFertility', {
                        type: 'scatter',
                        data: {
                            datasets: [{
                                label: '교육-출산율 상관관계',
                                data: [
                                    {x: 0, y: 5.8},
                                    {x: 3, y: 4.5},
                                    {x: 6, y: 3.2},
                                    {x: 9, y: 2.4},
                                    {x: 12, y: 1.8}
                                ],
                                backgroundColor: '#69b7a4'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    title: {
                                        display: true,
                                        text: '여성 교육 연수'
                                    }
                                },
                                y: {
                                    title: {
                                        display: true,
                                        text: '합계출산율'
                                    }
                                }
                            }
                        }
                    });

                    createChart('agePatterns', {
                        type: 'line',
                        data: {
                            labels: ['15-19', '20-24', '25-29', '30-34', '35-39', '40-44'],
                            datasets: [
                                {
                                    label: '무학',
                                    data: [150, 250, 200, 150, 80, 30],
                                    borderColor: '#c97064'
                                },
                                {
                                    label: '고등교육',
                                    data: [20, 80, 180, 150, 60, 10],
                                    borderColor: '#69b7a4'
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });
                    break;

                case 10: // 미충족 수요
                    // 지역별 미충족 수요 차트
                    createChart('unmetNeedByRegion', {
                        type: 'bar',
                        data: {
                            labels: ['사하라이남', '남아시아', '중동/북아프리카', '라틴아메리카', '동아시아'],
                            datasets: [{
                                label: '미충족 수요 (%)',
                                data: [24, 18, 15, 10, 7],
                                backgroundColor: ['#c97064', '#d4826e', '#c4a977', '#8fa68e', '#69b7a4']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            indexAxis: 'y',
                            plugins: {
                                legend: { display: false },
                                title: {
                                    display: true,
                                    text: '지역별 미충족 수요 비율',
                                    font: { size: 12, family: 'SeoulHangang' }
                                }
                            }
                        }
                    });

                    // 미충족 수요 원인
                    createChart('unmetNeedReasons', {
                        type: 'doughnut',
                        data: {
                            labels: ['접근성 부족', '부작용 우려', '문화적 반대', '비용 문제'],
                            datasets: [{
                                data: [45, 26, 23, 6],
                                backgroundColor: ['#c97064', '#c4a977', '#a8957e', '#8fa68e']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: { font: { size: 10, family: 'SeoulHangang' } }
                                }
                            }
                        }
                    });

                    // 경제 수준별 미충족 수요
                    createChart('unmetNeedByWealth', {
                        type: 'line',
                        data: {
                            labels: ['최빈층', '빈곤층', '중산층', '부유층'],
                            datasets: [{
                                label: '미충족 수요 (%)',
                                data: [36, 28, 19, 12],
                                borderColor: '#c97064',
                                backgroundColor: 'rgba(201, 112, 100, 0.1)',
                                tension: 0.3
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: { font: { size: 9 } }
                                },
                                x: {
                                    ticks: { font: { size: 9 } }
                                }
                            }
                        }
                    });
                    break;

                case 11: // 서비스 전달
                    createChart('accessBarriers', {
                        type: 'doughnut',
                        data: {
                            labels: ['접근성', '부작용 우려', '문화적 반대', '비용'],
                            datasets: [{
                                data: [45, 26, 23, 6],
                                backgroundColor: ['#69b7a4', '#8fa68e', '#a8957e', '#c4a977']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });
                    break;

                case 12: // 피임 방법
                    createChart('methodEffectiveness', {
                        type: 'horizontalBar',
                        data: {
                            labels: ['임플란트', 'IUD', '불임수술', '주사', '경구약', '콘돔'],
                            datasets: [{
                                label: '효과성 (%)',
                                data: [99.95, 99.2, 99.5, 94, 91, 82],
                                backgroundColor: '#69b7a4'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    min: 80,
                                    max: 100
                                }
                            }
                        }
                    });
                    break;

                case 13: // 남성 참여
                    createChart('maleInvolvement', {
                        type: 'bar',
                        data: {
                            labels: ['참여 전', '참여 후'],
                            datasets: [{
                                label: '피임 사용률 (%)',
                                data: [35, 62],
                                backgroundColor: ['#c4a977', '#69b7a4']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });
                    break;

                case 14: // 자금 조달
                    createChart('fundingTrends', {
                        type: 'line',
                        data: {
                            labels: ['2010', '2012', '2014', '2016', '2018', '2020', '2022'],
                            datasets: [
                                {
                                    label: '필요 자금',
                                    data: [5.5, 5.8, 6.2, 6.5, 6.8, 7.0, 7.1],
                                    borderColor: '#c97064',
                                    borderDash: [5, 5]
                                },
                                {
                                    label: '실제 자금',
                                    data: [3.2, 3.5, 3.8, 3.7, 3.9, 3.8, 3.9],
                                    borderColor: '#7db8b5'
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    title: {
                                        display: true,
                                        text: '십억 달러'
                                    }
                                }
                            }
                        }
                    });
                    break;

                case 16: // 연구 개발
                    createChart('environmentImpact', {
                        type: 'line',
                        data: {
                            labels: ['2020', '2030', '2040', '2050'],
                            datasets: [
                                {
                                    label: '현재 추세',
                                    data: [36, 42, 48, 55],
                                    borderColor: '#c97064'
                                },
                                {
                                    label: 'FP 보편화',
                                    data: [36, 38, 37, 35],
                                    borderColor: '#69b7a4'
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    title: {
                                        display: true,
                                        text: 'CO₂ 배출 (Gt)'
                                    }
                                }
                            }
                        }
                    });
                    break;

                case 17: // 글로벌 지도
                    setTimeout(() => {
                        const map = createMap('globalMap', [20, 0], 2);
                        if (map) {
                            // 모든 국가 표시
                            Object.keys(countryData).forEach(country => {
                                addCountryMarker(map, country);
                            });

                            // 범례 추가
                            const legend = L.control({position: 'bottomright'});
                            legend.onAdd = function() {
                                const div = L.DomUtil.create('div', 'map-legend');
                                div.style.background = 'white';
                                div.style.padding = '10px';
                                div.style.borderRadius = '5px';
                                div.innerHTML = `
                                    <h4 style="margin: 0 0 5px 0;">프로그램 상태</h4>
                                    <div><span style="background: #69b7a4; width: 12px; height: 12px; display: inline-block; border-radius: 50%;"></span> 성공</div>
                                    <div><span style="background: #7db8b5; width: 12px; height: 12px; display: inline-block; border-radius: 50%;"></span> 진행 중</div>
                                    <div><span style="background: #c4a977; width: 12px; height: 12px; display: inline-block; border-radius: 50%;"></span> 정체</div>
                                    <div><span style="background: #c97064; width: 12px; height: 12px; display: inline-block; border-radius: 50%;"></span> 위기</div>
                                `;
                                return div;
                            };
                            legend.addTo(map);
                        }
                    }, 100);
                    break;
            }
        }

        // 한국 인구 피라미드 초기화 및 애니메이션
        function initKoreaPyramid() {
            const canvas = document.getElementById('koreaPyramid');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');

            // 한국 인구구조 데이터 (연령대별, 천명 단위)
            const pyramidData = {
                1960: {
                    year: 1960,
                    description: '피라미드형 - 높은 출산율, 짧은 기대수명',
                    working: 54.8,
                    elderly: 2.9,
                    ageGroups: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                    male: [2100, 1900, 1700, 1500, 1300, 1100, 900, 800, 700, 600, 500, 400, 300, 200, 100, 50],
                    female: [2000, 1800, 1600, 1400, 1200, 1000, 850, 750, 650, 550, 450, 350, 250, 150, 80, 40]
                },
                2000: {
                    year: 2000,
                    description: '종형 - 출산율 감소, 생산연령인구 최대',
                    working: 71.7,
                    elderly: 7.2,
                    ageGroups: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                    male: [1400, 1500, 1600, 1700, 1750, 1800, 1850, 1900, 1850, 1700, 1500, 1200, 900, 600, 400, 200],
                    female: [1300, 1400, 1500, 1600, 1650, 1700, 1750, 1800, 1750, 1600, 1400, 1100, 850, 550, 380, 220]
                },
                2040: {
                    year: 2040,
                    description: '역피라미드형 - 초고령 사회, 낮은 출산율',
                    working: 52.4,
                    elderly: 34.3,
                    ageGroups: ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                    male: [800, 850, 900, 950, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 1700, 1200],
                    female: [750, 800, 850, 900, 950, 1050, 1150, 1250, 1350, 1450, 1550, 1650, 1750, 1850, 1650, 1400]
                }
            };

            const years = [1960, 2000, 2040];
            let currentYearIndex = 0;
            let animationTimer = null;

            function drawPyramid(data) {
                // Canvas 크기 설정
                canvas.width = canvas.offsetWidth;
                canvas.height = canvas.offsetHeight;

                ctx.clearRect(0, 0, canvas.width, canvas.height);

                const maxValue = 2100; // 최대값 고정
                const barHeight = canvas.height / data.ageGroups.length;
                const centerX = canvas.width / 2;
                const maxBarWidth = canvas.width * 0.35;

                // 연령 그룹 그리기
                data.ageGroups.forEach((ageGroup, i) => {
                    const y = i * barHeight;

                    // 남성 막대 (왼쪽)
                    const maleWidth = (data.male[i] / maxValue) * maxBarWidth;
                    ctx.fillStyle = i < 3 ? '#bae6fd' : (i >= 13 ? '#fecaca' : '#fdebd0'); // 젊은층, 노년층, 생산연령
                    ctx.fillRect(centerX - maleWidth, y, maleWidth, barHeight - 2);

                    // 여성 막대 (오른쪽)
                    const femaleWidth = (data.female[i] / maxValue) * maxBarWidth;
                    ctx.fillStyle = i < 3 ? '#bae6fd' : (i >= 13 ? '#fee2e2' : '#fef3c7');
                    ctx.fillRect(centerX, y, femaleWidth, barHeight - 2);

                    // 연령 레이블
                    ctx.fillStyle = '#4a5568';
                    ctx.font = '10px SeoulHangang';
                    ctx.textAlign = 'center';
                    ctx.fillText(ageGroup, centerX, y + barHeight/2 + 3);
                });

                // 축 그리기
                ctx.strokeStyle = '#cbd5e0';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(centerX, 0);
                ctx.lineTo(centerX, canvas.height);
                ctx.stroke();

                // 레이블
                ctx.fillStyle = '#4a5568';
                ctx.font = '12px SeoulHangang';
                ctx.textAlign = 'left';
                ctx.fillText('남성', 20, 20);
                ctx.textAlign = 'right';
                ctx.fillText('여성', canvas.width - 20, 20);

                // 정보 업데이트
                document.getElementById('pyramidYear').textContent = data.year + '년';
                document.getElementById('pyramidDescription').textContent = data.description;
                document.getElementById('workingAgePercent').textContent = data.working + '%';
                document.getElementById('elderlyPercent').textContent = data.elderly + '%';
            }

            // 자동 애니메이션
            function startAnimation() {
                drawPyramid(pyramidData[years[currentYearIndex]]);

                animationTimer = setInterval(() => {
                    currentYearIndex = (currentYearIndex + 1) % years.length;
                    drawPyramid(pyramidData[years[currentYearIndex]]);
                }, 3000); // 3초마다 전환
            }

            // 슬라이드가 활성화될 때 애니메이션 시작
            startAnimation();

            // 슬라이드 변경 시 애니메이션 정리
            window.pyramidCleanup = () => {
                if (animationTimer) {
                    clearInterval(animationTimer);
                    animationTimer = null;
                }
            };
        }

        // 초기 로드
        window.addEventListener('load', () => {
            showSlide(0);
        });

        // 클릭 네비게이션 (좌우 영역)
        document.addEventListener('click', (e) => {
            const viewport = document.querySelector('.presentation-viewport');
            if (!viewport.contains(e.target)) return;

            const rect = viewport.getBoundingClientRect();
            const x = e.clientX - rect.left;

            if (x < rect.width * 0.3) {
                showSlide(currentSlide - 1);
            } else if (x > rect.width * 0.7) {
                showSlide(currentSlide + 1);
            }
        });
    </script>
</body>
</html>