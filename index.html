<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Planning: The Unfinished Agenda - 통합 발표자료</title>

    <!-- External Stylesheets -->
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom Stylesheets -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">

    <!-- External Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
    <!-- Slide Container -->
    <div id="slideContainer">
        <!-- Slides will be loaded here -->
    </div>

    <!-- Navigation -->
    <div class="navigation">
        <button class="nav-btn" id="prevBtn">◀ 이전</button>
        <span class="slide-info">
            <span id="currentSlide">1</span> / <span id="totalSlides">16</span>
        </span>
        <button class="nav-btn" id="nextBtn">다음 ▶</button>
        <button class="nav-btn" id="fullscreenBtn">전체화면</button>
        <button class="nav-btn" id="menuBtn">목차</button>
    </div>

    <!-- Slide Menu -->
    <div class="slide-menu" id="slideMenu" style="display: none;">
        <h3>슬라이드 목차</h3>
        <ul id="slideMenuList">
            <li data-slide="1">1. 제목</li>
            <li data-slide="2">2. 핵심 메시지</li>
            <li data-slide="3">3. 역사적 발전 과정</li>
            <li data-slide="4">4. 인구 증가: 현황과 전망</li>
            <li data-slide="5">5. 세계 현황 지도</li>
            <li data-slide="6">6. 가족계획의 영향</li>
            <li data-slide="7">7. 보건 효과</li>
            <li data-slide="8">8. 경제 효과</li>
            <li data-slide="9">9. 니제르: 실패 사례</li>
            <li data-slide="10">10. 케냐: 정체 사례</li>
            <li data-slide="11">11. 방글라데시 vs 파키스탄</li>
            <li data-slide="12">12. 혁신 사례</li>
            <li data-slide="13">13. 피임 방법 효과성</li>
            <li data-slide="14">14. 자금 지원의 위기</li>
            <li data-slide="15">15. 미래 시나리오</li>
            <li data-slide="16">16. 정책 권고사항</li>
        </ul>
    </div>

    <!-- Loading indicator -->
    <div id="loadingIndicator" class="loading-indicator" style="display: none;">
        <div class="loading-spinner"></div>
        <p>프레젠테이션을 로딩 중...</p>
    </div>

    <!-- Error display -->
    <div id="errorDisplay" class="error-display" style="display: none;">
        <h3>오류가 발생했습니다</h3>
        <p id="errorMessage"></p>
        <button onclick="location.reload()">다시 시도</button>
    </div>

    <!-- Citation tooltip -->
    <div id="citationTooltip" class="citation-tooltip" style="display: none;">
        <div class="tooltip-content"></div>
    </div>

    <!-- ES6 Module System -->
    <!-- Main application module - loads all other modules automatically -->
    <script type="module" src="js/app.js"></script>

    <!-- Fallback for older browsers without module support -->
    <script nomodule>
        document.body.innerHTML = `
            <div style="padding: 40px; text-align: center; font-family: Arial, sans-serif; background-color: #f8f9fa;">
                <h2 style="color: #dc3545;">브라우저 호환성 문제</h2>
                <p>이 프레젠테이션은 ES6 모듈을 지원하는 최신 브라우저가 필요합니다.</p>
                <p>Chrome 61+, Firefox 60+, Safari 11+, Edge 79+ 이상의 브라우저를 사용해주세요.</p>
                <a href="https://www.google.com/chrome/" style="display: inline-block; margin: 10px; padding: 10px 20px; background: #007bff; color: white; text-decoration: none; border-radius: 4px;">Chrome 다운로드</a>
                <a href="https://www.mozilla.org/firefox/" style="display: inline-block; margin: 10px; padding: 10px 20px; background: #007bff; color: white; text-decoration: none; border-radius: 4px;">Firefox 다운로드</a>
            </div>
        `;
    </script>

    <!-- Legacy support and global functions -->
    <script>
        // Global functions for backwards compatibility
        window.changeSlide = function(direction) {
            if (window.presentationApp?.navigationController) {
                if (direction > 0) {
                    window.presentationApp.navigationController.nextSlide();
                } else {
                    window.presentationApp.navigationController.previousSlide();
                }
            }
        };

        window.showSlide = function(slideNumber) {
            if (window.presentationApp?.navigationController) {
                window.presentationApp.navigationController.goToSlide(slideNumber);
            }
        };

        window.toggleFullscreen = function() {
            if (window.presentationApp) {
                window.presentationApp.toggleFullscreen();
            }
        };

        window.toggleMenu = function() {
            const menu = document.getElementById('slideMenu');
            if (menu) {
                menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
            }
        };

        // Global error handler
        window.addEventListener('error', function(event) {
            console.error('Global error:', event.error);
            const errorDisplay = document.getElementById('errorDisplay');
            const errorMessage = document.getElementById('errorMessage');

            if (errorDisplay && errorMessage) {
                errorMessage.textContent = event.error?.message || '알 수 없는 오류가 발생했습니다.';
                errorDisplay.style.display = 'block';
            }
        });

        // Show loading indicator
        document.addEventListener('DOMContentLoaded', function() {
            const loadingIndicator = document.getElementById('loadingIndicator');
            if (loadingIndicator) {
                loadingIndicator.style.display = 'flex';
            }
        });
    </script>
</body>
</html>